{"version":3,"sources":["webpack:///./node_modules/ol-ext/control/LayerSwitcher.js","webpack:///./node_modules/ol/MapBrowserEventType.js","webpack:///./node_modules/ol/CollectionEventType.js","webpack:///./node_modules/ol/Kinetic.js","webpack:///./node_modules/ol/Observable.js","webpack:///./node_modules/ol/ViewHint.js","webpack:///./node_modules/ol/Feature.js","webpack:///./node_modules/ol/MapBrowserEvent.js","webpack:///./node_modules/ol/MapEventType.js","webpack:///./node_modules/ol/LayerType.js","webpack:///./node_modules/ol/Tile.js","webpack:///./node_modules/ol/MapBrowserEventHandler.js","webpack:///./node_modules/ol/MapProperty.js","webpack:///./node_modules/ol/TileQueue.js","webpack:///./node_modules/ol/PluggableMap.js","webpack:///./node_modules/ol/Map.js","webpack:///./node_modules/ol-ext/util/element.js","webpack:///./node_modules/ol/MapEvent.js","webpack:///./node_modules/ol/ObjectEventType.js","webpack:///./node_modules/ol/ImageTile.js","webpack:///./node_modules/ol/AssertionError.js","webpack:///./node_modules/ol/ImageState.js","webpack:///./node_modules/ol/TileCache.js","webpack:///./node_modules/ol/ViewProperty.js","webpack:///./node_modules/ol/View.js","webpack:///./node_modules/ol/TileState.js","webpack:///./node_modules/ol-ext/util/ext.js","webpack:///./node_modules/ol-ext/control/Toggle.js","webpack:///./node_modules/ol-ext/control/TextButton.js","webpack:///./node_modules/ol-ext/interaction/Delete.js","webpack:///./node_modules/ol-ext/style/defaultStyle.js","webpack:///./node_modules/ol-ext/geom/GeomUtils.js","webpack:///./node_modules/ol-ext/interaction/Offset.js","webpack:///./node_modules/ol-ext/geom/LineStringSplitAt.js","webpack:///./node_modules/ol-ext/interaction/Split.js","webpack:///./node_modules/ol-ext/interaction/Transform.js","webpack:///./node_modules/ol-ext/interaction/ModifyFeature.js","webpack:///./node_modules/ol-ext/interaction/DrawRegular.js","webpack:///./node_modules/ol-ext/interaction/DrawHole.js","webpack:///./node_modules/ol-ext/control/EditBar.js","webpack:///./node_modules/ol-ext/control/Swipe.js","webpack:///./node_modules/ol-ext/source/Vector.js","webpack:///./node_modules/ol-ext/interaction/UndoRedo.js","webpack:///./node_modules/ol/Disposable.js","webpack:///./node_modules/ol/TileRange.js","webpack:///./node_modules/ol/MapBrowserPointerEvent.js","webpack:///./node_modules/ol/Object.js","webpack:///./node_modules/ol/Collection.js","webpack:///./node_modules/ol-ext/control/Button.js","webpack:///./node_modules/ol/ImageBase.js","webpack:///./node_modules/ol/ImageCanvas.js","webpack:///./node_modules/ol-ext/control/Bar.js"],"names":["ol_control_LayerSwitcher","options","element","self","this","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","_layerGroup","layerGroup","getLayers","displayInLayerSwitcher","target","create","className","switcherClass","collapsed","classList","add","button","type","parent","addEventListener","e","toggle","dispatchEvent","contains","preventDefault","overflow","mouseover","remove","topv","click","botv","panel_","addListener","Math","max","min","wheelDelta","detail","stopPropagation","header_","call","set","drawDelay","prototype","tip","up","down","info","plus","layer","get","setMap","map","drawPanel","_listener","change","moveend","size","on","viewChange","bind","getLayerGroup","show","hide","isOpen","setHeader","html","setHTML","dir","hidden","setStyle","height","h","outerHeight","hp","dh","offsetTop","top","lh","getStyle","querySelectorAll","round","_setLayerForLI","li","listeners","push","setLayerOpacity","setLayerVisibility","key","i","querySelector","style","left","getOpacity","checked","getVisible","_clearLayerForLI","forEach","l","_getLayerForLI","testLayerVisibility","getMap","setTimeout","drawPanel_","dragging_","drawList","switchLayerVisibility","layers","setVisible","res","getView","getResolution","getMaxResolution","getMinResolution","ex0","getExtent","ex","calculateExtent","getSize","dragOrdering_","pageY","dragElt","group","elt","currentTarget","parentNode","start","panel","pageY0","touches","length","changedTouches","stop","drop","collection","getArray","removeAt","j","insertAt","removeListener","document","move","abs","innerHTML","position","offsetLeft","opacity","width","outerWidth","offsetRect","scrollTop","elementFromPoint","clientX","clientY","tagName","dragOpacity_","x","pageX","delta","nextElementSibling","setOpacity","ul","setVisibility","onInfo","zoomExtent","fit","removeLayer","getLength","layer_buttons","d","title","unselectable","userSelect","nb","p","setprogress_","layerswitcher_progress","op","offsetX","ul2","loaded","loading","draw","toFixed","getSource","SINGLECLICK","CLICK","DBLCLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","ADD","REMOVE","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","y","Date","now","end","lastIndex","firstIndex","duration","dx","dy","atan2","sqrt","getDistance","getAngle","Observable","EventTarget","revision_","__proto__","Object","constructor","changed","CHANGE","getRevision","listener","Array","isArray","len","keys","once","un","ii","unByKey","ANIMATING","INTERACTING","Feature","BaseObject","opt_geometryOrProperties","id_","undefined","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","getSimplifiedGeometry","geometry","setGeometry","properties","setProperties","clone","getProperties","setGeometryName","getGeometryName","getGeometry","getId","getStyleFunction","handleGeometryChange_","createStyleFunction","setId","id","name","obj","styles","getZIndex","MapBrowserEvent","MapEvent","browserEvent","opt_dragging","opt_frameState","originalEvent","pixel","getEventPixel","coordinate","getCoordinateFromPixel","dragging","POSTRENDER","MOVESTART","MOVEEND","IMAGE","TILE","VECTOR_TILE","VECTOR","Tile","tileCoord","state","opt_options","interimTile","transition_","transition","transitionStarts_","getKey","getInterimTile","tile","getState","LOADED","refreshInterimChain","prev","LOADING","IDLE","getTileCoord","setState","load","getAlpha","time","inTransition","endTransition","MapBrowserEventHandler","moveTolerance","map_","clickTimeoutId_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","PointerEventHandler","documentPointerEventHandler_","pointerdownListenerKey_","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","pointerEvent","newEvent","MapBrowserPointerEvent","MapBrowserEventType","clearTimeout","updateActivePointers_","event","pointerId","handlePointerUp_","propagationStopped","isMouseActionButton_","dispose","handlePointerMove_","isMoving_","disposeInternal","LAYERGROUP","SIZE","TARGET","VIEW","PriorityQueue","TileQueue","tilePriorityFunction","tileChangeCallback","apply","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","handleTileChange","getTilesLoading","TileState","ERROR","EMPTY","ABORT","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","getCount","dequeue","PluggableMap","optionsInternal","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","pixelRatio_","pixelRatio","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","createElement","msTouchAction","touchAction","overlayContainer_","appendChild","overlayContainerStopEvent_","overlayEvents","MOUSEDOWN","TOUCHSTART","MSPOINTERDOWN","MOUSEWHEEL","WHEEL","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyboardEventTarget","keyHandlerKeys_","CONTEXTMENU","handleBrowserEvent","controls","Collection","interactions","overlays_","overlays","overlayIdIndex_","renderer_","createRenderer","handleResize_","focus_","postRenderFunctions_","tileQueue_","getTilePriority","handleTileChange_","skippedFeatureUids_","MapProperty","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","values","control","CollectionEventType","interaction","addOverlayInternal_","overlay","toString","Error","addControl","getControls","addInteraction","getInteractions","addLayer","addOverlay","getOverlays","removeEventListener","RESIZE","cancelAnimationFrame","setTarget","forEachFeatureAtPixel","callback","hitTolerance","layerFilter","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","feature","forEachLayerAtPixel","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","getTarget","getTargetElement","getElementById","frameState","pixelToCoordinateTransform","slice","getOverlayById","getPixelFromCoordinate","coordinateToPixelTransform","getRenderer","getOverlayContainer","getOverlayContainerStopEvent","tileSourceKey","tileCenter","tileResolution","wantedTiles","deltaX","focus","deltaY","log","opt_type","mapBrowserEvent","interactionsArray","getActive","cont","handleEvent","handlePostRender","tileQueue","isEmpty","hints","viewHints","ViewHint","reprioritize","hasListener","RENDERCOMPLETE","animate","getLoading","dispatchRenderEvent","postRenderFunctions","render","targetElement","KEYDOWN","KEYPRESS","updateSize","window","removeLayerRenderers","handleViewPropertyChanged_","view","setAttribute","ObjectEventType","PROPERTYCHANGE","isRendered","renderSync","requestAnimationFrame","removeControl","removeInteraction","removeOverlay","viewState","previousFrameState","isDef","getHints","layerStatesArray","getLayerStatesArray","layerStates","center","index","skippedFeatureUids","usedTiles","resolution","rotation","renderFrame","moveStart","MapEventType","idle","setLayerGroup","setSize","setView","skipFeature","computedStyle","getComputedStyle","offsetWidth","parseFloat","offsetHeight","unskipFeature","View","source","Map","renderer","registerLayerRenderers","ol_ext_element","createTextNode","attr","test","trim","Element","text","eventType","fn","split","display","el","st","s","styleProp","value","defaultView","ownerDocument","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","rect","pageYOffset","documentElement","body","pageXOffset","scrollLeft","bottom","widtth","right","pos","speed","dt","onmove","page","vertical","scroll","moving","ondragstart","mousewheel","eventName","CustomEvent","createEvent","initCustomEvent","Event","ImageTile","src","crossOrigin","tileLoadFunction","crossOrigin_","src_","image_","Image","imageListenerKeys_","tileLoadFunction_","unlistenImage_","getBlankImage","getImage","handleImageError_","handleImageLoad_","image","naturalWidth","naturalHeight","LOAD","ctx","fillStyle","fillRect","canvas","AssertionError","code","path","message","TileCache","LRUCache","opt_highWaterMark","expireCache","canExpireCache","peekLast","zKey","pop","pruneExceptNewestZ","peekFirstKey","z","CENTER","RESOLUTION","ROTATION","DEFAULT_MIN_ZOOM","hints_","animations_","updateAnimationKey_","updateAnimations_","projection_","projection","applyOptions_","ViewProperty","resolutionConstraintInfo","createResolutionConstraint","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","minZoom_","minZoom","centerConstraint","createCenterConstraint","resolutionConstraint","constraint","rotationConstraint","createRotationConstraint","constraints_","zoom","constrainResolution","Number","options_","getUpdatedOptions_","newOptions","getZoom","getCenter","getRotation","var_args","arguments$1","arguments","animationCount","setCenter","setZoom","setRotation","animationCallback","series","animation","complete","anchor","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","sourceRotation","PI","targetRotation","isNoopAnimation","setHint","getAnimating","getInteracting","cancelAnimations","more","seriesComplete","jj","elapsed","fraction","progress","x0","y0","x1","y1","calculateCenterZoom","calculateCenterRotate","filter","Boolean","currentCenter","currentResolution","getSizeFromViewport_","selector","metrics","constrainCenter","opt_delta","opt_direction","direction","constrainRotation","getConstraints","opt_hints","opt_size","getMaxZoom","getZoomForResolution","setMaxZoom","maxZoom","getMinZoom","setMinZoom","getProjection","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","power","pow","getValueForResolutionFunction","pixelResolution","offset","nearest","getResolutionForZoom","geometryOrExtent","getType","GeometryType","CIRCLE","rotate","padding","coords","getFlatCoordinates","cosAngle","cos","sinAngle","sin","minRotX","Infinity","minRotY","maxRotX","maxRotY","stride","getStride","rotX","rotY","isNaN","constrainedResolution","centerRotX","centerRotY","centerX","centerY","setResolution","centerOn","opt_anchor","hint","returnValue","defaultMaxZoom","defaultZoomFactor","Units","DEGREES","getMetersPerUnit","defaultMaxResolution","defaultMinResolution","floor","enableRotation","ol","ext","ol_ext_inherits","child","inherits","NodeList","removeChild","ol_control_Toggle","interaction_","setActive","active","toggleFn","onToggle","handleClick","autoActivate","bar","subbar_","setDisable","disable","getSubBar","getDisable","disabled","b","oldValue","setInteraction","getInteraction","ol_control_TextButton","ol_interaction_Delete","getFeatures","clear","delete","selected","_getSources","sources","concat","delFeatures","f","removeFeature","ol_style_Style_defaultStyle","ol_coordinate_dist2d","p1","p2","ol_coordinate_equal","ol_coordinate_offsetCoords","mi","mi1","li1","ri","ri1","si","si1","Xi1","Yi1","p0","N","isClosed","ol_coordinate_findSegment","pt","segment","d0","v0","d1","v1","white","blue","defaultEditStyle","stroke","color","radius","fill","edit","fillColor","ol_interaction_Offset","handleDownEvent","handleDownEvent_","handleDragEvent","handleDragEvent_","handleMoveEvent","handleMoveEvent_","handleUpEvent","handleUpEvent_","features_","layers_","duplicate","source_","_style","previousCursor_","getFeatureAtPixel_","current","typeGeom","getCoordinates","getClosestPoint","hit","coordinates","geom","geomType","current_","currentStyle_","ctrlKey","addFeature","seg","v2","cursor","splitAt","tol","result","r","k","getFirstCoordinate","getLastCoordinate","c0","ci","c","d2","ol_interaction_Split","snapDistance_","snapDistance","tolerance_","tolerance","cursor_","sources_","filterSplit_","sketchStyle","featureStyle","overlayLayer_","useSpatialIndex","_sketch_","getClosestFeature","g","fi","getClosestFeatureToCoordinate","gi","di","coord","getNearestCoord","link","dm","MAX_VALUE","evt","tosplit","original","linkGeometry","ol_interaction_Transform","selection_","handles_","wrapX","_filter","_handleEvent","condition","addFn_","addCondition","translateFeature","translate","translateBBox","stretch","scale","keepAspectRatio","shiftKey","modifyCenter","metaKey","noFlip","selection","enableRotatedTransform","drawSketch_","setDefaultStyle","Cursors","oldMap","select","isTouch","strokedash","lineDash","fill0","circle","points","getAnchor","bigpt","angle","smallpt","createStyle","img","olstyle","im","setScale","tx","getText","setOffsetX","found","bbox_","handle","option","some","getGeometryRotateToZero_","origGeom","viewRotation","rotGeom","item","ol_extent","extendExt","ispt_","center_","iscircle_","addFeatures","indexOf","watchFeatures_","setSelection","_featureListeners","isUpdating_","sel","mode_","opt_","constraint_","coordinate_","pixel_","geoms_","rotatedGeoms_","rotExtent","extent_","rotatedExtent_","rotate0","pt0","a","ispt","setCenterAndRadius","getRadius","extentCoordinates","downCoordinate","dragCoordinate","downPoint","dragPoint","scx","scy","centerPoint","applyTransform","g1","g2","dim","default","oldgeom","oldgeoms","ol_interaction_ModifyFeature","modifying","_deleteCondition","pixelTolerance","_condition","deleteCondition","_insertVertexCondition","insertVertexCondition","currentFeature","deselected","dist","lstring","getLineStrings","ring","lring","getLinearRings","poly","getPolygons","getGeometries","getArcs","arcs","coord1","coord2","node","shift","c1","nbpt","closed","typeg","console","error","getFeaturesInExtent","_modifiedFeatures","_removePoint","getModifiedFeatures","removePoint","_getModification","geoms","setGeometries","setCoordinates","setArcCoordinates","getCurrentFeature","ol_interaction_DrawRegular","squaredClickTolerance_","clickTolerance","maxCircleCoordinates_","maxCircleCoordinates","squareFn_","squareCondition","centeredFn_","centerCondition","canRotate_","canRotate","geometryName","setSides","sides","defaultStyle","sketch_","handleEvent_","reset","started_","sides_","getSides","startAngle","3","4","getGeom_","coord_","dmax","centerPx","square_","centered_","coordPx_","hasrotation","sc","sign","t","feature_","drawPoint_","noclear","_eventTime","downPx_","start_","_longTouch","lastEvent","end_","upPx_","finishDrawing","startCoordinate","square","centered","ol_interaction_DrawHole","_select","geometryFn","geomFn","geometryFunction","_geometryFn","_startDrawing","_finishDrawing","removeLastPoint","_feature","getPolygon","_polygon","layersFilter","_current","intersectsCoordinate","_polygonIndex","hole","pi","newGeom","appendLinearRing","appendPolygon","lastOKCoord","ol_control_EditBar","toggleOne","_source","_interactions","_setSelectInteraction","edition","_setEditInteraction","_setModifyInteraction","Delete","ModifySelect","_getTitle","selectCtrl","sbar","del","Info","Select","DrawPoint","pedit","DrawLine","nbpts","ledit","UndoDraw","FinishDraw","DrawPolygon","_setDrawPolygon","DrawHole","DrawRegular","regular","div","textContent","ctrl","fedit","Transform","transform","Split","Offset","ol_control_Swipe","precomposeRight_","precomposeRight","precomposeLeft_","precomposeLeft","postcompose_","postcompose","rightLayers","orientation","isLayer_","splice","isMoving","clientLeft","clientTop","_drawRect","pts","tr","inversePixelTransform","context","lineTo","moveTo","ratio","save","beginPath","clip","getClassName","restore","opt_fast","ol_interaction_UndoRedo","_undoStack","_redoStack","_block","_record","_defs","define","action","undoFn","redoFn","undo","redo","prop","_mapListener","blockStart","blockEnd","_watchSources","_watchInteractions","getVectorLayers","init","_sourceListener","vectors","_onAddRemove","_interactionListener","_onInteraction","setattributestart","newp","assign","oldp","newProperties","oldProperties","rotatestart","translatestart","scalestart","modifystart","m","oldFeature","beforesplit","deletestart","aftersplit","deleteend","_handleDo","unset","warn","substr","hasUndo","hasRedo","Disposable","disposed_","TileRange","minX","maxX","minY","maxY","createOrUpdate","tileRange","containsXY","containsTileRange","equals","extend","getHeight","getWidth","intersects","ObjectEvent","opt_values","values_","hasOwnProperty","getKeys","notify","getChangeEventType","opt_silent","changeEventTypeCache","Property","LENGTH","CollectionEvent","opt_element","opt_array","unique_","unique","array_","assertUnique_","updateLength_","arr","array","elem","n","setAt","opt_except","ol_control_Button","bt","button_","evtFunction","firstElementChild","val","setTitle","setHtml","getButtonElement","ImageBase","EventType","getPixelRatio","ImageCanvas","opt_loader","ImageState","loader_","canvas_","error_","getError","handleLoad_","err","ol_control_Bar","classes","autoDeactivate","controls_","setPosition","onActivateControl_","deactivateControls","except","getActiveControls","sb","ctrls","getControlsByName"],"mappings":"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","file":"js/chunk-2b644eba.b03b3164.js","sourcesContent":["/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\nimport ol_control_Control from 'ol/control/Control'\nimport ol_layer_Tile from 'ol/layer/Tile'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_layer_VectorTile from 'ol/layer/VectorTile'\nimport ol_layer_Image from 'ol/layer/Image'\nimport ol_layer_Heatmap from 'ol/layer/Heatmap'\nimport {intersects as ol_extent_intersects} from 'ol/extent'\n\nimport ol_ext_element from '../util/element'\n\n/**\n * @classdesc OpenLayers 3 Layer Switcher Control.\n * @fires drawlist\n * @fires toggle\n * @fires reorder-start\n * @fires reorder-end\n * \n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} options\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\n *  @param {boolean} options.reordering allow layer reordering, default true\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\n *  @param {ol.layer.Group} options.layerGroup a layer group to display in the switcher, default display all layers of the map\n *\n * Layers attributes that control the switcher\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\n *\t- displayInLayerSwitcher {boolean} display in switcher, default true\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\n */\nvar ol_control_LayerSwitcher = function(options) {\n  options = options || {};\n  var self = this;\n  this.dcount = 0;\n  this.show_progress = options.show_progress;\n  this.oninfo = (typeof (options.oninfo) == \"function\" ? options.oninfo: null);\n  this.onextent = (typeof (options.onextent) == \"function\" ? options.onextent: null);\n  this.hasextent = options.extent || options.onextent;\n  this.hastrash = options.trash;\n  this.reordering = (options.reordering!==false);\n  this._layers = [];\n  this._layerGroup = (options.layerGroup && options.layerGroup.getLayers) ? options.layerGroup : null;\n\n  // displayInLayerSwitcher\n  if (typeof(options.displayInLayerSwitcher) === 'function') {\n    this.displayInLayerSwitcher = options.displayInLayerSwitcher;\n  }\n\n  var element;\n  if (options.target) {\n    element = ol_ext_element.create('DIV', {\n      className: options.switcherClass || \"ol-layerswitcher\"\n    });\n  } else {\n    element = ol_ext_element.create('DIV', {\n      className: (options.switcherClass || \"ol-layerswitcher\") +' ol-unselectable ol-control'\n    });\n    if (options.collapsed !== false) element.classList.add('ol-collapsed'); \n    else element.classList.add('ol-forceopen'); \n  \n    this.button = ol_ext_element.create('BUTTON', {\n      type: 'button',\n      parent: element\n    });\n    this.button.addEventListener('touchstart', function(e){\n      element.classList.toggle('ol-collapsed');\n      self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') });\n      e.preventDefault(); \n      self.overflow();\n    });\n    this.button.addEventListener('click', function(){\n      element.classList.toggle('ol-forceopen');\n      element.classList.add('ol-collapsed'); \n      self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') });\n      self.overflow();\n    });\n\n    if (options.mouseover) {\n      element.addEventListener ('mouseleave', function(){ \n        element.classList.add(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: true });\n      });\n      element.addEventListener ('mouseover', function(){ \n        element.classList.remove(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: false });\n      });\n    }\n\n    this.topv = ol_ext_element.create('DIV', {\n      className: 'ol-switchertopdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"+50%\");\n      }\n    });\n\n    this.botv = ol_ext_element.create('DIV', {\n      className: 'ol-switcherbottomdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"-50%\");\n      }\n    });\n  }\n\n  this.panel_ = ol_ext_element.create ('UL', {\n    className: 'panel',\n    parent: element\n  });\n  ol_ext_element.addListener (this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function(e) {\n    if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n\n  this.header_ = ol_ext_element.create('LI', {\n    className: 'ol-header',\n    parent: this.panel_\n  });\n\n  ol_control_Control.call (this, {\n    element: element,\n    target: options.target\n  });\n\n  this.set('drawDelay',options.drawDelay||0);\n};\nol_ext_inherits(ol_control_LayerSwitcher, ol_control_Control);\n\n/** List of tips for internationalization purposes\n*/\nol_control_LayerSwitcher.prototype.tip = {\n  up: \"up/down\",\n  down: \"down\",\n  info: \"informations...\",\n  extent: \"zoom to extent\",\n  trash: \"remove layer\",\n  plus: \"expand/shrink\"\n};\n\n/** Test if a layer should be displayed in the switcher\n * @param {ol.layer} layer\n * @return {boolean} true if the layer is displayed\n */\nol_control_LayerSwitcher.prototype.displayInLayerSwitcher = function(layer) {\n  return (layer.get('displayInLayerSwitcher')!==false);\n};\n\n/**\n * Set the map instance the control is associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_LayerSwitcher.prototype.setMap = function(map) {\n  ol_control_Control.prototype.setMap.call(this, map);\n  this.drawPanel();\n  \n  if (this._listener) {\n    if (this._listener) ol_Observable_unByKey(this._listener.change);\n    if (this._listener) ol_Observable_unByKey(this._listener.moveend);\n    if (this._listener) ol_Observable_unByKey(this._listener.size);\n  }\n  this._listener = null;\n\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = {\n      moveend: map.on('moveend', this.viewChange.bind(this)),\n      size: map.on('change:size', this.overflow.bind(this))\n    }\n    // Listen to a layer group\n    if (this._layerGroup) {\n      this._listener.change = this._layerGroup.getLayers().on('change:length', this.drawPanel.bind(this));\n    } else  {\n      //Listen to all layers\n      this._listener.change = map.getLayerGroup().getLayers().on('change:length', this.drawPanel.bind(this));\n    }\n  }\n};\n\n/** Show control\n */\nol_control_LayerSwitcher.prototype.show = function() {\n  this.element.classList.add(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Hide control\n */\nol_control_LayerSwitcher.prototype.hide = function() {\n  this.element.classList.remove(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Toggle control\n */\nol_control_LayerSwitcher.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Is control open\n * @return {boolean}\n */\nol_control_LayerSwitcher.prototype.isOpen = function() {\n  return this.element.classList.contains(\"ol-forceopen\");\n};\n\n/** Add a custom header\n * @param {Element|string} html content html\n */\nol_control_LayerSwitcher.prototype.setHeader = function(html) {\n  ol_ext_element.setHTML(this.header_, html);\n};\n\n/** Calculate overflow and add scrolls\n *\t@param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\n */\nol_control_LayerSwitcher.prototype.overflow = function(dir) {\t\n  if (this.button) {\n    // Nothing to show\n    if (ol_ext_element.hidden(this.panel_)) {\n      ol_ext_element.setStyle(this.element, { height: 'auto' });\n      return;\n    }\n    // Calculate offset\n    var h = ol_ext_element.outerHeight(this.element);\n    var hp = ol_ext_element.outerHeight(this.panel_);\n    var dh = this.button.offsetTop + ol_ext_element.outerHeight(this.button);\n    //var dh = this.button.position().top + this.button.outerHeight(true);\n\n    var top = this.panel_.offsetTop - dh;\n    if (hp > h-dh) {\n      // Bug IE: need to have an height defined\n      ol_ext_element.setStyle(this.element, { height: '100%' });\n      var lh = 2 * ol_ext_element.getStyle(this.panel_.querySelectorAll('li.visible .li-content')[0], 'height');\n      switch (dir) {\n        case 1: top += lh; break;\n        case -1: top -= lh; break;\n        case \"+50%\": top += Math.round(h/2); break;\n        case \"-50%\": top -= Math.round(h/2); break;\n        default: break;\n      }\n      // Scroll div\n      if (top+hp <= h-3*dh/2) {\n        top = h-3*dh/2-hp;\n        ol_ext_element.hide(this.botv);\n      } else {\n        ol_ext_element.show(this.botv);\n      }\n      if (top >= 0) {\n        top = 0;\n        ol_ext_element.hide(this.topv);\n      } else {\n        ol_ext_element.show(this.topv);\n      }\n      // Scroll ?\n      ol_ext_element.setStyle(this.panel_, { top: top+\"px\" });\n      return true;\n    } else {\n      ol_ext_element.setStyle(this.element, { height: \"auto\" });\n      ol_ext_element.setStyle(this.panel_, { top: 0 });\n      ol_ext_element.hide(this.botv);\n      ol_ext_element.hide(this.topv);\n      return false;\n    }\n  }\n  else return false;\n};\n\n/** Set the layer associated with a li\n * @param {Element} li\n * @param {ol.layer} layer\n */\nol_control_LayerSwitcher.prototype._setLayerForLI = function(li, layer) {\n  var listeners = [];\n  if (layer.getLayers) {\n    listeners.push(layer.getLayers().on('change:length', this.drawPanel.bind(this)));\n  }\n  if (li) {\n    // Handle opacity change\n    listeners.push(layer.on('change:opacity', (function() {\n      this.setLayerOpacity(layer, li);\n    }).bind(this)));\n    // Handle visibility chage\n    listeners.push(layer.on('change:visible', (function() {\n      this.setLayerVisibility(layer, li);\n    }).bind(this)));\n  }\n  // Other properties\n  listeners.push(layer.on('propertychange', (function(e) {\n    if (e.key === 'displayInLayerSwitcher'\n      || e.key === 'openInLayerSwitcher') {\n      this.drawPanel(e);\n    }\n  }).bind(this)));\n  this._layers.push({ li:li, layer:layer, listeners: listeners });\n};\n\n/** Set opacity for a layer\n * @param {ol.layer.Layer} layer\n * @param {Element} li the list element\n * @api\n */\nol_control_LayerSwitcher.prototype.setLayerOpacity = function(layer, li) {\n  var i = li.querySelector('.layerswitcher-opacity-cursor')\n  if (i) i.style.left = (layer.getOpacity()*100)+\"%\"\n};\n\n/** Set visibility for a layer\n * @param {ol.layer.Layer} layer\n * @param {Element} li the list element\n * @api\n */\nol_control_LayerSwitcher.prototype.setLayerVisibility = function(layer, li) {\n  var i = li.querySelector('.ol-visibility');\n  if (i) i.checked = layer.getVisible();\n  if (layer.getVisible()) li.classList.add('ol-visible');\n  else li.classList.remove('ol-visible');\n};\n\n/** Clear layers associated with li\n */\nol_control_LayerSwitcher.prototype._clearLayerForLI = function() {\n  this._layers.forEach(function (li) {\n    li.listeners.forEach(function(l) {\n      ol_Observable_unByKey(l);\n    });\n  })\n  this._layers = [];\n};\n\n/** Get the layer associated with a li\n * @param {Element} li\n * @return {ol.layer}\n */\nol_control_LayerSwitcher.prototype._getLayerForLI = function(li) {\n  for (var i=0, l; l=this._layers[i]; i++) {\n    if (l.li===li) return l.layer;\n  }\n  return null;\n};\n\n/**\n * On view change hide layer depending on resolution / extent\n * @private\n */\nol_control_LayerSwitcher.prototype.viewChange = function() {\n  this.panel_.querySelectorAll('li').forEach( function(li) {\n    var l = this._getLayerForLI(li);\n    if (l) {\n      if (this.testLayerVisibility(l)) li.classList.remove('ol-layer-hidden');\n      else li.classList.add('ol-layer-hidden');\n    }\n  }.bind(this));\n};\n\n/**\n *\tDraw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\n*/\nol_control_LayerSwitcher.prototype.drawPanel = function() {\n  if (!this.getMap()) return;\n  var self = this;\n  // Multiple event simultaneously / draw once => put drawing in the event queue\n  this.dcount++;\n  setTimeout (function(){ self.drawPanel_(); }, this.get('drawDelay') || 0);\n};\n\n/** Delayed draw panel control \n * @private\n */\nol_control_LayerSwitcher.prototype.drawPanel_ = function() {\n  if (--this.dcount || this.dragging_) return;\n  // Remove existing layers\n  this._clearLayerForLI();\n  this.panel_.querySelectorAll('li').forEach (function(li) {\n    if (!li.classList.contains('ol-header')) li.remove();\n  }.bind(this));\n  // Draw list\n  this.drawList (this.panel_, this._layerGroup ?  this._layerGroup.getLayers() : this.getMap().getLayers());\n};\n\n/** Change layer visibility according to the baselayer option\n * @param {ol.layer}\n * @param {Array<ol.layer>} related layers\n */\nol_control_LayerSwitcher.prototype.switchLayerVisibility = function(l, layers) {\n  if (!l.get('baseLayer')) {\n    l.setVisible(!l.getVisible());\n  } else {\n    if (!l.getVisible()) l.setVisible(true);\n    layers.forEach(function(li) {\n      if (l!==li && li.get('baseLayer') && li.getVisible()) li.setVisible(false);\n    });\n  }\n};\n\n/** Check if layer is on the map (depending on zoom and extent)\n * @param {ol.layer}\n * @return {boolean}\n */\nol_control_LayerSwitcher.prototype.testLayerVisibility = function(layer) {\n  if (!this.getMap()) return true;\n  var res = this.getMap().getView().getResolution();\n  if (layer.getMaxResolution()<=res || layer.getMinResolution()>=res) {\n    return false;\n  } else {\n    var ex0 = layer.getExtent();\n    if (ex0) {\n      var ex = this.getMap().getView().calculateExtent(this.getMap().getSize());\n      return ol_extent_intersects(ex, ex0);\n    }\n    return true;\n  }\n};\n\n\n/** Start ordering the list\n*\t@param {event} e drag event\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.dragOrdering_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  // Get params\n  var self = this;\n  var elt = e.currentTarget.parentNode.parentNode;\n  var start = true;\n  var panel = this.panel_; \n  var pageY;\n  var pageY0 = e.pageY \n    || (e.touches && e.touches.length && e.touches[0].pageY) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n  var target, dragElt;\n  var layer, group;\n  elt.parentNode.classList.add('drag');\n\n  // Stop ordering\n  function stop() {\n    if (target) {\n      // Get drag on parent\n      var drop = layer;\n      if (drop && target) {\n        var collection ;\n        if (group) collection = group.getLayers();\n        else collection = self._layerGroup ?  self._layerGroup.getLayers() : self.getMap().getLayers();\n        var layers = collection.getArray();\n        // Switch layers\n        for (var i=0; i<layers.length; i++) {\n          if (layers[i]==drop) {\n            collection.removeAt (i);\n            break;\n          }\n        }\n        for (var j=0; j<layers.length; j++) {\n          if (layers[j]==target) {\n            if (i>j) collection.insertAt (j,drop);\n            else collection.insertAt (j+1,drop);\n            break;\n          }\n        }\n      }\n\n      self.dispatchEvent({ type: \"reorder-end\", layer: drop, group: group });\n    }\n    \n    elt.parentNode.querySelectorAll('li').forEach(function(li){\n      li.classList.remove('dropover');\n      li.classList.remove('dropover-after');\n      li.classList.remove('dropover-before');\n    });\n    elt.classList.remove(\"drag\");\n    elt.parentNode.classList.remove(\"drag\");\n    self.element.classList.remove('drag');\n    if (dragElt) dragElt.remove();\n\n    ol_ext_element.removeListener(document, 'mousemove touchmove', move);\n    ol_ext_element.removeListener(document, 'mouseup touchend touchcancel', stop);\n  }\n\n  // Ordering\n  function move(e) {\n    // First drag (more than 2 px) => show drag element (ghost)\n    pageY = e.pageY \n        || (e.touches && e.touches.length && e.touches[0].pageY) \n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n    if (start && Math.abs(pageY0 - pageY) > 2) {\n      start = false;\n      elt.classList.add(\"drag\");\n      layer = self._getLayerForLI(elt);\n      target = false;\n      group = self._getLayerForLI(elt.parentNode.parentNode);\n      // Ghost div\n      dragElt = ol_ext_element.create('LI', { \n        className: 'ol-dragover',\n        html: elt.innerHTML,\n        style: { \n          position: \"absolute\", \n          \"z-index\": 10000, \n          left: elt.offsetLeft, \n          opacity: 0.5,\n          width: ol_ext_element.outerWidth(elt),\n          height: ol_ext_element.getStyle(elt,'height'),\n        },\n        parent: panel \n      });\n      self.element.classList.add('drag');\n      self.dispatchEvent({ type: \"reorder-start\", layer: layer, group: group });\n    }\n    // Start a new drag sequence\n    if (!start) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Ghost div\n      ol_ext_element.setStyle(dragElt, { top: pageY - ol_ext_element.offsetRect(panel).top + panel.scrollTop +5 });\n      \n      var li;\n      if (!e.touches) {\n        li = e.target;\n      } else {\n        li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n      }\n      if (li.classList.contains(\"ol-switcherbottomdiv\")) {\n        self.overflow(-1);\n      } else if (li.classList.contains(\"ol-switchertopdiv\")) {\n        self.overflow(1);\n      }\n      // Get associated li\n      while (li && li.tagName!=='LI') {\n        li = li.parentNode;\n      }\n      if (!li || !li.classList.contains('dropover')) {\n        elt.parentNode.querySelectorAll('li').forEach(function(li) {\n          li.classList.remove('dropover');\n          li.classList.remove('dropover-after');\n          li.classList.remove('dropover-before');\n        });\n      }\n      if (li && li.parentNode.classList.contains('drag') && li !== elt) {\n        target = self._getLayerForLI(li);\n        // Don't mix layer level\n        if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\n          li.classList.add(\"dropover\");\n          li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before');\n        } else {\n          target = false;\n        }\n        ol_ext_element.show(dragElt);\n      } else {\n        target = false;\n        if (li===elt) ol_ext_element.hide(dragElt);\n        else ol_ext_element.show(dragElt);\n      }\n      \n      if (!target) dragElt.classList.add(\"forbidden\");\n      else dragElt.classList.remove(\"forbidden\");\n    }\n  }\n\n  // Start ordering\n  ol_ext_element.addListener(document, 'mousemove touchmove', move);\n  ol_ext_element.addListener(document, 'mouseup touchend touchcancel', stop);\n};\n\n\n/** Change opacity on drag \n*\t@param {event} e drag event\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.dragOpacity_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  var self = this\n  // Register start params\n  var elt = e.target;\n  var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode);\n  if (!layer) return;\n  var x = e.pageX \n    || (e.touches && e.touches.length && e.touches[0].pageX) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n  var start = ol_ext_element.getStyle (elt, 'left') - x;\n  self.dragging_ = true;\n\n  // stop dragging\n  function stop() {\n    ol_ext_element.removeListener(document, \"mouseup touchend touchcancel\", stop);\n    ol_ext_element.removeListener(document, \"mousemove touchmove\", move);\n    self.dragging_ = false;\n  }\n  // On draggin\n  function move(e) {\n    var x = e.pageX \n      || (e.touches && e.touches.length && e.touches[0].pageX) \n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n    var delta = (start + x) / ol_ext_element.getStyle(elt.parentNode, 'width');\n    var opacity = Math.max (0, Math.min(1, delta));\n    ol_ext_element.setStyle (elt, { left: (opacity*100) + \"%\" });\n    elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity*100);\n    layer.setOpacity(opacity);\n  }\n  // Register move\n  ol_ext_element.addListener(document, \"mouseup touchend touchcancel\", stop);\n  ol_ext_element.addListener(document, \"mousemove touchmove\", move);\n};\n\n\n/** Render a list of layer\n * @param {Elemen} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol_control_LayerSwitcher.prototype.drawList = function(ul, collection) {\n  var self = this;\n  var layers = collection.getArray();\n\n  // Change layer visibility\n  var setVisibility = function(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.switchLayerVisibility(l, collection);\n  };\n  // Info button click\n  function onInfo(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.oninfo(l); \n    self.dispatchEvent({ type: \"info\", layer: l });\n  }\n  // Zoom to extent button\n  function zoomExtent(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    if (self.onextent) self.onextent(l); \n    else self.getMap().getView().fit (l.getExtent(), self.getMap().getSize()); \n    self.dispatchEvent({ type: \"extent\", layer: l });\n  }\n  // Remove a layer on trash click\n  function removeLayer(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var li = this.parentNode.parentNode.parentNode.parentNode;\n    var layer, group = self._getLayerForLI(li);\n    // Remove the layer from a group or from a map\n    if (group) {\n      layer = self._getLayerForLI(this.parentNode.parentNode);\n      group.getLayers().remove(layer);\n      if (group.getLayers().getLength()==0 && !group.get('noSwitcherDelete')) {\n        removeLayer.call(li.querySelectorAll('.layerTrash')[0], e);\n      }\n    } else {\n      li = this.parentNode.parentNode;\n      self.getMap().removeLayer(self._getLayerForLI(li));\n    }\n  }\n  \n  // Add the layer list\n  for (var i=layers.length-1; i>=0; i--) {\n    var layer = layers[i];\n\n    if (!self.displayInLayerSwitcher(layer)) {\n      this._setLayerForLI(null, layer);\n      continue;\n    } \n\n    var li = ol_ext_element.create('LI', {\n      className: (layer.getVisible()?\"visible \":\" \")+(layer.get('baseLayer')?\"baselayer\":\"\"),\n      parent: ul\n    });\n    this._setLayerForLI(li, layer);\n\n    var layer_buttons = ol_ext_element.create('DIV', {\n      className: 'ol-layerswitcher-buttons',\n      parent: li\n    });\n\n    // Content div\n    var d = ol_ext_element.create('DIV', {\n      className: 'li-content',// + (this.testLayerVisibility(layer) ? '' : ' ol-layer-hidden'),\n      parent: li\n    });\n    \n    // Visibility\n    ol_ext_element.create('INPUT', {\n      type: layer.get('baseLayer') ? 'radio' : 'checkbox',\n      className: 'ol-visibility',\n      checked: layer.getVisible(),\n      click: setVisibility,\n      parent: d\n    });\n    // Label\n    ol_ext_element.create('LABEL', {\n      html: layer.get(\"title\") || layer.get(\"name\"),\n      title: layer.get(\"title\") || layer.get(\"name\"),\n      click: setVisibility,\n      unselectable: 'on',\n      style: {\n        userSelect: 'none'\n      },\n      parent: d\n    }).addEventListener('selectstart', function(){ return false; });\n\n    //  up/down\n    if (this.reordering) {\n      if ( (i<layers.length-1 && (layer.get(\"allwaysOnTop\") || !layers[i+1].get(\"allwaysOnTop\")) )\n      || (i>0 && (!layer.get(\"allwaysOnTop\") || layers[i-1].get(\"allwaysOnTop\")) ) ) {\n        ol_ext_element.create('DIV', {\n          className: 'layerup',\n          title: this.tip.up,\n          on: { 'mousedown touchstart': function(e) { self.dragOrdering_(e) } },\n          parent: layer_buttons\n        });\n      }\n    }\n\n    // Show/hide sub layers\n    if (layer.getLayers) {\n      var nb = 0;\n      layer.getLayers().forEach(function(l) {\n        if (self.displayInLayerSwitcher(l)) nb++;\n      });\n      if (nb) {\n        ol_ext_element.create('DIV', {\n          className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\n          title: this.tip.plus,\n          click: function() {\n            var l = self._getLayerForLI(this.parentNode.parentNode);\n            l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\") )\n          },\n          parent: layer_buttons\n        });\n      }\n    }\n\n    // Info button\n    if (this.oninfo) {\n      ol_ext_element.create('DIV', {\n        className: 'layerInfo',\n        title: this.tip.info,\n        click: onInfo,\n        parent: layer_buttons\n      });\n    }\n    // Layer remove\n    if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\n      ol_ext_element.create('DIV', {\n        className: 'layerTrash',\n        title: this.tip.trash,\n        click: removeLayer,\n        parent: layer_buttons\n      });\n    }\n    // Layer extent\n    if (this.hasextent && layers[i].getExtent()) {\n      var ex = layers[i].getExtent();\n      if (ex.length==4 && ex[0]<ex[2] && ex[1]<ex[3]) {\n        ol_ext_element.create('DIV', {\n          className: 'layerExtent',\n          title: this.tip.extent,\n          click: zoomExtent,\n          parent: layer_buttons  \n        });\n      }\n    }\n\n    // Progress\n    if (this.show_progress && layer instanceof ol_layer_Tile) {\n      var p = ol_ext_element.create('DIV', {\n        className: 'layerswitcher-progress',\n        parent: d\n      });\n      this.setprogress_(layer);\n      layer.layerswitcher_progress = ol_ext_element.create('DIV', { parent: p });\n    }\n\n    // Opacity\n    var opacity = ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity',\n      // Click on the opacity line\n      click: function(e){\n        if (e.target !== this) return;\n        e.stopPropagation();\n        e.preventDefault();\n        var op = Math.max ( 0, Math.min( 1, e.offsetX / ol_ext_element.getStyle(this, 'width')));\n        self._getLayerForLI(this.parentNode.parentNode).setOpacity(op);\n      },\n      parent: d\n    });\n    // Start dragging\n    ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity-cursor',\n      style: { left: (layer.getOpacity()*100)+\"%\" },\n      on: {\n        'mousedown touchstart': function(e) { self.dragOpacity_ (e); }\n      },\n      parent: opacity\n    });\n    // Percent\n    ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity-label',\n      html: Math.round(layer.getOpacity()*100),\n      parent: d\n    });\n\n    // Layer group\n    if (layer.getLayers) {\n      li.classList.add('ol-layer-group');\n      if (layer.get(\"openInLayerSwitcher\") === true) {\n        var ul2 = ol_ext_element.create('UL', {\n          parent: li\n        });\n        this.drawList (ul2, layer.getLayers());\n      }\n    }\n    else if (layer instanceof ol_layer_Vector) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol_layer_VectorTile) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol_layer_Tile) li.classList.add('ol-layer-tile');\n    else if (layer instanceof ol_layer_Image) li.classList.add('ol-layer-image');\n    else if (layer instanceof ol_layer_Heatmap) li.classList.add('ol-layer-heatmap');\n\n    // Dispatch a dralist event to allow customisation\n    this.dispatchEvent({ type:'drawlist', layer:layer, li:li });\n  }\n\n  this.viewChange();\n\n  if (ul === this.panel_) this.overflow();\n};\n\n/** Handle progress bar for a layer\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.setprogress_ = function(layer) {\n  if (!layer.layerswitcher_progress) {\n    var loaded = 0;\n    var loading = 0;\n    var draw = function() {\n      if (loading === loaded) {\n        loading = loaded = 0;\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: 0 });// layer.layerswitcher_progress.width(0);\n      } else {\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' });// layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\n      }\n    }\n    layer.getSource().on('tileloadstart', function() {\n      loading++;\n      draw();\n    });\n    layer.getSource().on('tileloadend', function() {\n      loaded++;\n      draw();\n    });\n    layer.getSource().on('tileloaderror', function() {\n      loaded++;\n      draw();\n    });\n  }\n};\n\nexport default ol_control_LayerSwitcher\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n\n//# sourceMappingURL=MapBrowserEventType.js.map","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n\n//# sourceMappingURL=CollectionEventType.js.map","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nvar Kinetic = function Kinetic(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function begin () {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function update (x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function end () {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  var delay = Date.now() - this.delay_;\n  var lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  var firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  var duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  var dx = this.points_[lastIndex] - this.points_[firstIndex];\n  var dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function getDistance () {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function getAngle () {\n  return this.angle_;\n};\n\nexport default Kinetic;\n\n//# sourceMappingURL=Kinetic.js.map","/**\n * @module ol/Observable\n */\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").Event\n * @api\n */\nvar Observable = /*@__PURE__*/(function (EventTarget) {\n  function Observable() {\n\n    EventTarget.call(this);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n\n  }\n\n  if ( EventTarget ) Observable.__proto__ = EventTarget;\n  Observable.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Observable.prototype.constructor = Observable;\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  Observable.prototype.changed = function changed () {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  Observable.prototype.getRevision = function getRevision () {\n    return this.revision_;\n  };\n\n  /**\n   * Listen for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.on = function on (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listen(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Listen once for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.once = function once (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listenOnce(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listenOnce(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @api\n   */\n  Observable.prototype.un = function un (type, listener) {\n    if (Array.isArray(type)) {\n      for (var i = 0, ii = type.length; i < ii; ++i) {\n        unlisten(this, type[i], listener);\n      }\n      return;\n    } else {\n      unlisten(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  return Observable;\n}(EventTarget));\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (var i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\n\nexport default Observable;\n\n//# sourceMappingURL=Observable.js.map","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n\n//# sourceMappingURL=ViewHint.js.map","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @api\n */\nvar Feature = /*@__PURE__*/(function (BaseObject) {\n  function Feature(opt_geometryOrProperties) {\n\n    BaseObject.call(this);\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n\n    if (opt_geometryOrProperties) {\n      if (typeof /** @type {?} */ (opt_geometryOrProperties).getSimplifiedGeometry === 'function') {\n        var geometry = /** @type {import(\"./geom/Geometry.js\").default} */ (opt_geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        var properties = opt_geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  if ( BaseObject ) Feature.__proto__ = BaseObject;\n  Feature.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Feature.prototype.constructor = Feature;\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature} The clone.\n   * @api\n   */\n  Feature.prototype.clone = function clone () {\n    var clone = new Feature(this.getProperties());\n    clone.setGeometryName(this.getGeometryName());\n    var geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(geometry.clone());\n    }\n    var style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  };\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {import(\"./geom/Geometry.js\").default|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  Feature.prototype.getGeometry = function getGeometry () {\n    return (\n      /** @type {import(\"./geom/Geometry.js\").default|undefined} */ (this.get(this.geometryName_))\n    );\n  };\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  Feature.prototype.getId = function getId () {\n    return this.id_;\n  };\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  Feature.prototype.getGeometryName = function getGeometryName () {\n    return this.geometryName_;\n  };\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike} The feature style.\n   * @api\n   */\n  Feature.prototype.getStyle = function getStyle () {\n    return this.style_;\n  };\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  Feature.prototype.getStyleFunction = function getStyleFunction () {\n    return this.styleFunction_;\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChange_ = function handleGeometryChange_ () {\n    this.changed();\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChanged_ = function handleGeometryChanged_ () {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    var geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(geometry,\n        EventType.CHANGE, this.handleGeometryChange_, this);\n    }\n    this.changed();\n  };\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {import(\"./geom/Geometry.js\").default|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  Feature.prototype.setGeometry = function setGeometry (geometry) {\n    this.set(this.geometryName_, geometry);\n  };\n\n  /**\n   * Set the style for the feature.  This can be a single style object, an array\n   * of styles, or a function that takes a resolution and returns an array of\n   * styles. If it is `null` the feature has no style (a `null` style).\n   * @param {import(\"./style/Style.js\").StyleLike} style Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setStyle = function setStyle (style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  };\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setId = function setId (id) {\n    this.id_ = id;\n    this.changed();\n  };\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  Feature.prototype.setGeometryName = function setGeometryName (name) {\n    unlisten(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.geometryName_ = name;\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.handleGeometryChanged_();\n  };\n\n  return Feature;\n}(BaseObject));\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array<import(\"./style/Style.js\").default>}\n     */\n    var styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(typeof /** @type {?} */ (obj).getZIndex === 'function',\n        41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n      var style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n      styles = [style];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n\n//# sourceMappingURL=Feature.js.map","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map browser event.\n */\nvar MapBrowserEvent = /*@__PURE__*/(function (MapEvent) {\n  function MapBrowserEvent(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n    MapEvent.call(this, type, map, opt_frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {Event}\n     * @api\n     */\n    this.originalEvent = browserEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {import(\"./pixel.js\").Pixel}\n     * @api\n     */\n    this.pixel = map.getEventPixel(browserEvent);\n\n    /**\n     * The coordinate in view projection corresponding to the original browser event.\n     * @type {import(\"./coordinate.js\").Coordinate}\n     * @api\n     */\n    this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n  }\n\n  if ( MapEvent ) MapBrowserEvent.__proto__ = MapEvent;\n  MapBrowserEvent.prototype = Object.create( MapEvent && MapEvent.prototype );\n  MapBrowserEvent.prototype.constructor = MapBrowserEvent;\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.preventDefault = function preventDefault () {\n    MapEvent.prototype.preventDefault.call(this);\n    this.originalEvent.preventDefault();\n  };\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.stopPropagation = function stopPropagation () {\n    MapEvent.prototype.stopPropagation.call(this);\n    this.originalEvent.stopPropagation();\n  };\n\n  return MapBrowserEvent;\n}(MapEvent));\n\n\nexport default MapBrowserEvent;\n\n//# sourceMappingURL=MapBrowserEvent.js.map","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n\n//# sourceMappingURL=MapEventType.js.map","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n\n//# sourceMappingURL=LayerType.js.map","/**\n * @module ol/Tile\n */\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   var xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     var data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string)} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nvar Tile = /*@__PURE__*/(function (EventTarget) {\n  function Tile(tileCoord, state, opt_options) {\n    EventTarget.call(this);\n\n    var options = opt_options ? opt_options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {TileState}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n  }\n\n  if ( EventTarget ) Tile.__proto__ = EventTarget;\n  Tile.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Tile.prototype.constructor = Tile;\n\n  /**\n   * @protected\n   */\n  Tile.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {string} Key.\n   */\n  Tile.prototype.getKey = function getKey () {\n    return this.key + '/' + this.tileCoord;\n  };\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  Tile.prototype.getInterimTile = function getInterimTile () {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    var tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  };\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  Tile.prototype.refreshInterimChain = function refreshInterimChain () {\n    if (!this.interimTile) {\n      return;\n    }\n\n    var tile = this.interimTile;\n    var prev = /** @type {Tile} */ (this);\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  };\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  Tile.prototype.getTileCoord = function getTileCoord () {\n    return this.tileCoord;\n  };\n\n  /**\n   * @return {TileState} State.\n   */\n  Tile.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {TileState} state State.\n   * @api\n   */\n  Tile.prototype.setState = function setState (state) {\n    this.state = state;\n    this.changed();\n  };\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  Tile.prototype.load = function load () {};\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  Tile.prototype.getAlpha = function getAlpha (id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    var start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    var delta = time - start + (1000 / 60); // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  };\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  Tile.prototype.inTransition = function inTransition (id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  };\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  Tile.prototype.endTransition = function endTransition (id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  };\n\n  return Tile;\n}(EventTarget));\n\n\nexport default Tile;\n\n//# sourceMappingURL=Tile.js.map","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/Target.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\nvar MapBrowserEventHandler = /*@__PURE__*/(function (EventTarget) {\n  function MapBrowserEventHandler(map, moveTolerance) {\n\n    EventTarget.call(this);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {any}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance ?\n      moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     * @private\n     */\n    this.down_ = null;\n\n    var element = this.map_.getViewport();\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.activePointers_ = 0;\n\n    /**\n     * @type {!Object<number, boolean>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    /**\n     * Event handler which generates pointer events for\n     * the viewport element.\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.pointerEventHandler_ = new PointerEventHandler(element);\n\n    /**\n     * Event handler which generates pointer events for\n     * the document (used when dragging).\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.documentPointerEventHandler_ = null;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_, this);\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERMOVE,\n      this.relayEvent_, this);\n\n  }\n\n  if ( EventTarget ) MapBrowserEventHandler.__proto__ = EventTarget;\n  MapBrowserEventHandler.prototype = Object.create( EventTarget && EventTarget.prototype );\n  MapBrowserEventHandler.prototype.constructor = MapBrowserEventHandler;\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.emulateClick_ = function emulateClick_ (pointerEvent) {\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.CLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(function() {\n        this.clickTimeoutId_ = undefined;\n        var newEvent = new MapBrowserPointerEvent(\n          MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n        this.dispatchEvent(newEvent);\n      }.bind(this), 250);\n    }\n  };\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.updateActivePointers_ = function updateActivePointers_ (pointerEvent) {\n    var event = pointerEvent;\n\n    if (event.type == MapBrowserEventType.POINTERUP ||\n        event.type == MapBrowserEventType.POINTERCANCEL) {\n      delete this.trackedTouches_[event.pointerId];\n    } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n      this.trackedTouches_[event.pointerId] = true;\n    }\n    this.activePointers_ = Object.keys(this.trackedTouches_).length;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerUp_ = function handlePointerUp_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.stopPropagation() or event.preventDefault().\n    if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_ === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMouseActionButton_ = function isMouseActionButton_ (pointerEvent) {\n    return pointerEvent.button === 0;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerDown_ = function handlePointerDown_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    this.down_ = pointerEvent;\n\n    if (this.dragListenerKeys_.length === 0) {\n      /* Set up a pointer event handler on the `document`,\n       * which is required when the pointer is moved outside\n       * the viewport when dragging.\n       */\n      this.documentPointerEventHandler_ =\n          new PointerEventHandler(document);\n\n      this.dragListenerKeys_.push(\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_, this),\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERUP,\n          this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(this.pointerEventHandler_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_, this)\n      );\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerMove_ = function handlePointerMove_ (pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.dragging_ = true;\n      var newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n        this.dragging_);\n      this.dispatchEvent(newEvent);\n    }\n\n    // Some native android browser triggers mousemove events during small period\n    // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n    // https://code.google.com/p/android/issues/detail?id=19827\n    // ex: Galaxy Tab P3110 + Android 4.1.1\n    pointerEvent.preventDefault();\n  };\n\n  /**\n   * Wrap and relay a pointer event.  Note that this requires that the type\n   * string for the MapBrowserPointerEvent matches the PointerEvent type.\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.relayEvent_ = function relayEvent_ (pointerEvent) {\n    var dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(new MapBrowserPointerEvent(\n      pointerEvent.type, this.map_, pointerEvent, dragging));\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMoving_ = function isMoving_ (pointerEvent) {\n    return this.dragging_ ||\n        Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n        Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  MapBrowserEventHandler.prototype.disposeInternal = function disposeInternal () {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    if (this.documentPointerEventHandler_) {\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n    if (this.pointerEventHandler_) {\n      this.pointerEventHandler_.dispose();\n      this.pointerEventHandler_ = null;\n    }\n    EventTarget.prototype.disposeInternal.call(this);\n  };\n\n  return MapBrowserEventHandler;\n}(EventTarget));\n\n\nexport default MapBrowserEventHandler;\n\n//# sourceMappingURL=MapBrowserEventHandler.js.map","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n\n//# sourceMappingURL=MapProperty.js.map","/**\n * @module ol/TileQueue\n */\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\n\nvar TileQueue = /*@__PURE__*/(function (PriorityQueue) {\n  function TileQueue(tilePriorityFunction, tileChangeCallback) {\n\n    PriorityQueue.call(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      this, function(element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function(element) {\n        return (/** @type {import(\"./Tile.js\").default} */ (element[0]).getKey());\n      });\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n\n  }\n\n  if ( PriorityQueue ) TileQueue.__proto__ = PriorityQueue;\n  TileQueue.prototype = Object.create( PriorityQueue && PriorityQueue.prototype );\n  TileQueue.prototype.constructor = TileQueue;\n\n  /**\n   * @inheritDoc\n   */\n  TileQueue.prototype.enqueue = function enqueue (element) {\n    var added = PriorityQueue.prototype.enqueue.call(this, element);\n    if (added) {\n      var tile = element[0];\n      listen(tile, EventType.CHANGE, this.handleTileChange, this);\n    }\n    return added;\n  };\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  TileQueue.prototype.getTilesLoading = function getTilesLoading () {\n    return this.tilesLoading_;\n  };\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  TileQueue.prototype.handleTileChange = function handleTileChange (event) {\n    var tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    var state = tile.getState();\n    if (state === TileState.LOADED || state === TileState.ERROR ||\n        state === TileState.EMPTY || state === TileState.ABORT) {\n      unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n      var tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  };\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  TileQueue.prototype.loadMoreTiles = function loadMoreTiles (maxTotalLoading, maxNewLoads) {\n    var newLoads = 0;\n    var abortedTiles = false;\n    var state, tile, tileKey;\n    while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n           this.getCount() > 0) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.ABORT) {\n        abortedTiles = true;\n      } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n    if (newLoads === 0 && abortedTiles) {\n      // Do not stop the render loop when all wanted tiles were aborted due to\n      // a small, saturated tile cache.\n      this.tileChangeCallback_();\n    }\n  };\n\n  return TileQueue;\n}(PriorityQueue));\n\n\nexport default TileQueue;\n\n//# sourceMappingURL=TileQueue.js.map","/**\n * @module ol/PluggableMap\n */\nimport {getUid} from './util.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport RenderEventType from './render/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform\n * @property {null|import(\"./extent.js\").Extent} extent\n * @property {import(\"./coordinate.js\").Coordinate} focus\n * @property {number} index\n * @property {Object<string, import(\"./layer/Layer.js\").State>} layerStates\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform\n * @property {Array<PostRenderFunction>} postRenderFunctions\n * @property {import(\"./size.js\").Size} size\n * @property {!Object<string, boolean>} skippedFeatureUids\n * @property {TileQueue} tileQueue\n * @property {Object<string, Object<string, import(\"./TileRange.js\").default>>} usedTiles\n * @property {Array<number>} viewHints\n * @property {!Object<string, Object<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(PluggableMap, ?FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default): boolean} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls]\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions]\n * @property {HTMLElement|Document} keyboardEventTarget\n * @property {Collection<import(\"./Overlay.js\").default>} overlays\n * @property {Object<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @fires module:ol/render/Event~RenderEvent#rendercomplete\n * @api\n */\nvar PluggableMap = /*@__PURE__*/(function (BaseObject) {\n  function PluggableMap(options) {\n\n    BaseObject.call(this);\n\n    var optionsInternal = createOptionsInternal(options);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileAnimating_ =\n        options.loadTilesWhileAnimating !== undefined ?\n          options.loadTilesWhileAnimating : false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileInteracting_ =\n        options.loadTilesWhileInteracting !== undefined ?\n          options.loadTilesWhileInteracting : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = options.pixelRatio !== undefined ?\n      options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = function() {\n      this.animationDelayKey_ = undefined;\n      this.renderFrame_.call(this, Date.now());\n    }.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n    // prevent page zoom on IE >= 10 browsers\n    this.viewport_.style.msTouchAction = 'none';\n    this.viewport_.style.touchAction = 'none';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    var overlayEvents = [\n      EventType.CLICK,\n      EventType.DBLCLICK,\n      EventType.MOUSEDOWN,\n      EventType.TOUCHSTART,\n      EventType.MSPOINTERDOWN,\n      MapBrowserEventType.POINTERDOWN,\n      EventType.MOUSEWHEEL,\n      EventType.WHEEL\n    ];\n    for (var i = 0, ii = overlayEvents.length; i < ii; ++i) {\n      listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n    }\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n    for (var key in MapBrowserEventType) {\n      listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n        this.handleMapBrowserEvent, this);\n    }\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.keyHandlerKeys_ = null;\n\n    listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || new Collection();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions = optionsInternal.interactions || new Collection();\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default}\n     * @private\n     */\n    this.renderer_ = this.createRenderer();\n\n    /**\n     * @type {function(Event)|undefined}\n     * @private\n     */\n    this.handleResize_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate}\n     */\n    this.focus_ = null;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this));\n\n    /**\n     * Uids of features to skip at rendering time.\n     * @type {Object<string, boolean>}\n     * @private\n     */\n    this.skippedFeatureUids_ = {};\n\n    listen(\n      this, getChangeEventType(MapProperty.LAYERGROUP),\n      this.handleLayerGroupChanged_, this);\n    listen(this, getChangeEventType(MapProperty.VIEW),\n      this.handleViewChanged_, this);\n    listen(this, getChangeEventType(MapProperty.SIZE),\n      this.handleSizeChanged_, this);\n    listen(this, getChangeEventType(MapProperty.TARGET),\n      this.handleTargetChanged_, this);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       * @this {PluggableMap}\n       */\n      (function(control) {\n        control.setMap(this);\n      }).bind(this));\n\n    listen(this.controls, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.controls, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       * @this {PluggableMap}\n       */\n      (function(interaction) {\n        interaction.setMap(this);\n      }).bind(this));\n\n    listen(this.interactions, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.interactions, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n    listen(this.overlays_, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        this.addOverlayInternal_(/** @type {import(\"./Overlay.js\").default} */ (event.element));\n      }, this);\n\n    listen(this.overlays_, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        var overlay = /** @type {import(\"./Overlay.js\").default} */ (event.element);\n        var id = overlay.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }, this);\n\n  }\n\n  if ( BaseObject ) PluggableMap.__proto__ = BaseObject;\n  PluggableMap.prototype = Object.create( BaseObject && BaseObject.prototype );\n  PluggableMap.prototype.constructor = PluggableMap;\n\n  /**\n   * @abstract\n   * @return {import(\"./renderer/Map.js\").default} The map renderer\n   */\n  PluggableMap.prototype.createRenderer = function createRenderer () {\n    throw new Error('Use a map type that has a createRenderer method');\n  };\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  PluggableMap.prototype.addControl = function addControl (control) {\n    this.getControls().push(control);\n  };\n\n  /**\n   * Add the given interaction to the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  PluggableMap.prototype.addInteraction = function addInteraction (interaction) {\n    this.getInteractions().push(interaction);\n  };\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  PluggableMap.prototype.addLayer = function addLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  };\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  PluggableMap.prototype.addOverlay = function addOverlay (overlay) {\n    this.getOverlays().push(overlay);\n  };\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  PluggableMap.prototype.addOverlayInternal_ = function addOverlayInternal_ (overlay) {\n    var id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  };\n\n  /**\n   *\n   * @inheritDoc\n   */\n  PluggableMap.prototype.disposeInternal = function disposeInternal () {\n    this.mapBrowserEventHandler_.dispose();\n    unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n      this.animationDelayKey_ = undefined;\n    }\n    this.setTarget(null);\n    BaseObject.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `opt_options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./Feature.js\").FeatureLike,\n   *     import(\"./layer/Layer.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature feature} or\n   *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachFeatureAtPixel = function forEachFeatureAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = opt_options.layerFilter !== undefined ?\n      opt_options.layerFilter : TRUE;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, callback, null,\n      layerFilter, null);\n  };\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * `null` if none were found.\n   * @api\n   */\n  PluggableMap.prototype.getFeaturesAtPixel = function getFeaturesAtPixel (pixel, opt_options) {\n    var features = null;\n    this.forEachFeatureAtPixel(pixel, function(feature) {\n      if (!features) {\n        features = [];\n      }\n      features.push(feature);\n    }, opt_options);\n    return features;\n  };\n\n  /**\n   * Detect layers that have a color value at a pixel on the viewport, and\n   * execute a callback with each matching layer. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback\n   *     Layer callback. This callback will receive two arguments: first is the\n   *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n   *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n   *     that do not currently support this argument. To stop detection, callback\n   *     functions can return a truthy value.\n   * @param {AtPixelOptions=} opt_options Configuration options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachLayerAtPixel = function forEachLayerAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var options = opt_options || /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = options.layerFilter || TRUE;\n    return this.renderer_.forEachLayerAtPixel(\n      pixel, this.frameState_, hitTolerance, callback, null, layerFilter, null);\n  };\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @template U\n   * @api\n   */\n  PluggableMap.prototype.hasFeatureAtPixel = function hasFeatureAtPixel (pixel, opt_options) {\n    if (!this.frameState_) {\n      return false;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, layerFilter, null);\n  };\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {Event} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  PluggableMap.prototype.getEventCoordinate = function getEventCoordinate (event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  };\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {Event|TouchEvent} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  PluggableMap.prototype.getEventPixel = function getEventPixel (event) {\n    var viewportPosition = this.viewport_.getBoundingClientRect();\n    var eventPosition = 'changedTouches' in event ?\n      /** @type {TouchEvent} */ (event).changedTouches[0] :\n      /** @type {MouseEvent} */ (event);\n\n    return [\n      eventPosition.clientX - viewportPosition.left,\n      eventPosition.clientY - viewportPosition.top\n    ];\n  };\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getTarget = function getTarget () {\n    return /** @type {HTMLElement|string|undefined} */ (this.get(MapProperty.TARGET));\n  };\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  PluggableMap.prototype.getTargetElement = function getTargetElement () {\n    var target = this.getTarget();\n    if (target !== undefined) {\n      return typeof target === 'string' ? document.getElementById(target) : target;\n    } else {\n      return null;\n    }\n  };\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  PluggableMap.prototype.getCoordinateFromPixel = function getCoordinateFromPixel (pixel) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n    }\n  };\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  PluggableMap.prototype.getControls = function getControls () {\n    return this.controls;\n  };\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  PluggableMap.prototype.getOverlays = function getOverlays () {\n    return this.overlays_;\n  };\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  PluggableMap.prototype.getOverlayById = function getOverlayById (id) {\n    var overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  };\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  PluggableMap.prototype.getInteractions = function getInteractions () {\n    return this.interactions;\n  };\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getLayerGroup = function getLayerGroup () {\n    return (\n      /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP))\n    );\n  };\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  PluggableMap.prototype.getLayers = function getLayers () {\n    var layers = this.getLayerGroup().getLayers();\n    return layers;\n  };\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.getPixelFromCoordinate = function getPixelFromCoordinate (coordinate) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n    }\n  };\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default} Renderer\n   */\n  PluggableMap.prototype.getRenderer = function getRenderer () {\n    return this.renderer_;\n  };\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getSize = function getSize () {\n    return (\n      /** @type {import(\"./size.js\").Size|undefined} */ (this.get(MapProperty.SIZE))\n    );\n  };\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getView = function getView () {\n    return (\n      /** @type {View} */ (this.get(MapProperty.VIEW))\n    );\n  };\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  PluggableMap.prototype.getViewport = function getViewport () {\n    return this.viewport_;\n  };\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  PluggableMap.prototype.getOverlayContainer = function getOverlayContainer () {\n    return this.overlayContainer_;\n  };\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  PluggableMap.prototype.getOverlayContainerStopEvent = function getOverlayContainerStopEvent () {\n    return this.overlayContainerStopEvent_;\n  };\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  PluggableMap.prototype.getTilePriority = function getTilePriority (tile, tileSourceKey, tileCenter, tileResolution) {\n    // Filter out tiles at higher zoom levels than the current zoom level, or that\n    // are outside the visible extent.\n    var frameState = this.frameState_;\n    if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n      return DROP;\n    }\n    if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n      return DROP;\n    }\n    // Prioritize the highest zoom level tiles closest to the focus.\n    // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n    // Within a zoom level, tiles are prioritized by the distance in pixels\n    // between the center of the tile and the focus.  The factor of 65536 means\n    // that the prioritization should behave as desired for tiles up to\n    // 65536 * Math.log(2) = 45426 pixels from the focus.\n    var deltaX = tileCenter[0] - frameState.focus[0];\n    var deltaY = tileCenter[1] - frameState.focus[1];\n    return 65536 * Math.log(tileResolution) +\n        Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n  };\n\n  /**\n   * @param {Event} browserEvent Browser event.\n   * @param {string=} opt_type Type.\n   */\n  PluggableMap.prototype.handleBrowserEvent = function handleBrowserEvent (browserEvent, opt_type) {\n    var type = opt_type || browserEvent.type;\n    var mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  };\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  PluggableMap.prototype.handleMapBrowserEvent = function handleMapBrowserEvent (mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    this.focus_ = mapBrowserEvent.coordinate;\n    mapBrowserEvent.frameState = this.frameState_;\n    var interactionsArray = this.getInteractions().getArray();\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      for (var i = interactionsArray.length - 1; i >= 0; i--) {\n        var interaction = interactionsArray[i];\n        if (!interaction.getActive()) {\n          continue;\n        }\n        var cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont) {\n          break;\n        }\n      }\n    }\n  };\n\n  /**\n   * @protected\n   */\n  PluggableMap.prototype.handlePostRender = function handlePostRender () {\n\n    var frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    var tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      var maxTotalLoading = this.maxTilesLoading_;\n      var maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        var hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING]) {\n          maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n        if (hints[ViewHint.INTERACTING]) {\n          maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n    if (frameState && this.hasListener(RenderEventType.RENDERCOMPLETE) && !frameState.animate &&\n        !this.tileQueue_.getTilesLoading() && !getLoading(this.getLayers().getArray())) {\n      this.renderer_.dispatchRenderEvent(RenderEventType.RENDERCOMPLETE, frameState);\n    }\n\n    var postRenderFunctions = this.postRenderFunctions_;\n    for (var i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleSizeChanged_ = function handleSizeChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTargetChanged_ = function handleTargetChanged_ () {\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    var targetElement;\n    if (this.getTarget()) {\n      targetElement = this.getTargetElement();\n    }\n\n    if (this.keyHandlerKeys_) {\n      for (var i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.keyHandlerKeys_[i]);\n      }\n      this.keyHandlerKeys_ = null;\n    }\n\n    if (!targetElement) {\n      this.renderer_.removeLayerRenderers();\n      removeNode(this.viewport_);\n      if (this.handleResize_ !== undefined) {\n        removeEventListener(EventType.RESIZE, this.handleResize_, false);\n        this.handleResize_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n\n      var keyboardEventTarget = !this.keyboardEventTarget_ ?\n        targetElement : this.keyboardEventTarget_;\n      this.keyHandlerKeys_ = [\n        listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n        listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n      ];\n\n      if (!this.handleResize_) {\n        this.handleResize_ = this.updateSize.bind(this);\n        window.addEventListener(EventType.RESIZE, this.handleResize_, false);\n      }\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTileChange_ = function handleTileChange_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewPropertyChanged_ = function handleViewPropertyChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewChanged_ = function handleViewChanged_ () {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    var view = this.getView();\n    if (view) {\n      this.viewport_.setAttribute('data-view', getUid(view));\n      this.viewPropertyListenerKey_ = listen(\n        view, ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_, this);\n      this.viewChangeListenerKey_ = listen(\n        view, EventType.CHANGE,\n        this.handleViewPropertyChanged_, this);\n    }\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleLayerGroupChanged_ = function handleLayerGroupChanged_ () {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    var layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(\n          layerGroup, ObjectEventType.PROPERTYCHANGE,\n          this.render, this),\n        listen(\n          layerGroup, EventType.CHANGE,\n          this.render, this)\n      ];\n    }\n    this.render();\n  };\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  PluggableMap.prototype.isRendered = function isRendered () {\n    return !!this.frameState_;\n  };\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  PluggableMap.prototype.renderSync = function renderSync () {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  };\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  PluggableMap.prototype.render = function render () {\n    if (this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  };\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeControl = function removeControl (control) {\n    return this.getControls().remove(control);\n  };\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeInteraction = function removeInteraction (interaction) {\n    return this.getInteractions().remove(interaction);\n  };\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeLayer = function removeLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  };\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeOverlay = function removeOverlay (overlay) {\n    return this.getOverlays().remove(overlay);\n  };\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  PluggableMap.prototype.renderFrame_ = function renderFrame_ (time) {\n    var viewState;\n\n    var size = this.getSize();\n    var view = this.getView();\n    var extent = createEmpty();\n    var previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    var frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      var viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n      var layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n      var layerStates = {};\n      for (var i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n        layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n      }\n      viewState = view.getState(this.pixelRatio_);\n      frameState = /** @type {FrameState} */ ({\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        extent: extent,\n        focus: this.focus_ ? this.focus_ : viewState.center,\n        index: this.frameIndex_++,\n        layerStates: layerStates,\n        layerStatesArray: layerStatesArray,\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        skippedFeatureUids: this.skippedFeatureUids_,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {}\n      });\n    }\n\n    if (frameState) {\n      frameState.extent = getForViewAndSize(viewState.center,\n        viewState.resolution, viewState.rotation, frameState.size, extent);\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n      if (previousFrameState) {\n        var moveStart = !this.previousExtent_ ||\n                    (!isEmpty(this.previousExtent_) &&\n                    !equals(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      var idle = this.previousExtent_ &&\n          !frameState.viewHints[ViewHint.ANIMATING] &&\n          !frameState.viewHints[ViewHint.INTERACTING] &&\n          !equals(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    setTimeout(this.handlePostRender.bind(this), 0);\n\n  };\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setLayerGroup = function setLayerGroup (layerGroup) {\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  };\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setSize = function setSize (size) {\n    this.set(MapProperty.SIZE, size);\n  };\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string|undefined} target The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setTarget = function setTarget (target) {\n    this.set(MapProperty.TARGET, target);\n  };\n\n  /**\n   * Set the view for this map.\n   * @param {View} view The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setView = function setView (view) {\n    this.set(MapProperty.VIEW, view);\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.skipFeature = function skipFeature (feature) {\n    this.skippedFeatureUids_[getUid(feature)] = true;\n    this.render();\n  };\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.updateSize = function updateSize () {\n    var targetElement = this.getTargetElement();\n\n    if (!targetElement) {\n      this.setSize(undefined);\n    } else {\n      var computedStyle = getComputedStyle(targetElement);\n      this.setSize([\n        targetElement.offsetWidth -\n            parseFloat(computedStyle['borderLeftWidth']) -\n            parseFloat(computedStyle['paddingLeft']) -\n            parseFloat(computedStyle['paddingRight']) -\n            parseFloat(computedStyle['borderRightWidth']),\n        targetElement.offsetHeight -\n            parseFloat(computedStyle['borderTopWidth']) -\n            parseFloat(computedStyle['paddingTop']) -\n            parseFloat(computedStyle['paddingBottom']) -\n            parseFloat(computedStyle['borderBottomWidth'])\n      ]);\n    }\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.unskipFeature = function unskipFeature (feature) {\n    delete this.skippedFeatureUids_[getUid(feature)];\n    this.render();\n  };\n\n  return PluggableMap;\n}(BaseObject));\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {HTMLElement|Document}\n   */\n  var keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  var values = {};\n\n  var layerGroup = options.layers && typeof /** @type {?} */ (options.layers).getLayers === 'function' ?\n    /** @type {LayerGroup} */ (options.layers) : new LayerGroup({layers: /** @type {Collection} */ (options.layers)});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  var controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.controls).getArray === 'function',\n        47); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = /** @type {Collection} */ (options.controls);\n    }\n  }\n\n  var interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.interactions).getArray === 'function',\n        48); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = /** @type {Collection} */ (options.interactions);\n    }\n  }\n\n  var overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.overlays).getArray === 'function',\n        49); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n\n/**\n * @param  {Array<import(\"./layer/Base.js\").default>} layers Layers.\n * @return {boolean} Layers have sources that are still loading.\n */\nfunction getLoading(layers) {\n  for (var i = 0, ii = layers.length; i < ii; ++i) {\n    var layer = layers[i];\n    if (typeof /** @type {?} */ (layer).getLayers === 'function') {\n      return getLoading(/** @type {LayerGroup} */ (layer).getLayers().getArray());\n    } else {\n      var source = /** @type {import(\"./layer/Layer.js\").default} */ (\n        layer).getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n//# sourceMappingURL=PluggableMap.js.map","/**\n * @module ol/Map\n */\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nvar Map = /*@__PURE__*/(function (PluggableMap) {\n  function Map(options) {\n    options = assign({}, options);\n    if (!options.controls) {\n      options.controls = defaultControls();\n    }\n    if (!options.interactions) {\n      options.interactions = defaultInteractions();\n    }\n\n    PluggableMap.call(this, options);\n  }\n\n  if ( PluggableMap ) Map.__proto__ = PluggableMap;\n  Map.prototype = Object.create( PluggableMap && PluggableMap.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.prototype.createRenderer = function createRenderer () {\n    var renderer = new CanvasMapRenderer(this);\n    renderer.registerLayerRenderers([\n      CanvasImageLayerRenderer,\n      CanvasTileLayerRenderer,\n      CanvasVectorLayerRenderer,\n      CanvasVectorTileLayerRenderer\n    ]);\n    return renderer;\n  };\n\n  return Map;\n}(PluggableMap));\n\n\nexport default Map;\n\n//# sourceMappingURL=Map.js.map","/** Vanilla JS helper to manipulate DOM without jQuery\n * @see https://github.com/nefe/You-Dont-Need-jQuery\n * @see https://plainjs.com/javascript/\n * @see http://youmightnotneedjquery.com/\n */\n var ol_ext_element = {};\n\n/**\n * Create an element\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\n * @param {*} options\n *  @param {string} options.className className The element class name \n *  @param {Element} options.parent Parent to append the element as child\n *  @param {Element|string} options.html Content of the element\n *  @param {string} options.* Any other attribut to add to the element\n */\nol_ext_element.create = function (tagName, options) {\n  options = options || {};\n  var elt;\n  // Create text node\n  if (tagName === 'TEXT') {\n    elt = document.createTextNode(options.html||'');\n    if (options.parent) options.parent.appendChild(elt);\n  } else {\n    // Other element\n    elt = document.createElement(tagName);\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\n    for (var attr in options) {\n      switch (attr) {\n        case 'className': {\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\n          break;\n        }\n        case 'html': {\n          if (options.html instanceof Element) elt.appendChild(options.html)\n          else if (options.html!==undefined) elt.innerHTML = options.html;\n          break;\n        }\n        case 'parent': {\n          if (options.parent) options.parent.appendChild(elt);\n          break;\n        }\n        case 'style': {\n          this.setStyle(elt, options.style);\n          break;\n        }\n        case 'change':\n        case 'click': {\n          ol_ext_element.addListener(elt, attr, options[attr]);\n          break;\n        }\n        case 'on': {\n          for (var e in options.on) {\n            ol_ext_element.addListener(elt, e, options.on[e]);\n          }\n          break;\n        }\n        case 'checked': {\n          elt.checked = !!options.checked;\n          break;\n        }\n        default: {\n          elt.setAttribute(attr, options[attr]);\n          break;\n        }\n      }\n    }\n  }\n  return elt;\n};\n\n/** Set inner html or append a child element to an element\n * @param {Element} element\n * @param {Element|string} html Content of the element\n */\nol_ext_element.setHTML = function(element, html) {\n  if (html instanceof Element) element.appendChild(html)\n  else if (html!==undefined) element.innerHTML = html;\n};\n\n/** Append text into an elemnt\n * @param {Element} element\n * @param {string} text text content\n */\nol_ext_element.appendText = function(element, text) {\n  element.appendChild(document.createTextNode(text||''));\n};\n\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol_ext_element.addListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.addEventListener(e, fn);\n  });\n};\n\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol_ext_element.removeListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.removeEventListener(e, fn);\n  });\n};\n\n/**\n * Show an element\n * @param {Element} element\n */\nol_ext_element.show = function (element) {\n  element.style.display = '';\n};\n\n/**\n * Hide an element\n * @param {Element} element\n */\nol_ext_element.hide = function (element) {\n  element.style.display = 'none';\n};\n\n/**\n * Test if an element is hihdden\n * @param {Element} element\n * @return {boolean}\n */\nol_ext_element.hidden = function (element) {\n  return ol_ext_element.getStyle(element, 'display') === 'none';\n};\n\n/**\n * Toggle an element\n * @param {Element} element\n */\nol_ext_element.toggle = function (element) {\n  element.style.display = (element.style.display==='none' ? '' : 'none');\n};\n\n/** Set style of an element\n * @param {DOMElement} el the element\n * @param {*} st list of style\n */\nol_ext_element.setStyle = function(el, st) {\n  for (var s in st) {\n    switch (s) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n      case 'minWidth':\n      case 'maxWidth':\n      case 'width':\n      case 'height': {\n        if (typeof(st[s]) === 'number') {\n          el.style[s] = st[s]+'px';\n        } else {\n          el.style[s] = st[s];\n        }\n        break;\n      }\n      default: {\n        el.style[s] = st[s];\n      }\n    }\n  }\n};\n\n/**\n * Get style propertie of an element\n * @param {DOMElement} el the element\n * @param {string} styleProp Propertie name\n * @return {*} style value\n */\nol_ext_element.getStyle = function(el, styleProp) {\n  var value, defaultView = (el.ownerDocument || document).defaultView;\n  // W3C standard way:\n  if (defaultView && defaultView.getComputedStyle) {\n    // sanitize property name to css notation\n    // (hypen separated words eg. font-Size)\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\n  } else if (el.currentStyle) { // IE\n    // sanitize property name to camelCase\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\n      return letter.toUpperCase();\n    });\n    value = el.currentStyle[styleProp];\n    // convert other units to pixels on IE\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \n      return (function(value) {\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\n        el.runtimeStyle.left = el.currentStyle.left;\n        el.style.left = value || 0;\n        value = el.style.pixelLeft + \"px\";\n        el.style.left = oldLeft;\n        el.runtimeStyle.left = oldRsLeft;\n        return value;\n      })(value);\n    }\n  }\n  if (/px$/.test(value)) return parseInt(value);\n  return value;\n};\n\n/** Get outerHeight of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol_ext_element.outerHeight = function(elt) {\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\n};\n\n/** Get outerWidth of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol_ext_element.outerWidth = function(elt) {\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\n};\n\n/** Get element offset rect\n * @param {DOMElement} elt\n * @return {*} \n */\nol_ext_element.offsetRect = function(elt) {\n  var rect = elt.getBoundingClientRect();\n  return {\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\n    height: rect.height || (rect.bottom - rect.top),\n    width: rect.widtth || (rect.right - rect.left)\n  }\n};\n\n/** Make a div scrollable without scrollbar.\n * On touch devices the default behavior is preserved\n * @param {DOMElement} elt\n * @param {function} onmove a function that takes a boolean indicating that the div is scrolling\n */\nol_ext_element.scrollDiv = function(elt, options) {\n  var pos = false;\n  var speed = 0;\n  var d, dt = 0;\n\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\n  var page = options.vertical ? 'pageY' : 'pageX';\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\n  var moving = false;\n\n  // Prevent image dragging\n  elt.querySelectorAll('img').forEach(function(i) {\n    i.ondragstart = function(){ return false; };\n  });\n  \n  // Start scrolling\n  ol_ext_element.addListener(elt, ['mousedown'], function(e) {\n    moving = false;\n    pos = e[page];\n    dt = new Date();\n    elt.classList.add('ol-move');\n  });\n  \n  // Register scroll\n  ol_ext_element.addListener(window, ['mousemove'], function(e) {\n    moving = true;\n    if (pos !== false) {\n      var delta = pos - e[page];\n      elt[scroll] += delta;\n      d = new Date();\n      if (d-dt) {\n        speed = (speed + delta / (d - dt))/2;\n      }\n      pos = e[page];\n      dt = d;\n      // Tell we are moving\n      if (delta) onmove(true);\n    } else {\n      // Not moving yet\n      onmove(false);\n    }\n  });\n  \n  // Stop scrolling\n  ol_ext_element.addListener(window, ['mouseup'], function(e) {\n    if (moving) setTimeout (function() { elt.classList.remove('ol-move'); });\n    else elt.classList.remove('ol-move');\n    moving = false;\n    dt = new Date() - dt;\n    if (dt>100) {\n      // User stop: no speed\n      speed = 0;\n    } else if (dt>0) {\n      // Calculate new speed\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\n    }\n    elt[scroll] += speed*100;\n    pos = false;\n    speed = 0;\n    dt = 0;\n  });\n\n  // Handle mousewheel\n  if (options.mousewheel && !elt.classList.contains('ol-touch')) {\n    ol_ext_element.addListener(elt, \n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \n      function(e) {\n        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\n        elt.classList.add('ol-move');\n        elt[scroll] -= delta*30;\n        elt.classList.remove('ol-move');\n        return false;\n      }\n    );\n  }\n};\n\n/** Dispatch an event to an Element \n * @param {string} eventName\n * @param {Element} element\n*/\nol_ext_element.dispatchEvent = function (eventName, element) {\n  var event;\n  try {\n    event = new CustomEvent(eventName);\n  } catch(e) {\n    // Try customevent on IE\n    event = document.createEvent(\"CustomEvent\");\n    event.initCustomEvent(eventName, true, true, {});\n  }\n  element.dispatchEvent(event);\n};\n\nexport default ol_ext_element\n","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map event.\n */\nvar MapEvent = /*@__PURE__*/(function (Event) {\n  function MapEvent(type, map, opt_frameState) {\n\n    Event.call(this, type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./PluggableMap.js\").FrameState}\n     * @api\n     */\n    this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n  }\n\n  if ( Event ) MapEvent.__proto__ = Event;\n  MapEvent.prototype = Object.create( Event && Event.prototype );\n  MapEvent.prototype.constructor = MapEvent;\n\n  return MapEvent;\n}(Event));\n\nexport default MapEvent;\n\n//# sourceMappingURL=MapEvent.js.map","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n\n//# sourceMappingURL=ObjectEventType.js.map","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\n\n\nvar ImageTile = /*@__PURE__*/(function (Tile) {\n  function ImageTile(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n    Tile.call(this, tileCoord, state, opt_options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.imageListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n\n  }\n\n  if ( Tile ) ImageTile.__proto__ = Tile;\n  ImageTile.prototype = Object.create( Tile && Tile.prototype );\n  ImageTile.prototype.constructor = ImageTile;\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.disposeInternal = function disposeInternal () {\n    if (this.state == TileState.LOADING) {\n      this.unlistenImage_();\n      this.image_ = getBlankImage();\n    }\n    if (this.interimTile) {\n      this.interimTile.dispose();\n    }\n    this.state = TileState.ABORT;\n    this.changed();\n    Tile.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  ImageTile.prototype.getImage = function getImage () {\n    return this.image_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.getKey = function getKey () {\n    return this.src_;\n  };\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageError_ = function handleImageError_ () {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  };\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageLoad_ = function handleImageLoad_ () {\n    var image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  ImageTile.prototype.load = function load () {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.imageListenerKeys_ = [\n        listenOnce(this.image_, EventType.ERROR,\n          this.handleImageError_, this),\n        listenOnce(this.image_, EventType.LOAD,\n          this.handleImageLoad_, this)\n      ];\n      this.tileLoadFunction_(this, this.src_);\n    }\n  };\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.unlistenImage_ = function unlistenImage_ () {\n    this.imageListenerKeys_.forEach(unlistenByKey);\n    this.imageListenerKeys_ = null;\n  };\n\n  return ImageTile;\n}(Tile));\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  var ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n\n//# sourceMappingURL=ImageTile.js.map","/**\n * @module ol/AssertionError\n */\nimport {VERSION} from './util.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error.\n */\nvar AssertionError = /*@__PURE__*/(function (Error) {\n  function AssertionError(code) {\n    var path = VERSION === 'latest' ? VERSION : 'v' + VERSION.split('-')[0];\n    var message = 'Assertion failed. See https://openlayers.org/en/' + path +\n    '/doc/errors/#' + code + ' for details.';\n\n    Error.call(this, message);\n\n    /**\n     * Error code. The meaning of the code can be found on\n     * https://openlayers.org/en/latest/doc/errors/ (replace `latest` with\n     * the version found in the OpenLayers script's header comment if a version\n     * other than the latest is used).\n     * @type {number}\n     * @api\n     */\n    this.code = code;\n\n    /**\n     * @type {string}\n     */\n    this.name = 'AssertionError';\n\n    // Re-assign message, see https://github.com/Rich-Harris/buble/issues/40\n    this.message = message;\n  }\n\n  if ( Error ) AssertionError.__proto__ = Error;\n  AssertionError.prototype = Object.create( Error && Error.prototype );\n  AssertionError.prototype.constructor = AssertionError;\n\n  return AssertionError;\n}(Error));\n\nexport default AssertionError;\n\n//# sourceMappingURL=AssertionError.js.map","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n\n//# sourceMappingURL=ImageState.js.map","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nvar TileCache = /*@__PURE__*/(function (LRUCache) {\n  function TileCache(opt_highWaterMark) {\n\n    LRUCache.call(this, opt_highWaterMark);\n\n  }\n\n  if ( LRUCache ) TileCache.__proto__ = LRUCache;\n  TileCache.prototype = Object.create( LRUCache && LRUCache.prototype );\n  TileCache.prototype.constructor = TileCache;\n\n  /**\n   * @param {!Object<string, import(\"./TileRange.js\").default>} usedTiles Used tiles.\n   */\n  TileCache.prototype.expireCache = function expireCache (usedTiles) {\n    while (this.canExpireCache()) {\n      var tile = this.peekLast();\n      var zKey = tile.tileCoord[0].toString();\n      if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n        break;\n      } else {\n        this.pop().dispose();\n      }\n    }\n  };\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  TileCache.prototype.pruneExceptNewestZ = function pruneExceptNewestZ () {\n    if (this.getCount() === 0) {\n      return;\n    }\n    var key = this.peekFirstKey();\n    var tileCoord = fromKey(key);\n    var z = tileCoord[0];\n    this.forEach(function(tile) {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.dispose();\n      }\n    }, this);\n  };\n\n  return TileCache;\n}(LRUCache));\n\n\nexport default TileCache;\n\n//# sourceMappingURL=TileCache.js.map","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n\n//# sourceMappingURL=ViewProperty.js.map","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {getUid} from './util.js';\nimport {VOID} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter]\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [targetRotation]\n * @property {import(\"./coordinate.js\").Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center\n * @property {import(\"./resolutionconstraint.js\").Type} resolution\n * @property {import(\"./rotationconstraint.js\").Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center\n * @property {import(\"./proj/Projection.js\").default} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nvar DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n  * @api\n */\nvar View = /*@__PURE__*/(function (BaseObject) {\n  function View(opt_options) {\n    BaseObject.call(this);\n\n    var options = assign({}, opt_options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    this.applyOptions_(options);\n  }\n\n  if ( BaseObject ) View.__proto__ = BaseObject;\n  View.prototype = Object.create( BaseObject && BaseObject.prototype );\n  View.prototype.constructor = View;\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  View.prototype.applyOptions_ = function applyOptions_ (options) {\n\n    /**\n     * @type {Object<string, *>}\n     */\n    var properties = {};\n    properties[ViewProperty.CENTER] = options.center !== undefined ?\n      options.center : null;\n\n    var resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    var centerConstraint = createCenterConstraint(options);\n    var resolutionConstraint = resolutionConstraintInfo.constraint;\n    var rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint\n    };\n\n    if (options.resolution !== undefined) {\n      properties[ViewProperty.RESOLUTION] = options.resolution;\n    } else if (options.zoom !== undefined) {\n      properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_);\n\n      if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n        properties[ViewProperty.RESOLUTION] = clamp(\n          Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n          this.minResolution_, this.maxResolution_);\n      }\n    }\n    properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n    this.setProperties(properties);\n\n    /**\n     * @private\n     * @type {ViewOptions}\n     */\n    this.options_ = options;\n\n  };\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  View.prototype.getUpdatedOptions_ = function getUpdatedOptions_ (newOptions) {\n    var options = assign({}, this.options_);\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenter();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return assign({}, options, newOptions);\n  };\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean))} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  View.prototype.animate = function animate (var_args) {\n    var arguments$1 = arguments;\n\n    var animationCount = arguments.length;\n    var callback;\n    if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n    if (!this.isDef()) {\n      // if view properties are not yet set, shortcut to the final state\n      var state = arguments[animationCount - 1];\n      if (state.center) {\n        this.setCenter(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n    var start = Date.now();\n    var center = this.getCenter().slice();\n    var resolution = this.getResolution();\n    var rotation = this.getRotation();\n    var series = [];\n    for (var i = 0; i < animationCount; ++i) {\n      var options = /** @type {AnimationOptions} */ (arguments$1[i]);\n\n      var animation = /** @type {Animation} */ ({\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut\n      });\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center;\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.constrainResolution(\n          this.maxResolution_, options.zoom - this.minZoom_, 0);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        var delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      animation.callback = callback;\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  };\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  View.prototype.getAnimating = function getAnimating () {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  };\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  View.prototype.getInteracting = function getInteracting () {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  };\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  View.prototype.cancelAnimations = function cancelAnimations () {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    for (var i = 0, ii = this.animations_.length; i < ii; ++i) {\n      var series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n    }\n    this.animations_.length = 0;\n  };\n\n  /**\n   * Update all animations.\n   */\n  View.prototype.updateAnimations_ = function updateAnimations_ () {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    var now = Date.now();\n    var more = false;\n    for (var i = this.animations_.length - 1; i >= 0; --i) {\n      var series = this.animations_[i];\n      var seriesComplete = true;\n      for (var j = 0, jj = series.length; j < jj; ++j) {\n        var animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        var elapsed = now - animation.start;\n        var fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        var progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          var x0 = animation.sourceCenter[0];\n          var y0 = animation.sourceCenter[1];\n          var x1 = animation.targetCenter[0];\n          var y1 = animation.targetCenter[1];\n          var x = x0 + progress * (x1 - x0);\n          var y = y0 + progress * (y1 - y0);\n          this.set(ViewProperty.CENTER, [x, y]);\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          var resolution = progress === 1 ?\n            animation.targetResolution :\n            animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterZoom(resolution, animation.anchor));\n          }\n          this.set(ViewProperty.RESOLUTION, resolution);\n        }\n        if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n          var rotation = progress === 1 ?\n            modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n            animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterRotate(rotation, animation.anchor));\n          }\n          this.set(ViewProperty.ROTATION, rotation);\n        }\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        var callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n    }\n  };\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  View.prototype.calculateCenterRotate = function calculateCenterRotate (rotation, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  };\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  View.prototype.calculateCenterZoom = function calculateCenterZoom (resolution, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    var currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      var x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n      var y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  };\n\n  /**\n   * @private\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  View.prototype.getSizeFromViewport_ = function getSizeFromViewport_ () {\n    var size = [100, 100];\n    var selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n    var element = document.querySelector(selector);\n    if (element) {\n      var metrics = getComputedStyle(element);\n      size[0] = parseInt(metrics.width, 10);\n      size[1] = parseInt(metrics.height, 10);\n    }\n    return size;\n  };\n\n  /**\n   * Get the constrained center of this view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center Center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Constrained center.\n   * @api\n   */\n  View.prototype.constrainCenter = function constrainCenter (center) {\n    return this.constraints_.center(center);\n  };\n\n  /**\n   * Get the constrained resolution of this view.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @param {number=} opt_direction Direction. Default is `0`.\n   * @return {number|undefined} Constrained resolution.\n   * @api\n   */\n  View.prototype.constrainResolution = function constrainResolution (resolution, opt_delta, opt_direction) {\n    var delta = opt_delta || 0;\n    var direction = opt_direction || 0;\n    return this.constraints_.resolution(resolution, delta, direction);\n  };\n\n  /**\n   * Get the constrained rotation of this view.\n   * @param {number|undefined} rotation Rotation.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @return {number|undefined} Constrained rotation.\n   * @api\n   */\n  View.prototype.constrainRotation = function constrainRotation (rotation, opt_delta) {\n    var delta = opt_delta || 0;\n    return this.constraints_.rotation(rotation, delta);\n  };\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getCenter = function getCenter () {\n    return (\n      /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n    );\n  };\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  View.prototype.getConstraints = function getConstraints () {\n    return this.constraints_;\n  };\n\n  /**\n   * @param {Array<number>=} opt_hints Destination array.\n   * @return {Array<number>} Hint.\n   */\n  View.prototype.getHints = function getHints (opt_hints) {\n    if (opt_hints !== undefined) {\n      opt_hints[0] = this.hints_[0];\n      opt_hints[1] = this.hints_[1];\n      return opt_hints;\n    } else {\n      return this.hints_.slice();\n    }\n  };\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size. If not provided, the size of the\n   * first map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  View.prototype.calculateExtent = function calculateExtent (opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    assert(center, 1); // The view center is not defined\n    var resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    var rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  };\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  View.prototype.getMaxResolution = function getMaxResolution () {\n    return this.maxResolution_;\n  };\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  View.prototype.getMinResolution = function getMinResolution () {\n    return this.minResolution_;\n  };\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  View.prototype.getMaxZoom = function getMaxZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n  };\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  View.prototype.setMaxZoom = function setMaxZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  };\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  View.prototype.getMinZoom = function getMinZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n  };\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  View.prototype.setMinZoom = function setMinZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  };\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  View.prototype.getProjection = function getProjection () {\n    return this.projection_;\n  };\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getResolution = function getResolution () {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  };\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  View.prototype.getResolutions = function getResolutions () {\n    return this.resolutions_;\n  };\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  View.prototype.getResolutionForExtent = function getResolutionForExtent (extent, opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var xResolution = getWidth(extent) / size[0];\n    var yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  };\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  View.prototype.getResolutionForValueFunction = function getResolutionForValueFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function(value) {\n        var resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      });\n  };\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.getRotation = function getRotation () {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  };\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  View.prototype.getValueForResolutionFunction = function getValueForResolutionFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function(resolution) {\n        var value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n        return value;\n      });\n  };\n\n  /**\n   * @param {number} pixelRatio Pixel ratio for center rounding.\n   * @return {State} View state.\n   */\n  View.prototype.getState = function getState (pixelRatio) {\n    var center = /** @type {import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    var projection = this.getProjection();\n    var resolution = /** @type {number} */ (this.getResolution());\n    var pixelResolution = resolution / pixelRatio;\n    var rotation = this.getRotation();\n    return (\n      /** @type {State} */ ({\n        center: [\n          Math.round(center[0] / pixelResolution) * pixelResolution,\n          Math.round(center[1] / pixelResolution) * pixelResolution\n        ],\n        projection: projection !== undefined ? projection : null,\n        resolution: resolution,\n        rotation: rotation,\n        zoom: this.getZoom()\n      })\n    );\n  };\n\n  /**\n   * Get the current zoom level.  If you configured your view with a resolutions\n   * array (this is rare), this method may return non-integer zoom levels (so\n   * the zoom level is not safe to use as an index into a resolutions array).\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  View.prototype.getZoom = function getZoom () {\n    var zoom;\n    var resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  };\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  View.prototype.getZoomForResolution = function getZoomForResolution (resolution) {\n    var offset = this.minZoom_ || 0;\n    var max, zoomFactor;\n    if (this.resolutions_) {\n      var nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  };\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  View.prototype.getResolutionForZoom = function getResolutionForZoom (zoom) {\n    return /** @type {number} */ (this.constrainResolution(\n      this.maxResolution_, zoom - this.minZoom_, 0));\n  };\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions=} opt_options Options.\n   * @api\n   */\n  View.prototype.fit = function fit (geometryOrExtent, opt_options) {\n    var options = opt_options || {};\n    var size = options.size;\n    if (!size) {\n      size = this.getSizeFromViewport_();\n    }\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    var geometry;\n    assert(Array.isArray(geometryOrExtent) || typeof /** @type {?} */ (geometryOrExtent).getSimplifiedGeometry === 'function',\n      24); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent),\n        25); // Cannot fit empty extent provided as `geometry`\n      geometry = polygonFromExtent(geometryOrExtent);\n    } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n      geometryOrExtent = geometryOrExtent.getExtent();\n      geometry = polygonFromExtent(geometryOrExtent);\n      geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n    } else {\n      geometry = geometryOrExtent;\n    }\n\n    var padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    var constrainResolution = options.constrainResolution !== undefined ?\n      options.constrainResolution : true;\n    var nearest = options.nearest !== undefined ? options.nearest : false;\n    var minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.constrainResolution(\n        this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n    } else {\n      minResolution = 0;\n    }\n    var coords = geometry.getFlatCoordinates();\n\n    // calculate rotated extent\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var minRotX = +Infinity;\n    var minRotY = +Infinity;\n    var maxRotX = -Infinity;\n    var maxRotY = -Infinity;\n    var stride = geometry.getStride();\n    for (var i = 0, ii = coords.length; i < ii; i += stride) {\n      var rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      var rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n\n    // calculate resolution\n    var resolution = this.getResolutionForExtent(\n      [minRotX, minRotY, maxRotX, maxRotY],\n      [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n    resolution = isNaN(resolution) ? minResolution :\n      Math.max(resolution, minResolution);\n    if (constrainResolution) {\n      var constrainedResolution = this.constrainResolution(resolution, 0, 0);\n      if (!nearest && constrainedResolution < resolution) {\n        constrainedResolution = this.constrainResolution(\n          constrainedResolution, -1, 0);\n      }\n      resolution = constrainedResolution;\n    }\n\n    // calculate center\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerRotX = (minRotX + maxRotX) / 2;\n    var centerRotY = (minRotY + maxRotY) / 2;\n    centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n    centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n    var centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n    var centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n    var center = [centerX, centerY];\n    var callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animate({\n        resolution: resolution,\n        center: center,\n        duration: options.duration,\n        easing: options.easing\n      }, callback);\n    } else {\n      this.setResolution(resolution);\n      this.setCenter(center);\n      animationCallback(callback, true);\n    }\n  };\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  View.prototype.centerOn = function centerOn (coordinate, size, position) {\n    // calculate rotated position\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n    var rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n    var resolution = this.getResolution();\n    rotX += (size[0] / 2 - position[0]) * resolution;\n    rotY += (position[1] - size[1] / 2) * resolution;\n\n    // go back to original angle\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerX = rotX * cosAngle - rotY * sinAngle;\n    var centerY = rotY * cosAngle + rotX * sinAngle;\n\n    this.setCenter([centerX, centerY]);\n  };\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  View.prototype.isDef = function isDef () {\n    return !!this.getCenter() && this.getResolution() !== undefined;\n  };\n\n  /**\n   * Rotate the view around a given coordinate.\n   * @param {number} rotation New rotation value for the view.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The rotation center.\n   * @api\n   */\n  View.prototype.rotate = function rotate (rotation, opt_anchor) {\n    if (opt_anchor !== undefined) {\n      var center = this.calculateCenterRotate(rotation, opt_anchor);\n      this.setCenter(center);\n    }\n    this.setRotation(rotation);\n  };\n\n  /**\n   * Set the center of the current view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setCenter = function setCenter (center) {\n    this.set(ViewProperty.CENTER, center);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * @param {ViewHint} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  View.prototype.setHint = function setHint (hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  };\n\n  /**\n   * Set the resolution for this view.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setResolution = function setResolution (resolution) {\n    this.set(ViewProperty.RESOLUTION, resolution);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Set the rotation for this view.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.setRotation = function setRotation (rotation) {\n    this.set(ViewProperty.ROTATION, rotation);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Zoom to a specific zoom level.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  View.prototype.setZoom = function setZoom (zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  };\n\n  return View;\n}(BaseObject));\n\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function() {\n    callback(returnValue);\n  }, 0);\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  var resolutionConstraint;\n  var maxResolution;\n  var minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  var defaultMaxZoom = 28;\n  var defaultZoomFactor = 2;\n\n  var minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  var maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  var zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    var resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    var projection = createProjection(options.projection, 'EPSG:3857');\n    var extent = projection.getExtent();\n    var size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    var defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    var defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  var enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    var constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n\n//# sourceMappingURL=View.js.map","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n\n//# sourceMappingURL=TileState.js.map","/** @namespace  ol.ext\n */\n/*global ol*/\nif (window.ol && !ol.ext) {\n  ol.ext = {};\n}\n\n/** Inherit the prototype methods from one constructor into another.\n * replace deprecated ol method\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function module:ol.inherits\n * @api\n */\nvar ol_ext_inherits = function(child,parent) {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n\n// Compatibilty with ol > 5 to be removed when v6 is out\nif (window.ol) {\n  if (!ol.inherits) ol.inherits = ol_ext_inherits;\n}\n\n/* IE Polyfill */\n// NodeList.forEach\nif (window.NodeList && !NodeList.prototype.forEach) {\n  NodeList.prototype.forEach = Array.prototype.forEach;\n}\n// Element.remove\nif (window.Element && !Element.prototype.remove) {\n  Element.prototype.remove = function() {\n    if (this.parentNode) this.parentNode.removeChild(this);\n  }\n}\n/* End Polyfill */\n\nexport {ol_ext_inherits}\nexport default ol_ext_inherits\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Button from './Button'\n\n/** A simple toggle control\n * The control can be created with an interaction to control its activation.\n *\n * @constructor\n * @extends {ol_control_Button}\n * @fires change:active, change:disable\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {String} options.title title of the control\n *  @param {String} options.html html to insert in the control\n *  @param {ol.interaction} options.interaction interaction associated with the control\n *  @param {bool} options.active the control is created active, default false\n *  @param {bool} options.disable the control is created disabled, default false\n *  @param {ol.control.Bar} options.bar a subbar associated with the control (drawn when active if control is nested in a ol.control.Bar)\n *  @param {bool} options.autoActive the control will activate when shown in an ol.control.Bar, default false\n *  @param {function} options.onToggle callback when control is clicked (or use change:active event)\n */\nvar ol_control_Toggle = function(options) {\n  options = options || {};\n  var self = this;\n\n  this.interaction_ = options.interaction;\n  if (this.interaction_) {\n    this.interaction_.setActive(options.active);\n    this.interaction_.on(\"change:active\", function() {\n      self.setActive(self.interaction_.getActive());\n    });\n  }\n\n  if (options.toggleFn) options.onToggle = options.toggleFn; // compat old version\n  options.handleClick = function() {\n    self.toggle();\n    if (options.onToggle) options.onToggle.call(self, self.getActive());\n  };\n  options.className = (options.className||\"\") + \" ol-toggle\";\n  ol_control_Button.call(this, options);\n\n  this.set(\"title\", options.title);\n\n  this.set (\"autoActivate\", options.autoActivate);\n  if (options.bar) {\n    this.subbar_ = options.bar;\n    this.subbar_.setTarget(this.element);\n    this.subbar_.element.classList.add(\"ol-option-bar\");\n  }\n\n  this.setActive (options.active);\n  this.setDisable (options.disable);\n};\nol_ext_inherits(ol_control_Toggle, ol_control_Button);\n\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Toggle.prototype.setMap = function(map) {\n  if (!map && this.getMap()) {\n    if (this.interaction_) {\n      this.getMap().removeInteraction (this.interaction_);\n    }\n    if (this.subbar_) this.getMap().removeControl (this.subbar_);\n  }\n\n  ol_control_Button.prototype.setMap.call(this, map);\n\n  if (map) {\n    if (this.interaction_) map.addInteraction (this.interaction_);\n    if (this.subbar_) map.addControl (this.subbar_);\n  }\n};\n\n/** Get the subbar associated with a control\n * @return {ol_control_Bar}\n */\nol_control_Toggle.prototype.getSubBar = function () {\n  return this.subbar_;\n};\n\n/**\n * Test if the control is disabled.\n * @return {bool}.\n * @api stable\n */\nol_control_Toggle.prototype.getDisable = function() {\n  var button = this.element.querySelector(\"button\");\n  return button && button.disabled;\n};\n\n/** Disable the control. If disable, the control will be deactivated too.\n* @param {bool} b disable (or enable) the control, default false (enable)\n*/\nol_control_Toggle.prototype.setDisable = function(b) {\n  if (this.getDisable()==b) return;\n  this.element.querySelector(\"button\").disabled = b;\n  if (b && this.getActive()) this.setActive(false);\n\n  this.dispatchEvent({ type:'change:disable', key:'disable', oldValue:!b, disable:b });\n};\n\n/**\n * Test if the control is active.\n * @return {bool}.\n * @api stable\n */\nol_control_Toggle.prototype.getActive = function() {\n  return this.element.classList.contains(\"ol-active\");\n};\n\n/** Toggle control state active/deactive\n */\nol_control_Toggle.prototype.toggle = function() {\n  if (this.getActive()) this.setActive(false);\n  else this.setActive(true);\n};\n\n/** Change control state\n * @param {bool} b activate or deactivate the control, default false\n */\nol_control_Toggle.prototype.setActive = function(b) {\t\n  if (this.interaction_) this.interaction_.setActive (b);\n  if (this.subbar_) this.subbar_.setActive(b);\n  if (this.getActive()===b) return;\n  if (b) this.element.classList.add(\"ol-active\");\n  else this.element.classList.remove(\"ol-active\");\n\n  this.dispatchEvent({ type:'change:active', key:'active', oldValue:!b, active:b });\n};\n\n/** Set the control interaction\n* @param {_ol_interaction_} i interaction to associate with the control\n*/\nol_control_Toggle.prototype.setInteraction = function(i) {\n  this.interaction_ = i;\n};\n\n/** Get the control interaction\n* @return {_ol_interaction_} interaction associated with the control\n*/\nol_control_Toggle.prototype.getInteraction = function() {\n  return this.interaction_;\n};\n\nexport default ol_control_Toggle\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Button from \"./Button\";\n\n/** A simple push button control drawn as text\n * @constructor\n * @extends {ol_control_Button}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\n\nvar ol_control_TextButton = function(options)\n{\toptions = options || {};\n    options.className = (options.className||\"\") + \" ol-text-button\";\n    ol_control_Button.call(this, options);\n};\nol_ext_inherits(ol_control_TextButton, ol_control_Button);\n\nexport default ol_control_TextButton\n","/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Select from 'ol/interaction/Select'\nimport ol_source_Vector from 'ol/source/Vector'\n\n/** A Select interaction to delete features on click.\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires deletestart\n * @fires deleteend\n * @param {*} options ol.interaction.Select options\n */\nvar ol_interaction_Delete = function(options) {\n  ol_interaction_Select.call(this, options);\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.delete(e.selected);\n  }.bind(this));\n};\nol_ext_inherits(ol_interaction_Delete, ol_interaction_Select);\n\n/** Get vector source of the map\n * @return {Array<ol.source.Vector>}\n */\nol_interaction_Delete.prototype._getSources = function(layers) {\n  if (!this.getMap()) return [];\n  if (!layers) layers = this.getMap().getLayers();\n  var sources = [];\n  layers.forEach(function (l) {\n    // LayerGroup\n    if (l.getLayers) {\n      sources = sources.concat(this._getSources(l.getLayers()));\n    } else {\n      if (l.getSource && l.getSource() instanceof ol_source_Vector) {\n        sources.push(l.getSource());\n      }\n    }\n  }.bind(this));\n  return sources;\n};\n\n/** Delete features: remove the features from the map (from all layers in the map)\n * @param {ol.Collection<ol.Feature>|Array<ol.Feature>} features The features to delete\n * @api\n */\nol_interaction_Delete.prototype.delete = function(features) {\n  if (features && (features.length || features.getLength())) {\n    this.dispatchEvent({ type: 'deletestart', features: features });\n    var delFeatures = [];\n    // Get the sources concerned\n    this._getSources().forEach(function (source) {\n      try {\n        // Try to delete features in the source\n        features.forEach(function(f) {\n          source.removeFeature(f);\n          delFeatures.push(f);\n        });\n      } catch(e) { /* ok */ }\n    })\n    this.dispatchEvent({ type: 'deleteend', features: delFeatures });\n  }\n};\n\nexport default ol_interaction_Delete","import ol_style_Style from 'ol/style/Style'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_style_Fill from 'ol/style/Fill'\n\nvar ol_style_Style_defaultStyle;\n\n(function() {\n\n// Style\nvar white = [255, 255, 255, 1];\nvar blue = [0, 153, 255, 1];\nvar width = 3;\n\nvar defaultEditStyle = [\n  new ol_style_Style({\n    stroke: new ol_style_Stroke({ color: white, width: width + 2 })\n  }),\n  new ol_style_Style({\n    image: new ol_style_Circle({\n      radius: width * 2,\n      fill: new ol_style_Fill({ color: blue }),\n      stroke: new ol_style_Stroke({ color: white, width: width / 2 })\n    }),\n    stroke: new ol_style_Stroke({ color: blue, width: width }),\n    fill: new ol_style_Fill({\n      color: [255, 255, 255, 0.5]\n    })\n  })\n];\n\n/**\n * Get the default style\n * @param {boolean|*} [edit] true to get editing style or a { color, fillColor } object, default get default blue style\n * @return {Array<ol.style.Style>}\n */\nol_style_Style_defaultStyle = function(edit) {\n  if (edit===true) {\n    return defaultEditStyle;\n  } else {\n    edit = edit || {};\n    var fill = new ol_style_Fill({\n      color: edit.fillColor || 'rgba(255,255,255,0.4)'\n    });\n    var stroke = new ol_style_Stroke({\n      color: edit.color || '#3399CC',\n      width: 1.25\n    });\n    var style = new ol_style_Style({\n      image: new ol_style_Circle({\n        fill: fill,\n        stroke: stroke,\n        radius: 5\n      }),\n      fill: fill,\n      stroke: stroke\n    });\n    return [ style ];\n  }\n};\n\n})();\n\nexport default ol_style_Style_defaultStyle\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\n  Usefull function to handle geometric operations\n*/\n\nimport {getCenter as ol_extent_getCenter} from 'ol/extent'\n\n/** Distance beetween 2 points\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {number} distance\n */\nvar ol_coordinate_dist2d = function(p1, p2) {\n  var dx = p1[0]-p2[0];\n  var dy = p1[1]-p2[1];\n  return Math.sqrt(dx*dx+dy*dy);\n}\n\n/** 2 points are equal\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {boolean}\n */\nvar ol_coordinate_equal = function(p1, p2) {\n  return (p1[0]==p2[0] && p1[1]==p2[1]);\n}\n\n/** Get center coordinate of a feature\n * @param {ol.Feature} f\n * @return {ol.coordinate} the center\n */\nvar ol_coordinate_getFeatureCenter = function(f) {\n  return ol_coordinate_getGeomCenter (f.getGeometry());\n};\n\n/** Get center coordinate of a geometry\n* @param {ol.Feature} geom\n* @return {ol.Coordinate} the center\n*/\nvar ol_coordinate_getGeomCenter = function(geom) {\n  switch (geom.getType()) {\n    case 'Point': \n      return geom.getCoordinates();\n    case \"MultiPolygon\":\n            geom = geom.getPolygon(0);\n            // fallthrough\n    case \"Polygon\":\n      return geom.getInteriorPoint().getCoordinates();\n    default:\n      return geom.getClosestPoint(ol_extent_getCenter(geom.getExtent()));\n  }\n};\n\n/** Offset a polyline\n * @param {Array<ol.Coordinate>} coords\n * @param {number} offset\n * @return {Array<ol.Coordinate>} resulting coord\n * @see http://stackoverflow.com/a/11970006/796832\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\n */\nvar ol_coordinate_offsetCoords = function (coords, offset) {\n  var path = [];\n  var N = coords.length-1;\n  var max = N;\n  var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\n  var p0, p1, p2;\n  var isClosed = ol_coordinate_equal(coords[0],coords[N]);\n  if (!isClosed) {\n    p0 = coords[0];\n    p1 = coords[1];\n    p2 = [\n      p0[0] + (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\n      p0[1] - (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n    coords.push(coords[N])\n    N++;\n    max--;\n  }\n  for (var i = 0; i < max; i++) {\n    p0 = coords[i];\n    p1 = coords[(i+1) % N];\n    p2 = coords[(i+2) % N];\n\n    mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\n    mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\n    // Prevent alignements\n    if (Math.abs(mi-mi1) > 1e-10) {\n      li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\n      li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\n      ri = p0[0] + offset*(p1[1] - p0[1])/li;\n      ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\n      si = p0[1] - offset*(p1[0] - p0[0])/li;\n      si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\n      Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\n      Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\n\n      // Correction for vertical lines\n      if(p1[0] - p0[0] == 0) {\n        Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\n        Yi1 = mi1*Xi1 - mi1*ri1 + si1;\n      }\n      if (p2[0] - p1[0] == 0 ) {\n        Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\n        Yi1 = mi*Xi1 - mi*ri + si;\n      }\n\n      path.push([Xi1, Yi1]);\n    }\n  }\n  if (isClosed) {\n    path.push(path[0]);\n  } else {\n    coords.pop();\n    p0 = coords[coords.length-1];\n    p1 = coords[coords.length-2];\n    p2 = [\n      p0[0] - (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\n      p0[1] + (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n  }\n  return path;\n}\n\n/** Find the segment a point belongs to\n * @param {ol.Coordinate} pt\n * @param {Array<ol.Coordinate>} coords\n * @return {} the index (-1 if not found) and the segment\n */\nvar ol_coordinate_findSegment = function (pt, coords) {\n  for (var i=0; i<coords.length-1; i++) {\n    var p0 = coords[i];\n    var p1 = coords[i+1];\n    if (ol_coordinate_equal(pt, p0) || ol_coordinate_equal(pt, p1)) {\n      return { index:1, segment: [p0,p1] };\n    } else {\n      var d0 = ol_coordinate_dist2d(p0,p1);\n      var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\n      var d1 = ol_coordinate_dist2d(p0,pt);\n      var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\n      if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\n        return { index:1, segment: [p0,p1] };\n      }\n    }\n  }\n  return { index: -1 };\n};\n\n/**\n * Split a Polygon geom with horizontal lines\n * @param {Array<ol.Coordinate>} geom\n * @param {number} y the y to split\n * @param {number} n contour index\n * @return {Array<Array<ol.Coordinate>>}\n */\nvar ol_coordinate_splitH = function (geom, y, n) {\n  var x, abs;\n  var list = [];\n  for (var i=0; i<geom.length-1; i++) {\n    // Hole separator?\n    if (!geom[i].length || !geom[i+1].length) continue;\n    // Intersect\n    if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\n      abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\n      x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\n      list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\n    }\n  }\n  // Sort x\n  list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\n  // Horizontal segment\n  var result = [];\n  for (var j=0; j<list.length-1; j += 2) {\n    result.push([list[j], list[j+1]])\n  }\n  return result;\n};\n\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\nimport ol_geom_MultiLineString from 'ol/geom/MultiLineString'\nimport ol_geom_MultiPoint from 'ol/geom/MultiPoint'\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\n\n/** Create a geometry given a type and coordinates */\nvar ol_geom_createFromType = function (type, coordinates) {\n  switch (type) {\n    case 'LineString': return new ol_geom_LineString(coordinates);\n    case 'LinearRing': return new ol_geom_LinearRing(coordinates);\n    case 'MultiLineString': return new ol_geom_MultiLineString(coordinates);\n    case 'MultiPoint': return new ol_geom_MultiPoint(coordinates);\n    case 'MultiPolygon': return new ol_geom_MultiPolygon(coordinates);\n    case 'Point': return new ol_geom_Point(coordinates);\n    case 'Polygon': return new ol_geom_Polygon(coordinates);\n    default:\n      console.error('[createFromType] Unsupported type: '+type);\n      return null;\n  }\n};\n\nexport {ol_geom_createFromType}\nexport {ol_coordinate_dist2d, ol_coordinate_equal, ol_coordinate_findSegment, ol_coordinate_getFeatureCenter, ol_coordinate_getGeomCenter, ol_coordinate_offsetCoords, ol_coordinate_splitH}\n\n/** Intersect 2 lines\n * @param {Arrar<ol.coordinate>} d1\n * @param {Arrar<ol.coordinate>} d2\n */\nvar ol_coordinate_getIntersectionPoint = function (d1, d2) {\n  var d1x = d1[1][0] - d1[0][0];\n  var d1y = d1[1][1] - d1[0][1];\n  var d2x = d2[1][0] - d2[0][0];\n  var d2y = d2[1][1] - d2[0][1];\n  var det = d1x * d2y - d1y * d2x;\n  if (det != 0) {\n    var k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\n    return [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\n  } else {\n    return false;\n  }\n};\n\nexport { ol_coordinate_getIntersectionPoint }\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport {ol_coordinate_dist2d, ol_coordinate_findSegment, ol_coordinate_offsetCoords} from \"../geom/GeomUtils\";\n\nimport ol_style_Style_defaultStyle from '../style/defaultStyle'\n\n/** Offset interaction for offseting feature geometry\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires offsetstart\n * @fires offsetting\n * @fires offsetend\n * @param {any} options\n *\t@param {ol.layer.Vector | Array<ol.layer.Vector>} options.layers list of feature to transform \n *\t@param {ol.Collection.<ol.Feature>} options.features collection of feature to transform\n *\t@param {ol.source.Vector | undefined} options.source source to duplicate feature when ctrl key is down\n *\t@param {boolean} options.duplicate force feature to duplicate (source must be set)\n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\n */\nvar ol_interaction_Offset = function(options) {\n  if (!options) options = {};\n\n\t// Extend pointer\n\tol_interaction_Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n    \n\t// Collection of feature to transform\n\tthis.features_ = options.features;\n\t// List of layers to transform\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  // duplicate\n  this.set('duplicate', options.duplicate);\n  this.source_ = options.source;\n  // Style\n  this._style = (typeof (options.style) === 'function') ? options.style : function () { \n    if (options.style) return options.style;\n    else return ol_style_Style_defaultStyle(true);\n  };\n\n  // init\n  this.previousCursor_ = false;\n};\nol_ext_inherits(ol_interaction_Offset, ol_interaction_Pointer);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Offset.prototype.setMap = function(map) {\n\tol_interaction_Pointer.prototype.setMap.call (this, map);\n};\n\n/** Get Feature at pixel\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {any} a feature and the hit point\n * @private\n */\nol_interaction_Offset.prototype.getFeatureAtPixel_ = function(e) {\n  var self = this;\n\treturn this.getMap().forEachFeatureAtPixel(e.pixel,\n\t\tfunction(feature, layer) {\n      var current;\n\t\t\t// feature belong to a layer\n\t\t\tif (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) {\n            current = feature;\n            break;\n          }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// feature in the collection\n\t\t\telse if (self.features_) {\n        self.features_.forEach (function(f) {\n          if (f===feature) {\n            current = feature \n          }\n        });\n\t\t\t}\n\t\t\t// Others\n\t\t\telse {\n        current = feature;\n      }\n\n      // Only poygon or linestring\n      var typeGeom = current.getGeometry().getType();\n      if (current && /Polygon|LineString/.test(typeGeom)) {\n        if (typeGeom==='Polygon' && current.getGeometry().getCoordinates().length>1) return false;\n        // test distance\n        var p = current.getGeometry().getClosestPoint(e.coordinate);\n        var dx = p[0]-e.coordinate[0];\n        var dy = p[1]-e.coordinate[1];\n        var d = Math.sqrt(dx*dx+dy*dy) / e.frameState.viewState.resolution;\n      \n        if (d<5) {\n          return { \n            feature: current, \n            hit: p, \n            coordinates: current.getGeometry().getCoordinates(),\n            geom: current.getGeometry().clone(),\n            geomType: typeGeom\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n\t\t},  { hitTolerance: 5 });\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol_interaction_Offset.prototype.handleDownEvent_ = function(e) {\t\n  this.current_ = this.getFeatureAtPixel_(e);\n  if (this.current_) {\n    this.currentStyle_ = this.current_.feature.getStyle();\n    this.current_.feature.setStyle(this._style(this.current_.feature));\n    if (this.source_ && (this.get('duplicate') || e.originalEvent.ctrlKey)) {\n      this.current_.feature = this.current_.feature.clone();\n      this.source_.addFeature(this.current_.feature);\n    } else {\n      // Modify the current feature\n      this.dispatchEvent({ type:'modifystart', features: [ this.current_.feature ] });\n    }\n    this.dispatchEvent({ type:'offsetstart', feature: this.current_.feature, offset: 0 });\n    return true;\n  } else  {\n    return false;\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol_interaction_Offset.prototype.handleDragEvent_ = function(e) {\n  var p = this.current_.geom.getClosestPoint(e.coordinate);\n  var d = ol_coordinate_dist2d(p, e.coordinate);\n  var seg, v1, v2, offset;\n  switch (this.current_.geomType) {\n    case  'Polygon': {\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates[0]).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n\n        offset = [];\n        for (var i=0; i<this.current_.coordinates.length; i++) {\n          offset.push( ol_coordinate_offsetCoords(this.current_.coordinates[i], i==0 ? d : -d) );\n        }\n        this.current_.feature.setGeometry(new ol_geom_Polygon(offset));\n      }\n      break;\n    }\n    case 'LineString': {\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = ol_coordinate_offsetCoords(this.current_.coordinates, d);\n        this.current_.feature.setGeometry(new ol_geom_LineString(offset));\n      }\n      break;\n    }\n    default: {\n      break;\n    }\n  }\n  this.dispatchEvent({ type:'offsetting', feature: this.current_.feature, offset: d, segment: [p, e.coordinate], coordinate: e.coordinate });  \n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol_interaction_Offset.prototype.handleUpEvent_ = function(e) {\n  this.dispatchEvent({ type:'offsetend', feature: this.current_.feature, coordinate: e.coordinate }); \n  this.current_.feature.setStyle(this.currentStyle_);\n  this.current_ = false;\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Event.\n * @private\n */\nol_interaction_Offset.prototype.handleMoveEvent_ = function(e) {\t\n  var f = this.getFeatureAtPixel_(e);\n  if (f) {\n    if (this.previousCursor_ === false) {\n      this.previousCursor_ = e.map.getTargetElement().style.cursor;\n    }\n    e.map.getTargetElement().style.cursor = 'pointer';\n  } else {\n    e.map.getTargetElement().style.cursor = this.previousCursor_;\n    this.previousCursor_ = false;\n  }\n};\n\nexport default ol_interaction_Offset\n","import {ol_coordinate_equal} from \"./GeomUtils\";\nimport ol_geom_LineString from \"ol/geom/LineString\";\n\n/** Split a lineString by a point or a list of points\n *\tNB: points must be on the line, use getClosestPoint() to get one\n* @param {ol.Coordinate | Array<ol.Coordinate>} pt points to split the line\n* @param {Number} tol distance tolerance for 2 points to be equal\n*/\nol_geom_LineString.prototype.splitAt = function(pt, tol) {\n  var i;\n  if (!pt) return [this];\n    if (!tol) tol = 1e-10;\n    // Test if list of points\n    if (pt.length && pt[0].length) {\n      var result = [this];\n      for (i=0; i<pt.length; i++) {\n        var r = [];\n        for (var k=0; k<result.length; k++) {\n          var ri = result[k].splitAt(pt[i], tol);\n          r = r.concat(ri);\n        }\n        result = r;\n      }\n      return result;\n    }\n    // Nothing to do\n    if (ol_coordinate_equal(pt,this.getFirstCoordinate())\n    || ol_coordinate_equal(pt,this.getLastCoordinate())) {\n      return [this];\n    }\n    // Get\n    var c0 = this.getCoordinates();\n    var ci=[c0[0]];\n    var c = [];\n    for (i=0; i<c0.length-1; i++) {\n      // Filter equal points\n      if (ol_coordinate_equal(c0[i],c0[i+1])) continue;\n      // Extremity found\n      if (ol_coordinate_equal(pt,c0[i+1])) {\n        ci.push(c0[i+1]);\n        c.push(new ol_geom_LineString(ci));\n        ci = [];\n      }\n      // Test alignement\n      else if (!ol_coordinate_equal(pt,c0[i])) {\n        var d1, d2, split=false;\n        if (c0[i][0] == c0[i+1][0]) {\n          d1 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (c0[i][0] == pt[0]) && (0 < d1 && d1 <= 1)\n        } else if (c0[i][1] == c0[i+1][1]) {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          split = (c0[i][1] == pt[1]) && (0 < d1 && d1 <= 1)\n        } else {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          d2 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (Math.abs(d1-d2) <= tol && 0 < d1 && d1 <= 1)\n        }\n        // pt is inside the segment > split\n        if (split) {\n          ci.push(pt);\n          c.push (new ol_geom_LineString(ci));\n          ci = [pt];\n        }\n      }\n      ci.push(c0[i+1]);\n    }\n    if (ci.length>1) c.push (new ol_geom_LineString(ci));\n    if (c.length) return c;\n    else return [this];\n}\n\n// import('ol-ext/geom/LineStringSplitAt')","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport {ol_coordinate_dist2d} from \"../geom/GeomUtils\";\nimport '../geom/LineStringSplitAt'\n\n/** Interaction split interaction for splitting feature geometry\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires  beforesplit, aftersplit, pointermove\n * @param {*} \n *  @param {ol.source.Vector|Array<ol.source.Vector>} options.source a list of source to split (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to split\n *  @param {integer} options.snapDistance distance (in px) to snap to an object, default 25px\n *\t@param {string|undefined} options.cursor cursor name to display when hovering an objet\n *  @param {function|undefined} opttion.filter a filter that takes a feature and return true if it can be clipped, default always split.\n *  @param ol_style_Style | Array<ol_style_Style> | false | undefined} options.featureStyle Style for the selected features, choose false if you don't want feature selection. By default the default edit style is used.\n *  @param {ol_style_Style | Array<ol_style_Style> | undefined} options.sketchStyle Style for the sektch features. \n *  @param {function|undefined} options.tolerance Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split.  Default is 1e-10.\n */\nvar ol_interaction_Split = function(options) {\n  if (!options) options = {};\n\n  ol_interaction_Interaction.call(this, {\n    handleEvent: function(e) {\n      switch (e.type) {\n        case \"singleclick\":\n          return this.handleDownEvent(e);\n        case \"pointermove\":\n          return this.handleMoveEvent(e);\n        default: \n          return true;\n      }\n      //return true;\n    }\n  });\n\n  // Snap distance (in px)\n  this.snapDistance_ = options.snapDistance || 25;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = options.tolerance || 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n\n  if (options.features) {\n    this.sources_.push (new ol_source_Vector({ features: options.features }));\n  }\n\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n\n  // Default style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var fill = new ol_style_Fill({ color: 'rgba(255,255,255,0.4)' });\n  var stroke = new ol_style_Stroke({\n    color: '#3399CC',\n    width: 1.25\n  });\n  var sketchStyle = [\n    new ol_style_Style({\n      image: new ol_style_Circle({\n        fill: fill,\n        stroke: stroke,\n        radius: 5\n      }),\n      fill: fill,\n      stroke: stroke\n    })\n  ];\n  var featureStyle = [\n    new ol_style_Style({\n      stroke: new ol_style_Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new ol_style_Style({\n      image: new ol_style_Circle({\n        radius: 2*width,\n        fill: new ol_style_Fill({\n          color: blue\n        }),\n        stroke: new ol_style_Stroke({\n          color: white,\n          width: width/2\n        })\n      }),\n      stroke: new ol_style_Stroke({\n          color: blue,\n          width: width\n        })\n    }),\n  ];\n\n  // Custom style\n  if (options.sketchStyle) sketchStyle = options.sketchStyle instanceof Array ? options.sketchStyle : [options.sketchStyle];\n  if (options.featureStyle) featureStyle = options.featureStyle instanceof Array ? options.featureStyle : [options.featureStyle];\n\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      useSpatialIndex: false\n    }),\n    name:'Split overlay',\n    displayInLayerSwitcher: false,\n    style: function(f) {\n      if (f._sketch_) return sketchStyle;\n      else return featureStyle;\n    }\n  });\n\n};\nol_ext_inherits(ol_interaction_Split, ol_interaction_Interaction);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Split.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {ol.feature} \n * @private\n */\nol_interaction_Split.prototype.getClosestFeature = function(e) {\n  var source, f, c, g, d = this.snapDistance_+1;\n  // Look for closest point in the sources\n  this.sources_.forEach(function(si) {\n    var fi = si.getClosestFeatureToCoordinate(e.coordinate);\n    if (fi && fi.getGeometry().splitAt) {\n      var ci = fi.getGeometry().getClosestPoint(e.coordinate);\n      var gi = new ol_geom_LineString([e.coordinate,ci]);\n      var di = gi.getLength() / e.frameState.viewState.resolution;\n      if (di < d) {\n        source = si;\n        d = di;\n        f = fi;\n        g = gi;\n        c = ci;\n      }\n    }\n  });\n  // Snap ?\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry().getCoordinates());\n    var p = this.getMap().getPixelFromCoordinate(coord);\n    if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\n      c = coord;\n    }\n    //\n    return { source:source, feature:f, coord: c, link: g };\n  }\n}\n\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {Array<ol.coordinate>} coords list of coordinates\n* @return {ol.coordinate} the nearest coordinate in the list\n*/\nol_interaction_Split.prototype.getNearestCoord = function(pt, coords) {\n  var d, dm=Number.MAX_VALUE, p0;\n  for (var i=0; i < coords.length; i++) {\n    d = ol_coordinate_dist2d (pt, coords[i]);\n    if (d < dm) {\n      dm = d;\n      p0 = coords[i];\n    }\n  }\n  return p0;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol_interaction_Split.prototype.handleDownEvent = function(evt) {\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n\n  if (current) {\n    var self = this;\n    self.overlayLayer_.getSource().clear();\n    var split = current.feature.getGeometry().splitAt(current.coord, this.tolerance_);\n    var i;\n    if (split.length > 1) {\n      var tosplit = [];\n      for (i=0; i<split.length; i++) {\n        var f = current.feature.clone();\n        f.setGeometry(split[i]);\n        tosplit.push(f);\n      }\n      self.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.removeFeature(current.feature);\n      for (i=0; i<tosplit.length; i++) {\n        current.source.addFeature(tosplit[i]);\n      }\n      self.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n    }\n  }\n  return false;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol_interaction_Split.prototype.handleMoveEvent = function(e) {\n  var map = e.map;\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n\n  if (current && this.filterSplit_(current.feature)) {\n    var p, l;\n    // Draw sketch\n    this.overlayLayer_.getSource().addFeature(current.feature);\n    p = new ol_Feature(new ol_geom_Point(current.coord));\n    p._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(p);\n    //\n    l = new ol_Feature(current.link);\n    l._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(l);\n    // move event\n    this.dispatchEvent({\n      type: 'pointermove',\n      coordinate: e.coordinate,\n      frameState: e.frameState,\n      originalEvent: e.originalEvent,\n      map: e.map,\n      pixel: e.pixel,\n      feature: current.feature,\n      linkGeometry: current.link\n    });\n  } else {\n    this.dispatchEvent(e);\n  }\n\n  var element = map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\nexport default ol_interaction_Split\n","import ol_ext_inherits from '../util/ext'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_Collection from 'ol/Collection'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_style_RegularShape from 'ol/style/RegularShape'\nimport {fromExtent as ol_geom_Polygon_fromExtent} from 'ol/geom/Polygon'\nimport {boundingExtent as ol_extent_boundingExtent, buffer as ol_extent_buffer, createEmpty as ol_extent_createEmpty, extend as ol_extent_extend, getCenter as ol_extent_getCenter} from 'ol/extent'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\n\n/** Interaction rotate\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires select | rotatestart | rotating | rotateend | translatestart | translating | translateend | scalestart | scaling | scaleend\n * @param {any} options\n *  @param {function} options.filter A function that takes a Feature and a Layer and returns true if the feature may be transformed or false otherwise.\n *  @param {Array<ol.Layer>} options.layers array of layers to transform,\n *  @param {ol.Collection<ol.Feature>} options.features collection of feature to transform,\n *\t@param {ol.EventsConditionType|undefined} options.condition A function that takes an ol.MapBrowserEvent and a feature collection and returns a boolean to indicate whether that event should be handled. default: ol.events.condition.always.\n *\t@param {ol.EventsConditionType|undefined} options.addCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled ie. the feature will be added to the transforms features. default: ol.events.condition.never.\n *\t@param {number | undefined} options.hitTolerance Tolerance to select feature in pixel, default 0\n *\t@param {bool} options.translateFeature Translate when click on feature\n *\t@param {bool} options.translate Can translate the feature\n *  @param {bool} options.translateBBox Enable translate when the user drags inside the bounding box\n *\t@param {bool} options.stretch can stretch the feature\n *\t@param {bool} options.scale can scale the feature\n *\t@param {bool} options.rotate can rotate the feature\n *\t@param {bool} options.noFlip prevent the feature geometry to flip, default false\n *\t@param {bool} options.selection the intraction handle selection/deselection, if not use the select prototype to add features to transform, default true\n *\t@param {ol.events.ConditionType | undefined} options.keepAspectRatio A function that takes an ol.MapBrowserEvent and returns a boolean to keep aspect ratio, default ol.events.condition.shiftKeyOnly.\n *\t@param {ol.events.ConditionType | undefined} options.modifyCenter A function that takes an ol.MapBrowserEvent and returns a boolean to apply scale & strech from the center, default ol.events.condition.metaKey or ol.events.condition.ctrlKey.\n *\t@param {boolean} options.enableRotatedTransform Enable transform when map is rotated\n *\t@param {} options.style list of ol.style for handles\n *\n */\nvar ol_interaction_Transform = function(options) {\n  if (!options) options = {};\n\tvar self = this;\n\n  this.selection_ = new ol_Collection();\n\n\t// Create a new overlay layer for the sketch\n\tthis.handles_ = new ol_Collection();\n\tthis.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      features: this.handles_,\n      useSpatialIndex: false,\n      wrapX: false // For vector editing across the -180 and 180 meridians to work properly, this should be set to false\n    }),\n    name:'Transform overlay',\n    displayInLayerSwitcher: false,\n    // Return the style according to the handle type\n    style: function (feature) {\n      return (self.style[(feature.get('handle')||'default')+(feature.get('constraint')||'')+(feature.get('option')||'')]);\n    },\n  });\n\n  // Extend pointer\n  ol_interaction_Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n\n  // Collection of feature to transform\n  this.features_ = options.features;\n  // Filter or list of layers to transform\n  if (typeof(options.filter)==='function') this._filter = options.filter;\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n\n  this._handleEvent = options.condition || function() { return true; };\n  this.addFn_ = options.addCondition || function() { return false; };\n  /* Translate when click on feature */\n  this.set('translateFeature', (options.translateFeature!==false));\n  /* Can translate the feature */\n  this.set('translate', (options.translate!==false));\n  /* Translate when click on the bounding box */\n  this.set('translateBBox', (options.translateBBox===true));\n  /* Can stretch the feature */\n  this.set('stretch', (options.stretch!==false));\n  /* Can scale the feature */\n  this.set('scale', (options.scale!==false));\n  /* Can rotate the feature */\n  this.set('rotate', (options.rotate!==false));\n  /* Keep aspect ratio */\n  this.set('keepAspectRatio', (options.keepAspectRatio || function(e){ return e.originalEvent.shiftKey }));\n  /* Modify center */\n  this.set('modifyCenter', (options.modifyCenter || function(e){ return e.originalEvent.metaKey || e.originalEvent.ctrlKey }));\n  /* Prevent flip */\n  this.set('noFlip', (options.noFlip || false));\n  /* Handle selection */\n  this.set('selection', (options.selection !== false));\n  /*  */\n  this.set('hitTolerance', (options.hitTolerance || 0));\n  /* Enable view rotated transforms */\n  this.set('enableRotatedTransform', (options.enableRotatedTransform || false));\n\n\n  // Force redraw when changed\n  this.on ('propertychange', function() {\n    this.drawSketch_();\n  });\n\n  // setstyle\n  this.setDefaultStyle();\n};\nol_ext_inherits(ol_interaction_Transform, ol_interaction_Pointer);\n\n/** Cursors for transform\n*/\nol_interaction_Transform.prototype.Cursors = {\n  'default': 'auto',\n  'select': 'pointer',\n  'translate': 'move',\n  'rotate': 'move',\n  'rotate0': 'move',\n  'scale': 'nesw-resize',\n  'scale1': 'nwse-resize',\n  'scale2': 'nesw-resize',\n  'scale3': 'nwse-resize',\n  'scalev': 'ew-resize',\n  'scaleh1': 'ns-resize',\n  'scalev2': 'ew-resize',\n  'scaleh3': 'ns-resize'\n};\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Transform.prototype.setMap = function(map) {\n  var oldMap = this.getMap();\n  if (oldMap) {\n    var targetElement = oldMap.getTargetElement();\n    oldMap.removeLayer(this.overlayLayer_);\n    if (this.previousCursor_ && targetElement) {\n      targetElement.style.cursor = this.previousCursor_;\n    }\n    this.previousCursor_ = undefined;\n  }\n  ol_interaction_Pointer.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n  if (map === null) {\n    this.select(null);\n  }\n  if (map !== null) {\n    this.isTouch = /touch/.test(map.getViewport().className);\n    this.setDefaultStyle();\n  }\n};\n\n/**\n * Activate/deactivate interaction\n * @param {bool}\n * @api stable\n */\nol_interaction_Transform.prototype.setActive = function(b) {\n  this.select(null);\n  this.overlayLayer_.setVisible(b);\n  ol_interaction_Pointer.prototype.setActive.call (this, b);\n};\n\n/** Set efault sketch style\n*/\nol_interaction_Transform.prototype.setDefaultStyle = function() {\n  // Style\n  var stroke = new ol_style_Stroke({ color: [255,0,0,1], width: 1 });\n  var strokedash = new ol_style_Stroke({ color: [255,0,0,1], width: 1, lineDash:[4,4] });\n  var fill0 = new ol_style_Fill({ color:[255,0,0,0.01] });\n  var fill = new ol_style_Fill({ color:[255,255,255,0.8] });\n  var circle = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 15\n    });\n  circle.getAnchor()[0] = this.isTouch ? -10 : -5;\n  var bigpt = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 16 : 8,\n      points: 4,\n      angle: Math.PI/4\n    });\n  var smallpt = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 4,\n      angle: Math.PI/4\n    });\n  function createStyle (img, stroke, fill) {\n    return [ new ol_style_Style({image:img, stroke:stroke, fill:fill}) ];\n  }\n  /** Style for handles */\n  this.style = {\n    'default': createStyle (bigpt, strokedash, fill0),\n    'translate': createStyle (bigpt, stroke, fill),\n    'rotate': createStyle (circle, stroke, fill),\n    'rotate0': createStyle (bigpt, stroke, fill),\n    'scale': createStyle (bigpt, stroke, fill),\n    'scale1': createStyle (bigpt, stroke, fill),\n    'scale2': createStyle (bigpt, stroke, fill),\n    'scale3': createStyle (bigpt, stroke, fill),\n    'scalev': createStyle (smallpt, stroke, fill),\n    'scaleh1': createStyle (smallpt, stroke, fill),\n    'scalev2': createStyle (smallpt, stroke, fill),\n    'scaleh3': createStyle (smallpt, stroke, fill),\n  };\n  this.drawSketch_();\n}\n\n/**\n * Set sketch style.\n * @param {style} style Style name: 'default','translate','rotate','rotate0','scale','scale1','scale2','scale3','scalev','scaleh1','scalev2','scaleh3'\n * @param {ol.style.Style|Array<ol.style.Style>} olstyle\n * @api stable\n */\nol_interaction_Transform.prototype.setStyle = function(style, olstyle) {\n  if (!olstyle) return;\n  if (olstyle instanceof Array) this.style[style] = olstyle;\n  else this.style[style] = [ olstyle ];\n  for (var i=0; i<this.style[style].length; i++) {\n    var im = this.style[style][i].getImage();\n    if (im) {\n      if (style == 'rotate') im.getAnchor()[0] = -5;\n      if (this.isTouch) im.setScale(1.8);\n    }\n    var tx = this.style[style][i].getText();\n    if (tx) {\n      if (style == 'rotate') tx.setOffsetX(this.isTouch ? 14 : 7);\n      if (this.isTouch) tx.setScale(1.8);\n    }\n  }\n  this.drawSketch_();\n};\n\n/** Get Feature at pixel\n * @param {ol.Pixel}\n * @return {ol.feature}\n * @private\n */\nol_interaction_Transform.prototype.getFeatureAtPixel_ = function(pixel) {\n  var self = this;\n  return this.getMap().forEachFeatureAtPixel(pixel,\n    function(feature, layer) {\n      var found = false;\n      // Overlay ?\n      if (!layer) {\n        if (feature===self.bbox_) {\n          if (self.get('translateBBox')) {\n            return { feature: feature, handle: 'translate', constraint:'', option: '' };\n          } else {\n            return false;\n          }\n        }\n        self.handles_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature, handle:feature.get('handle'), constraint:feature.get('constraint'), option:feature.get('option') };\n      }\n      // No seletion\n      if (!self.get('selection')) {\n        // Return the currently selected feature the user is interacting with.\n        if (self.selection_.getArray().some(function(f) { return feature === f; })) {\n          return { feature: feature };\n        }\n        return null;\n      }\n      // filter condition\n      if (self._filter) {\n        if (self._filter(feature,layer)) return { feature: feature };\n        else return null;\n      }\n      // feature belong to a layer\n      else if (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) return { feature: feature };\n        }\n        return null;\n      }\n      // feature in the collection\n      else if (self.features_) {\n        self.features_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature };\n        else return null;\n      }\n      // Others\n      else return { feature: feature };\n    },\n    { hitTolerance: this.get('hitTolerance') }\n  ) || {};\n}\n\n/** Rotate feature from map view rotation\n * @param {ol.Feature} f the feature\n * @param {boolean} clone clone resulting geom\n * @param {ol.geom.Geometry} rotated geometry\n */\nol_interaction_Transform.prototype.getGeometryRotateToZero_ = function(f, clone) {\n  var origGeom = f.getGeometry();\n  var viewRotation = this.getMap().getView().getRotation();\n  if (viewRotation === 0 || !this.get('enableRotatedTransform')) {\n    return (clone) ? origGeom.clone() : origGeom;\n  }\n  var rotGeom = origGeom.clone();\n  rotGeom.rotate(viewRotation * -1, this.getMap().getView().getCenter());\n  return rotGeom;\n}\n\n/** Draw transform sketch\n* @param {boolean} draw only the center\n*/\nol_interaction_Transform.prototype.drawSketch_ = function(center) {\n  var i, f, geom;\n  this.overlayLayer_.getSource().clear();\n  if (!this.selection_.getLength()) return;\n  var viewRotation = this.getMap().getView().getRotation();\n  var ext = this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();\n  // Clone and extend\n  ext = ol_extent_buffer(ext, 0);\n  this.selection_.forEach(function (f) {\n    var extendExt = this.getGeometryRotateToZero_(f).getExtent();\n    ol_extent_extend(ext, extendExt);\n  }.bind(this));\n\n  if (center===true) {\n    if (!this.ispt_) {\n      this.overlayLayer_.getSource().addFeature(new ol_Feature( { geometry: new ol_geom_Point(this.center_), handle:'rotate0' }) );\n      geom = ol_geom_Polygon_fromExtent(ext);\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n        geom.rotate(viewRotation, this.getMap().getView().getCenter())\n      }\n      f = this.bbox_ = new ol_Feature(geom);\n      this.overlayLayer_.getSource().addFeature (f);\n    }\n  }\n  else {\n    if (this.ispt_) {\n      var p = this.getMap().getPixelFromCoordinate([ext[0], ext[1]]);\n      ext = ol_extent_boundingExtent([\n        this.getMap().getCoordinateFromPixel([p[0]-10, p[1]-10]),\n        this.getMap().getCoordinateFromPixel([p[0]+10, p[1]+10])\n      ]);\n    }\n    geom = ol_geom_Polygon_fromExtent(ext);\n    if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n      geom.rotate(viewRotation, this.getMap().getView().getCenter())\n    }\n    f = this.bbox_ = new ol_Feature(geom);\n    var features = [];\n    var g = geom.getCoordinates()[0];\n    if (!this.ispt_) {\n      features.push(f);\n      // Middle\n      if (!this.iscircle_ && this.get('stretch') && this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[i][0]+g[i+1][0])/2,(g[i][1]+g[i+1][1])/2]), handle:'scale', constraint:i%2?\"h\":\"v\", option:i });\n        features.push(f);\n      }\n      // Handles\n      if (this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol_Feature( { geometry: new ol_geom_Point(g[i]), handle:'scale', option:i });\n        features.push(f);\n      }\n      // Center\n      if (this.get('translate') && !this.get('translateFeature')) {\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[0][0]+g[2][0])/2, (g[0][1]+g[2][1])/2]), handle:'translate' });\n        features.push(f);\n      }\n    }\n    // Rotate\n    if (!this.iscircle_ && this.get('rotate')) {\n      f = new ol_Feature( { geometry: new ol_geom_Point(g[3]), handle:'rotate' });\n      features.push(f);\n    }\n    // Add sketch\n    this.overlayLayer_.getSource().addFeatures(features);\n  }\n\n};\n\n/** Select a feature to transform\n* @param {ol.Feature} feature the feature to transform\n* @param {boolean} add true to add the feature to the selection, default false\n*/\nol_interaction_Transform.prototype.select = function(feature, add) {\n  if (!feature) {\n    this.selection_.clear();\n    this.drawSketch_();\n    return;\n  }\n  if (!feature.getGeometry || !feature.getGeometry()) return;\n  // Add to selection\n  if (add) {\n    this.selection_.push(feature);\n  } else {\n\tvar index = this.selection_.getArray().indexOf(feature);\n\tthis.selection_.removeAt(index);\t\n  }\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n  this.drawSketch_();\n  this.watchFeatures_();\n  // select event\n  this.dispatchEvent({ type:'select', feature: feature, features: this.selection_ });\n};\n\n/** Update the selection collection.\n* @param {ol.Collection<ol.Feature>} features the features to transform\n*/\nol_interaction_Transform.prototype.setSelection = function(features) {\n  this.selection_.clear();\n  features.forEach(function(feature) {\n    this.selection_.push(feature);\n  }.bind(this));\n\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n  this.drawSketch_();\n  this.watchFeatures_();\n  // select event\n  this.dispatchEvent({ type:'select', features: this.selection_ });\n};\n\n/** Watch selected features\n * @private\n */\nol_interaction_Transform.prototype.watchFeatures_ = function() {\n  // Listen to feature modification\n  if (this._featureListeners) {\n    this._featureListeners.forEach(function (l) {\n      ol_Observable_unByKey(l)\n    });\n  }\n  this._featureListeners = [];\n  this.selection_.forEach(function(f) {\n    this._featureListeners.push(\n      f.on('change', function() {\n        if (!this.isUpdating_) {\n          this.drawSketch_();\n        }\n      }.bind(this))\n    );\n  }.bind(this));\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol_interaction_Transform.prototype.handleDownEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.selection_)) return;\n  var sel = this.getFeatureAtPixel_(evt.pixel);\n  var feature = sel.feature;\n  if (this.selection_.getLength()\n    && this.selection_.getArray().indexOf(feature) >= 0\n    && ((this.ispt_ && this.get('translate')) || this.get('translateFeature'))\n  ){\n    sel.handle = 'translate';\n  }\n  if (sel.handle) {\n    this.mode_ = sel.handle;\n    this.opt_ = sel.option;\n    this.constraint_ = sel.constraint;\n    // Save info\n    var viewRotation = this.getMap().getView().getRotation();\n    this.coordinate_ = evt.coordinate;\n    this.pixel_ = evt.pixel;\n    this.geoms_ = [];\n    this.rotatedGeoms_ = [];\n    var extent = ol_extent_createEmpty();\n    var rotExtent = ol_extent_createEmpty();\n    for (var i=0, f; f=this.selection_.item(i); i++) {\n      this.geoms_.push(f.getGeometry().clone());\n      extent = ol_extent_extend(extent, f.getGeometry().getExtent());\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n        var rotGeom = this.getGeometryRotateToZero_(f, true);\n        this.rotatedGeoms_.push(rotGeom);\n        rotExtent = ol_extent_extend(rotExtent, rotGeom.getExtent());\n      }\n    }\n    this.extent_ = (ol_geom_Polygon_fromExtent(extent)).getCoordinates()[0];\n    if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n      this.rotatedExtent_ = (ol_geom_Polygon_fromExtent(rotExtent)).getCoordinates()[0];\n    }\n    if (this.mode_==='rotate') {\n      this.center_ = this.getCenter() || ol_extent_getCenter(extent);\n      // we are now rotating (cursor down on rotate mode), so apply the grabbing cursor\n      var element = evt.map.getTargetElement();\n      element.style.cursor = this.Cursors.rotate0;\n      this.previousCursor_ = element.style.cursor;\n    } else {\n      this.center_ = ol_extent_getCenter(extent);\n    }\n    this.angle_ = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n\n    this.dispatchEvent({\n      type: this.mode_+'start',\n      feature: this.selection_.item(0), // backward compatibility\n      features: this.selection_,\n      pixel: evt.pixel,\n      coordinate: evt.coordinate\n    });\n    return true;\n  }\n  else if (this.get('selection')) {\n    if (feature){\n      if (!this.addFn_(evt)) this.selection_.clear();\n      var index = this.selection_.getArray().indexOf(feature);\n      if (index < 0) this.selection_.push(feature);\n      else this.selection_.removeAt(index);\n    } else {\n      this.selection_.clear();\n    }\n    this.ispt_ = this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false;\n    this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n    this.drawSketch_();\n    this.watchFeatures_();\n    this.dispatchEvent({ type:'select', feature: feature, features: this.selection_, pixel: evt.pixel, coordinate: evt.coordinate });\n    return false;\n  }\n};\n\n\n/**\n * Get features to transform\n * @return {ol.Collection<ol.Feature>}\n */\nol_interaction_Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n\n/**\n * Get the rotation center\n * @return {ol.coordinates|undefined}\n */\nol_interaction_Transform.prototype.getCenter = function() {\n  return this.get('center');\n};\n\n/**\n * Set the rotation center\n * @param {ol.coordinates|undefined} c the center point, default center on the objet\n */\nol_interaction_Transform.prototype.setCenter = function(c) {\n  return this.set('center', c);\n}\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @private\n */\nol_interaction_Transform.prototype.handleDragEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.features_)) return;\n  var viewRotation = this.getMap().getView().getRotation();\n  var i, f, geometry;\n  var pt0 = [this.coordinate_[0], this.coordinate_[1]];\n  var pt = [evt.coordinate[0], evt.coordinate[1]];\n  this.isUpdating_ = true;\n  switch (this.mode_) {\n    case 'rotate': {\n      var a = Math.atan2(this.center_[1]-pt[1], this.center_[0]-pt[0]);\n      if (!this.ispt) {\n        // var geometry = this.geom_.clone();\n        // geometry.rotate(a-this.angle_, this.center_);\n        // this.feature_.setGeometry(geometry);\n        for (i=0, f; f=this.selection_.item(i); i++) {\n          geometry = this.geoms_[i].clone();\n          geometry.rotate(a - this.angle_, this.center_);\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          f.setGeometry(geometry);\n        }\n      }\n      this.drawSketch_(true);\n      this.dispatchEvent({\n        type:'rotating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        angle: a-this.angle_,\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'translate': {\n      var deltaX = pt[0] - pt0[0];\n      var deltaY = pt[1] - pt0[1];\n\n      //this.feature_.getGeometry().translate(deltaX, deltaY);\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        f.getGeometry().translate(deltaX, deltaY);\n      }\n      this.handles_.forEach(function(f) {\n        f.getGeometry().translate(deltaX, deltaY);\n      });\n\n      this.coordinate_ = evt.coordinate;\n      this.dispatchEvent({\n        type:'translating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        delta:[deltaX,deltaY],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'scale': {\n      var center = this.center_;\n      if (this.get('modifyCenter')(evt)) {\n        var extentCoordinates = this.extent_;\n        if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n          extentCoordinates = this.rotatedExtent_;\n        }\n        center = extentCoordinates[(Number(this.opt_)+2)%4];\n      }\n\n      var downCoordinate = this.coordinate_;\n      var dragCoordinate = evt.coordinate;\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n        var downPoint = new ol_geom_Point(this.coordinate_);\n        downPoint.rotate(viewRotation * -1, center);\n        downCoordinate = downPoint.getCoordinates();\n\n        var dragPoint = new ol_geom_Point(evt.coordinate);\n        dragPoint.rotate(viewRotation * -1, center);\n        dragCoordinate = dragPoint.getCoordinates();\n      }\n\n      var scx = ((dragCoordinate)[0] - (center)[0]) / (downCoordinate[0] - (center)[0]);\n      var scy = ((dragCoordinate)[1] - (center)[1]) / (downCoordinate[1] - (center)[1]);\n\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n        var centerPoint = new ol_geom_Point(center);\n        centerPoint.rotate(viewRotation * -1, this.getMap().getView().getCenter());\n        center = centerPoint.getCoordinates();\n      }\n\n      if (this.get('noFlip')) {\n        if (scx<0) scx=-scx;\n        if (scy<0) scy=-scy;\n      }\n\n      if (this.constraint_) {\n        if (this.constraint_==\"h\") scx=1;\n        else scy=1;\n      } else {\n        if (this.get('keepAspectRatio')(evt)) {\n          scx = scy = Math.min(scx,scy);\n        }\n      }\n\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        geometry = (viewRotation === 0 || !this.get('enableRotatedTransform')) ? this.geoms_[i].clone() : this.rotatedGeoms_[i].clone();\n        geometry.applyTransform(function(g1, g2, dim) {\n          if (dim<2) return g2;\n\n          for (var j=0; j<g1.length; j+=dim) {\n            if (scx!=1) g2[j] = center[0] + (g1[j]-center[0])*scx;\n            if (scy!=1) g2[j+1] = center[1] + (g1[j+1]-center[1])*scy;\n          }\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          return g2;\n        });\n        if (this.get('enableRotatedTransform') && viewRotation !== 0) {\n          //geometry.rotate(viewRotation, rotationCenter);\n          geometry.rotate(viewRotation, this.getMap().getView().getCenter());\n        }\n        f.setGeometry(geometry);\n      }\n      this.drawSketch_();\n      this.dispatchEvent({\n        type:'scaling',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        scale:[scx,scy],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    default: break;\n  }\n  this.isUpdating_ = false;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol_interaction_Transform.prototype.handleMoveEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.features_)) return;\n  // console.log(\"handleMoveEvent\");\n  if (!this.mode_) {\n    var sel = this.getFeatureAtPixel_(evt.pixel);\n    var element = evt.map.getTargetElement();\n    if (sel.feature) {\n      var c = sel.handle ? this.Cursors[(sel.handle||'default')+(sel.constraint||'')+(sel.option||'')] : this.Cursors.select;\n\n      if (this.previousCursor_===undefined) {\n        this.previousCursor_ = element.style.cursor;\n      }\n      element.style.cursor = c;\n    } else {\n      if (this.previousCursor_!==undefined) element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_Transform.prototype.handleUpEvent_ = function(evt) {\n  // remove rotate0 cursor on Up event, otherwise it's stuck on grab/grabbing\n  if (this.mode_ === 'rotate') {\n    var element = evt.map.getTargetElement();\n    element.style.cursor = this.Cursors.default;\n    this.previousCursor_ = undefined;\n  }\n\n  //dispatchEvent\n  this.dispatchEvent({\n    type:this.mode_+'end',\n    feature: this.selection_.item(0),\n    features: this.selection_,\n    oldgeom: this.geoms_[0],\n    oldgeoms: this.geoms_\n  });\n\n  this.drawSketch_();\n  this.mode_ = null;\n  return false;\n};\n\n/** Get the features that are selected for transform\n * @return ol.Collection\n */\nol_interaction_Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n\nexport default ol_interaction_Transform\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport {ol_coordinate_dist2d, ol_coordinate_equal} from \"../geom/GeomUtils\";\nimport {boundingExtent as ol_extent_boundingExtent} from 'ol/extent'\nimport {buffer as ol_extent_buffer} from 'ol/extent'\nimport {altKeyOnly as ol_events_condition_altKeyOnly} from 'ol/events/condition'\nimport {primaryAction as ol_events_condition_primaryAction} from 'ol/events/condition'\nimport {always as ol_events_condition_always} from 'ol/events/condition'\n\nimport '../geom/LineStringSplitAt'\n\n/** Interaction for modifying feature geometries. Similar to the core ol/interaction/Modify.\n * The interaction is more suitable to use to handle feature modification: only features concerned \n * by the modification are passed to the events (instead of all feature with ol/interaction/Modify)\n * - the modifystart event is fired before the feature is modified (no points still inserted)\n * - the modifyend event is fired after the modification\n * - it fires a modifying event\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires modifystart\n * @fires modifying\n * @fires modifyend\n * @fires select\n * @param {*} options\n *\t@param {ol.source.Vector} options.source a source to modify (configured with useSpatialIndex set to true)\n *\t@param {ol.source.Vector|Array<ol.source.Vector>} options.sources a list of source to modify (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to modify\n *  @param {integer} options.pixelTolerance Pixel tolerance for considering the pointer close enough to a segment or vertex for editing. Default is 10.\n *  @param {function|undefined} options.filter a filter that takes a feature and return true if it can be modified, default always true.\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.style Style for the sketch features.\n *  @param {ol.EventsConditionType | undefined} options.condition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event will be considered to add or move a vertex to the sketch. Default is ol.events.condition.primaryAction.\n *  @param {ol.EventsConditionType | undefined} options.deleteCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. By default, ol.events.condition.singleClick with ol.events.condition.altKeyOnly results in a vertex deletion.\n *  @param {ol.EventsConditionType | undefined} options.insertVertexCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether a new vertex can be added to the sketch features. Default is ol.events.condition.always\n *  @param {boolean} options.wrapX Wrap the world horizontally on the sketch overlay, default false\n */\nvar ol_interaction_ModifyFeature = function(options){\n  if (!options) options = {};\n\n  var dragging, modifying;\n  ol_interaction_Pointer.call(this,{\n    /*\n    handleDownEvent: this.handleDownEvent,\n    handleDragEvent: this.handleDragEvent,\n    handleMoveEvent: this.handleMoveEvent,\n    handleUpEvent: this.handleUpEvent,\n    */\n    handleEvent: function(e) {\n      switch(e.type) {\n        case 'pointerdown': {\n          dragging = this.handleDownEvent(e);\n          modifying = dragging || this._deleteCondition(e);\n          return !dragging;\n        }\n        case 'pointerup': {\n          dragging = false;\n          return this.handleUpEvent(e);\n        }\n        case 'pointerdrag': {\n          if (dragging) return this.handleDragEvent(e);\n          else return true;\n        }\n        case 'pointermove': {\n          if (!dragging) return this.handleMoveEvent(e);\n          else return true;\n        }\n        case 'singleclick':\n        case 'click': {\n          // Prevent click when modifying\n          return !modifying;\n        }\n        default: return true;\n      }\n    }\n  });\n\n  // Snap distance (in px)\n  this.snapDistance_ = options.pixelTolerance || 10;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n  if (options.source) this.sources_.push (options.source);\n  if (options.features) this.sources_.push (new ol_source_Vector({ features: options.features }));\n\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n\n  this._condition = options.condition || ol_events_condition_primaryAction;\n  this._deleteCondition = options.deleteCondition || ol_events_condition_altKeyOnly;\n  this._insertVertexCondition = options.insertVertexCondition || ol_events_condition_always;\n\n  // Default style\n  var sketchStyle = function() {\n    return [ new ol_style_Style({\n        image: new ol_style_Circle({\n          radius: 6,\n          fill: new ol_style_Fill({ color: [0, 153, 255, 1] }),\n          stroke: new ol_style_Stroke({ color: '#FFF', width: 1.25 })\n        })\n      })\n    ];\n  }\n\n  // Custom style\n  if (options.style) {\n    if (typeof(options.style) === 'function') {\n      sketchStyle = options.style\n     } else {\n       sketchStyle = function() { return options.style; }\n     }\n  }\n\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      useSpatialIndex: false\n    }),\n    name:'Modify overlay',\n    displayInLayerSwitcher: false,\n    style: sketchStyle,\n    wrapX: options.wrapX\n  });\n\n};\nol_ext_inherits(ol_interaction_ModifyFeature, ol_interaction_Pointer);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_ModifyFeature.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/**\n * Activate or deactivate the interaction + remove the sketch.\n * @param {boolean} active.\n * @api stable\n */\nol_interaction_ModifyFeature.prototype.setActive = function(active) {\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\n  if (this.overlayLayer_) this.overlayLayer_.getSource().clear();\n};\n\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {*} \n * @private\n */\nol_interaction_ModifyFeature.prototype.getClosestFeature = function(e) {\n  var f, c, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && this.filterSplit_(f)) {\n      var ci = f.getGeometry().getClosestPoint(e.coordinate);\n      var di = ol_coordinate_dist2d(e.coordinate,ci) / e.frameState.viewState.resolution;\n      if (di < d){\n        d = di;\n        c = ci;\n      }\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    if (this.currentFeature) this.dispatchEvent({ type: 'select', selected: [], deselected: [this.currentFeature] })\n    this.currentFeature = null;\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry());\n    if (coord) {\n      coord = coord.coord;\n      var p = this.getMap().getPixelFromCoordinate(coord);\n      if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\n        c = coord;\n      }\n      //\n      if (this.currentFeature !== f) this.dispatchEvent({ type: 'select', selected: [f], deselected: [this.currentFeature] })\n      this.currentFeature = f;\n      return { source:source, feature:f, coord: c };\n    }\n  }\n}\n\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {ol.geom} coords list of coordinates\n* @return {*} the nearest point with a coord (projected point), dist (distance to the geom), ring (if Polygon)\n*/\nol_interaction_ModifyFeature.prototype.getNearestCoord = function(pt, geom) {\n  var i, l, p, p0, dm;\n  switch (geom.getType()) {\n    case 'Point': {\n      return { coord: geom.getCoordinates(), dist: ol_coordinate_dist2d(geom.getCoordinates(), pt) };\n    }\n    case 'MultiPoint': {\n      return this.getNearestCoord (pt, new ol_geom_LineString(geom.getCoordinates()));\n    }\n    case 'LineString':\n    case 'LinearRing': {\n      var d;\n      dm = Number.MAX_VALUE;\n      var coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        d = ol_coordinate_dist2d (pt, coords[i]);\n        if (d < dm) {\n          dm = d;\n          p0 = coords[i];\n        }\n      }\n      return { coord: p0, dist: dm };\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      p0 = false, dm = Number.MAX_VALUE;\n      for (i=0; l=lstring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=lring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=poly[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.poly = i;\n        }\n      }\n      return p0;\n    }\n    case 'GeometryCollection': {\n      var g = geom.getGeometries();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=g[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.geom = i;\n        }\n      }\n      return p0;\n    }\n    default: return false;\n  }\n};\n\n/** Get arcs concerned by a modification \n * @param {ol.geom} geom the geometry concerned\n * @param {ol.coordinate} coord pointed coordinates\n */\nol_interaction_ModifyFeature.prototype.getArcs = function(geom, coord) {\n  var arcs = false;\n  var coords, i, s, l, g;\n  switch(geom.getType()) {\n    case 'Point': {\n      if (ol_coordinate_equal(coord, geom.getCoordinates())) {\n        arcs = { \n          geom: geom, \n          type: geom.getType(),\n          coord1: [],\n          coord2: [],\n          node: true\n        }\n      }\n      break;\n    }\n    case 'MultiPoint': {\n      coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        if (ol_coordinate_equal(coord, coords[i])) {\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            index: i,\n            coord1: [],\n            coord2: [],\n            node: true\n          }\n          break;\n        }\n      }\n      break;\n    }\n    case 'LinearRing': \n    case 'LineString': {\n      var p = geom.getClosestPoint(coord);\n      if (ol_coordinate_dist2d(p,coord) < 1.5*this.tolerance_) {\n        var split;\n        // Split the line in two\n        if (geom.getType() === 'LinearRing') {\n          g = new ol_geom_LineString(geom.getCoordinates());\n          split = g.splitAt(coord, this.tolerance_);\n        } else {\n          split = geom.splitAt(coord, this.tolerance_);\n        }\n        // If more than 2\n        if (split.length>2) {\n          coords = split[1].getCoordinates();\n          for (i=2; s=split[i]; i++) {\n            var c = s.getCoordinates();\n            c.shift();\n            coords = coords.concat(c);\n          }\n          split = [ split[0], new ol_geom_LineString(coords) ];\n        }\n        // Split in two\n        if (split.length === 2) {\n          var c0 = split[0].getCoordinates();\n          var c1 = split[1].getCoordinates();\n          var nbpt = c0.length + c1.length -1;\n          c0.pop();\n          c1.shift();\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            coord1: c0, \n            coord2: c1,\n            node: (geom.getCoordinates().length === nbpt),\n            closed: false\n          }\n        } else if (split.length === 1) {\n          s = split[0].getCoordinates();\n          var start = ol_coordinate_equal(s[0], coord);\n          var end = ol_coordinate_equal(s[s.length-1], coord);\n          // Move first point\n          if (start) {\n            s.shift();\n            if (end) s.pop();\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: [], \n              coord2: s,\n              node: true,\n              closed: end\n            }\n          } else if (end) {\n            // Move last point\n            s.pop()\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: s, \n              coord2: [],\n              node: true,\n              closed: false\n            }\n          }\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      for (i=0; l=lstring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.lstring = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      for (i=0; l=lring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.index = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      for (i=0; l=poly[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.poly = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      g = geom.getGeometries();\n      for (i=0; l=g[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.g = i;\n          arcs.typeg = arcs.type;\n          arcs.type = geom.getType();\n          break;\n        }\n      }\n      break;\n    }\n    default: {\n      console.error('ol/interaction/ModifyFeature '+geom.getType()+' not supported!');\n      break;\n    }\n  }\n  return arcs;\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol_interaction_ModifyFeature.prototype.handleDownEvent = function(evt) {\n  if (!this.getActive()) return false;\n\n  // Something to move ?\n  var current = this.getClosestFeature(evt);\n\n  if (current && (this._condition(evt) || this._deleteCondition(evt))) {\n    var features = [];\n    this.arcs = [];\n\n    // Get features concerned\n    this.sources_.forEach(function(s) {\n      var extent = ol_extent_buffer (ol_extent_boundingExtent([current.coord]), this.tolerance_);\n      features = features.concat(features, s.getFeaturesInExtent(extent));\n    }.bind(this));\n\n    // Get arcs concerned\n    this._modifiedFeatures = [];\n    features.forEach(function(f) {\n      var a = this.getArcs(f.getGeometry(), current.coord);\n      if (a) {\n        if (this._insertVertexCondition(evt) || a.node) {\n          a.feature = f;\n          this._modifiedFeatures.push(f);\n          this.arcs.push(a);\n        }\n      }\n    }.bind(this));\n\n    if (this._modifiedFeatures.length) {\n      if (this._deleteCondition(evt)) {\n        return !this._removePoint(current, evt); \n      } else {\n        this.dispatchEvent({ \n          type:'modifystart', \n          coordinate: current.coord,\n          originalEvent: evt.originalEvent,\n          features: this._modifiedFeatures\n        });\n        this.handleDragEvent({ \n          coordinate: current.coord,\n          originalEvent: evt.originalEvent\n        })\n        return true;\n      }\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n};\n\n/** Get modified features\n * @return {Array<ol.Feature>} list of modified features\n */\nol_interaction_ModifyFeature.prototype.getModifiedFeatures = function() {\n  return this._modifiedFeatures || [];\n};\n\n/** Removes the vertex currently being pointed.\n */\nol_interaction_ModifyFeature.prototype.removePoint = function() {\n  this._removePoint({},{});\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype._getModification = function(a) {\n  var coords = a.coord1.concat(a.coord2);\n  switch (a.type) {\n    case 'LineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        if (a.geom.getCoordinates().length != coords.length) {\n          a.coords = coords;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        var c = a.geom.getCoordinates();\n        if (c[a.lstring].length != coords.length) {\n          c[a.lstring] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.index].length != coords.length) {\n          c[a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.poly][a.index].length != coords.length) {\n          c[a.poly][a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      var found = this._getModification(a);\n      // Restore current arc\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      return found;\n    }\n    default: {\n      //console.error('ol/interaction/ModifyFeature '+a.type+' not supported!');\n      break;\n    }\n  }\n  return false;\n};\n\n/** Removes the vertex currently being pointed.\n * @private\n */\nol_interaction_ModifyFeature.prototype._removePoint = function(current, evt) {\n  if (!this.arcs) return false;\n\n  this.overlayLayer_.getSource().clear();\n\n  var found = false;\n  // Get all modifications\n  this.arcs.forEach(function(a) {\n    found = found || this._getModification(a);\n  }.bind(this));\n\n  // Almost one point is removed\n  if (found) {\n    this.dispatchEvent({ \n      type:'modifystart', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n    this.arcs.forEach(function(a) {\n      if (a.geom.getType() === 'GeometryCollection') {\n        if (a.coords) {\n          var geoms = a.geom.getGeometries();\n          geoms[a.g].setCoordinates(a.coords);\n          a.geom.setGeometries(geoms);\n        }\n      } else {\n        if (a.coords) a.geom.setCoordinates(a.coords);\n      }\n    }.bind(this));\n    this.dispatchEvent({ \n      type:'modifyend', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n  }\n\n  this.arcs = [];\n  return found;\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleUpEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs || !this.arcs.length) return true;\n\n  this.overlayLayer_.getSource().clear();\n  this.dispatchEvent({ \n    type:'modifyend', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n  \n  this.arcs = [];\n  return true;\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.setArcCoordinates = function(a, coords) {\n  var c;\n  switch (a.type) {\n    case 'Point': {\n      a.geom.setCoordinates(coords[0]);\n      break;\n    }\n    case 'MultiPoint': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords[0];\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'LineString': {\n      a.geom.setCoordinates(coords);\n      break;\n    }\n    case 'MultiLineString': {\n      c = a.geom.getCoordinates();\n      c[a.lstring] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'Polygon': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'MultiPolygon': {\n      c = a.geom.getCoordinates();\n      c[a.poly][a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      this.setArcCoordinates(a, coords);\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      break;\n    }\n  }\n};\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleDragEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs) return true;\n\n  // Show sketch\n  this.overlayLayer_.getSource().clear();\n  var p = new ol_Feature(new ol_geom_Point(e.coordinate));\n  this.overlayLayer_.getSource().addFeature(p);\n\n  // Nothing to do\n  if (!this.arcs.length) return true;\n\n  // Move arcs\n  this.arcs.forEach(function(a) {\n    var coords = a.coord1.concat([e.coordinate], a.coord2);\n    if (a.closed) coords.push(e.coordinate);\n    this.setArcCoordinates(a, coords);\n  }.bind(this));\n\n  this.dispatchEvent({ \n    type:'modifying', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n\n  return true;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleMoveEvent = function(e) {\n  if (!this.getActive()) return false;\n\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n\n  // Draw sketch\n  if (current) {\n    var p = new ol_Feature(new ol_geom_Point(current.coord));\n    this.overlayLayer_.getSource().addFeature(p);\n  }\n\n  // Show cursor\n  var element = e.map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/** Get the current feature to modify\n * @return {ol.Feature} \n */\nol_interaction_ModifyFeature.prototype.getCurrentFeature = function() {\n  return this.currentFeature;\n};\n\nexport default ol_interaction_ModifyFeature","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_style_Style_defaultStyle from '../style/defaultStyle'\nimport ol_Collection from 'ol/Collection'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_geom_Circle from 'ol/geom/Circle'\nimport {fromCircle as ol_geom_Polygon_fromCircle} from 'ol/geom/Polygon'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_Feature from 'ol/Feature'\n\n/** Interaction rotate\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires drawstart, drawing, drawend, drawcancel\n * @param {olx.interaction.TransformOptions} options\n *  @param {Array<ol.Layer>} source Destination source for the drawn features\n *  @param {ol.Collection<ol.Feature>} features Destination collection for the drawn features \n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\n *  @param {integer} sides number of sides, default 0 = circle\n *  @param { ol.events.ConditionType | undefined } squareCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw square features.\n *  @param { ol.events.ConditionType | undefined } centerCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw centered features.\n *  @param { bool } canRotate Allow rotation when centered + square, default: true\n *  @param { number } clickTolerance click tolerance on touch devices, default: 6\n *  @param { number } maxCircleCoordinates Maximum number of point on a circle, default: 100\n */\nvar ol_interaction_DrawRegular = function(options) {\n  if (!options) options={};\n\n  this.squaredClickTolerance_ = options.clickTolerance ? options.clickTolerance * options.clickTolerance : 36;\n  this.maxCircleCoordinates_ = options.maxCircleCoordinates || 100;\n\n  // Collection of feature to transform \n  this.features_ = options.features;\n  // List of layers to transform \n  this.source_ = options.source;\n  // Square condition\n  this.squareFn_ = options.squareCondition;\n  // Centered condition\n  this.centeredFn_ = options.centerCondition;\n  // Allow rotation when centered + square\n  this.canRotate_ = (options.canRotate !== false);\n  // Specify custom geometry name\n  this.geometryName_ = options.geometryName\n\n  // Number of sides (default=0: circle)\n  this.setSides(options.sides);\n\n  // Style\n  var defaultStyle = ol_style_Style_defaultStyle(true);\n\n  // Create a new overlay layer for the sketch\n  this.sketch_ = new ol_Collection();\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      features: this.sketch_,\n      useSpatialIndex: false\n    }),\n    name:'DrawRegular overlay',\n    displayInLayerSwitcher: false,\n    style: options.style || defaultStyle\n  });\n\n  ol_interaction_Interaction.call(this, {\t\n      /*\n      handleDownEvent: this.handleDownEvent_,\n      handleMoveEvent: this.handleMoveEvent_,\n      handleUpEvent: this.handleUpEvent_,\n      */\n      handleEvent: this.handleEvent_\n    });\n};\nol_ext_inherits(ol_interaction_DrawRegular, ol_interaction_Interaction);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setActive = function(b) {\n  this.reset();\n  ol_interaction_Interaction.prototype.setActive.call (this, b);\n}\n\n/**\n * Reset the interaction\n * @api stable\n */\nol_interaction_DrawRegular.prototype.reset = function() {\n  this.overlayLayer_.getSource().clear();\n  this.started_ = false;\n}\n\n/**\n * Set the number of sides.\n * @param {int} number of sides.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setSides = function (nb) {\n  nb = parseInt(nb);\n  this.sides_ = nb>2 ? nb : 0;\n}\n\n/**\n * Allow rotation when centered + square\n * @param {bool} \n * @api stable\n */\nol_interaction_DrawRegular.prototype.canRotate = function (b) {\n  if (b===true || b===false) this.canRotate_ = b;\n  return this.canRotate_;\n}\n\n/**\n * Get the number of sides.\n * @return {int} number of sides.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.getSides = function () {\n  return this.sides_;\n}\n\n/** Default start angle array for each sides\n*/\nol_interaction_DrawRegular.prototype.startAngle = {\n  'default':Math.PI/2,\n  3: -Math.PI/2,\n  4: Math.PI/4\n};\n\n/** Get geom of the current drawing\n* @return {ol.geom.Polygon | ol.geom.Point}\n*/\nol_interaction_DrawRegular.prototype.getGeom_ = function () {\n  this.overlayLayer_.getSource().clear();\n  if (!this.center_) return false;\n\n  var g;\n  if (this.coord_) {\n    var center = this.center_;\n    var coord = this.coord_;\n\n    // Specific case: circle\n    var d, dmax, r, circle, centerPx;\n    if (!this.sides_ && this.square_ && !this.centered_) {\n      center = [(coord[0] + center[0])/2, (coord[1] + center[1])/2];\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      circle = new ol_geom_Circle(center, r, 'XY');\n      // Optimize points on the circle\n      centerPx = this.getMap().getPixelFromCoordinate(center);\n      dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n      dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / 3 ));\n      return ol_geom_Polygon_fromCircle (circle, dmax, 0);\n    } else {\n      var hasrotation = this.canRotate_ && this.centered_ && this.square_;\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      if (this.square_ && !hasrotation) {\n        //var d = [coord[0] - center[0], coord[1] - center[1]];\n        var dm = Math.max (Math.abs(d[0]), Math.abs(d[1])); \n        coord = [ \n          center[0] + (d[0]>0 ? dm:-dm),\n          center[1] + (d[1]>0 ? dm:-dm)\n        ];\n      }\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      if (r>0) {\n        circle = new ol_geom_Circle(center, r, 'XY');\n        var a;\n        if (hasrotation) a = Math.atan2(d[1], d[0]);\n        else a = this.startAngle[this.sides_] || this.startAngle['default'];\n\n        if (this.sides_) {\n          g = ol_geom_Polygon_fromCircle (circle, this.sides_, a);\n        } else {\n          // Optimize points on the circle\n          centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n          dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n          dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / (this.centered_ ? 3:5) ));\n          g = ol_geom_Polygon_fromCircle (circle, dmax, 0);\n        }\n\n        if (hasrotation) return g;\n      \n        // Scale polygon to fit extent\n        var ext = g.getExtent();\n        if (!this.centered_) center = this.center_;\n        else center = [ 2*this.center_[0]-this.coord_[0], 2*this.center_[1]-this.coord_[1] ];\n        var scx = (center[0] - coord[0]) / (ext[0] - ext[2]);\n        var scy = (center[1] - coord[1]) / (ext[1] - ext[3]);\n        if (this.square_) {\n          var sc = Math.min(Math.abs(scx),Math.abs(scy));\n          scx = Math.sign(scx)*sc;\n          scy = Math.sign(scy)*sc;\n        }\n        var t = [ center[0] - ext[0]*scx, center[1] - ext[1]*scy ];\n      \n        g.applyTransform(function(g1, g2, dim) {\n          for (var i=0; i<g1.length; i+=dim) {\n            g2[i] = g1[i]*scx + t[0];\n            g2[i+1] = g1[i+1]*scy + t[1];\n          }\n          return g2;\n        });\n        return g;\n      }\n    }\n  }\n\n  // No geom => return a point\n  return new ol_geom_Point(this.center_);\n};\n\n/** Draw sketch\n* @return {ol.Feature} The feature being drawn.\n*/\nol_interaction_DrawRegular.prototype.drawSketch_ = function(evt) {\n  this.overlayLayer_.getSource().clear();\n  if (evt) {\n    this.square_ = this.squareFn_ ? this.squareFn_(evt) : evt.originalEvent.shiftKey;\n    this.centered_ = this.centeredFn_ ? this.centeredFn_(evt) : evt.originalEvent.metaKey || evt.originalEvent.ctrlKey;\n    var g = this.getGeom_();\n    if (g) {\n      var f = this.feature_;\n      if (this.geometryName_) f.setGeometryName(this.geometryName_)\n\n      //f.setGeometry (g);\n      if (g.getType()==='Polygon') f.getGeometry().setCoordinates(g.getCoordinates());\n      this.overlayLayer_.getSource().addFeature(f);\n      if (this.coord_ \n        && this.square_ \n        && ((this.canRotate_ && this.centered_ && this.coord_) || (!this.sides_ && !this.centered_))) {\n        this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_LineString([this.center_,this.coord_])));\n      }\n      return f;\n    }\n  }\n};\n\n/** Draw sketch (Point)\n*/\nol_interaction_DrawRegular.prototype.drawPoint_ = function(pt, noclear) {\n  if (!noclear) this.overlayLayer_.getSource().clear();\n  this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_Point(pt)));\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol_interaction_DrawRegular.prototype.handleEvent_ = function(evt) {\n  var dx, dy;\n  // Event date time\n  this._eventTime = new Date();\n  switch (evt.type) {\n    case \"pointerdown\": {\n      this.downPx_ = evt.pixel;\n      this.start_(evt);\n      // Test long touch\n      var dt = 500;\n      this._longTouch = false;\n      setTimeout(function() {\n        this._longTouch = (new Date() - this._eventTime > .9*dt);\n        if (this._longTouch) this.handleMoveEvent_(evt);\n      }.bind(this), dt);\n      break;\n    }\n    case \"pointerup\": {\n      // Started and fisrt move\n      if (this.started_ && this.coord_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          // The pointer has moved\n          if ( this.lastEvent == \"pointermove\" || this.lastEvent == \"keydown\" ) {\n            this.end_(evt);\n          }\n          // On touch device there is no move event : terminate = click on the same point\n          else {\n            dx = this.upPx_[0] - evt.pixel[0];\n            dy = this.upPx_[1] - evt.pixel[1];\n            if ( dx*dx + dy*dy <= this.squaredClickTolerance_) {\n              this.end_(evt);\n            } else  {\n              this.handleMoveEvent_(evt);\n              this.drawPoint_(evt.coordinate,true);\n            }\n          }\n        }\n      }\n      this.upPx_ = evt.pixel;\t\n      break;\n    }\n    case \"pointerdrag\": {\n      if (this.started_) {\n        var centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n        dx = centerPx[0] - evt.pixel[0];\n        dy = centerPx[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          this.reset();\n        }\n      }\n      return !this._longTouch;\n      // break;\n    }\n    case \"pointermove\": {\n      if (this.started_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy > this.squaredClickTolerance_) {\n          this.handleMoveEvent_(evt);\n          this.lastEvent = evt.type;\n        }\n      }\n      break;\n    }\n    default: {\n      this.lastEvent = evt.type;\n      // Prevent zoom in on dblclick\n      if (this.started_ && evt.type==='dblclick') {\n        //evt.stopPropagation();\n        return false;\n      }\n      break;\n    }\n  }\n  return true;\n}\n\n/** Stop drawing.\n */\nol_interaction_DrawRegular.prototype.finishDrawing = function() {\n  if (this.started_ && this.coord_) {\n    this.end_({ pixel: this.upPx_, coordinate: this.coord_});\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol_interaction_DrawRegular.prototype.handleMoveEvent_ = function(evt) {\n  if (this.started_) {\n    this.coord_ = evt.coordinate;\n    this.coordPx_ = evt.pixel;\n    var f = this.drawSketch_(evt);\n    this.dispatchEvent({ \n      type:'drawing', \n      feature: f, \n      pixel: evt.pixel, \n      startCoordinate: this.center_,\n      coordinate: evt.coordinate, \n      square: this.square_, \n      centered: this.centered_ \n    });\n  } else  {\n    this.drawPoint_(evt.coordinate);\n  }\n};\n\n/** Start an new draw\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_DrawRegular.prototype.start_ = function(evt) {\n  if (!this.started_) {\n    this.started_ = true;\n    this.center_ = evt.coordinate;\n    this.coord_ = null;\n    var geom = new ol_geom_Polygon([[evt.coordinate,evt.coordinate,evt.coordinate]]);\n    var f = this.feature_ = new ol_Feature(geom);\n    this.drawSketch_(evt);\n    this.dispatchEvent({ type:'drawstart', feature: f, pixel: evt.pixel, coordinate: evt.coordinate });\n  } else {\n    this.coord_ = evt.coordinate;\n  }\n};\n\n/** End drawing\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_DrawRegular.prototype.end_ = function(evt) {\n  this.coord_ = evt.coordinate;\n  this.started_ = false;\n  // Add new feature\n  if (this.coord_ && this.center_[0]!=this.coord_[0] && this.center_[1]!=this.coord_[1]) {\n    var f = this.feature_;\n    if (this.geometryName_) f.setGeometryName(this.geometryName_)\n\n    f.setGeometry(this.getGeom_());\n    if (this.source_) this.source_.addFeature(f);\n    else if (this.features_) this.features_.push(f);\n    this.dispatchEvent({ type:'drawend', feature: f, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  } else {\n    this.dispatchEvent({ type:'drawcancel', feature: null, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  }\n\n  this.center_ = this.coord_ = null;\n  this.drawSketch_();\n};\n\nexport default ol_interaction_DrawRegular\n","/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\nimport ol_interaction_Draw from 'ol/interaction/Draw'\nimport ol_interaction_Select from 'ol/interaction/Select'\n\n/** Interaction to draw holes in a polygon.\n * It fires a drawstart, drawend event when drawing the hole\n * and a modifystart, modifyend event before and after inserting the hole in the feature geometry.\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires drawstart\n * @fires drawend\n * @fires modifystart\n * @fires modifyend\n * @param {olx.interaction.DrawHoleOptions} options extend olx.interaction.DrawOptions\n * \t@param {Array<ol.layer.Vector> | function | undefined} options.layers A list of layers from which polygons should be selected. Alternatively, a filter function can be provided. default: all visible layers\n * \t@param { ol.style.Style | Array<ol.style.Style> | StyleFunction | undefined }\tStyle for the selected features, default: default edit style\n */\nvar ol_interaction_DrawHole = function(options) {\n  if (!options) options = {};\n  var self = this;\n\n  // Select interaction for the current feature\n  this._select = new ol_interaction_Select({ style: options.style });\n  this._select.setActive(false);\n\n  // Geometry function that test points inside the current\n  var geometryFn, geomFn = options.geometryFunction;\n  if (geomFn) {\n    geometryFn = function(c,g) {\n      g = self._geometryFn (c, g);\n      return geomFn (c,g);\n    }\n  } else {\n    geometryFn = function(c,g) { return self._geometryFn (c, g); }\n  }\n\n  // Create draw interaction\n  options.type = \"Polygon\";\n  options.geometryFunction = geometryFn;\n  ol_interaction_Draw.call(this, options);\n\n  // Layer filter function\n  if (options.layers) {\n    if (typeof (options.layers) === 'function') {\n      this.layers_ = options.layers;\n    } else if (options.layers.indexOf) {\n      this.layers_ = function(l) {\n        return (options.layers.indexOf(l) >= 0); \n      };\n    }\n  }\n\n  // Start drawing if inside a feature\n  this.on('drawstart', this._startDrawing.bind(this));\n  // End drawing add the hole to the current Polygon\n  this.on('drawend', this._finishDrawing.bind(this));\n};\nol_ext_inherits(ol_interaction_DrawHole, ol_interaction_Draw);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_DrawHole.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeInteraction(this._select);\n  if (map) map.addInteraction(this._select);\n  ol_interaction_Draw.prototype.setMap.call (this, map);\n};\n\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol_interaction_DrawHole.prototype.setActive = function(b) {\n  this._select.getFeatures().clear();\n  ol_interaction_Draw.prototype.setActive.call (this, b);\n};\n\n/**\n * Remove last point of the feature currently being drawn \n * (test if points to remove before).\n */\nol_interaction_DrawHole.prototype.removeLastPoint = function() {\n  if (this._feature && this._feature.getGeometry().getCoordinates()[0].length>2) {\n    ol_interaction_Draw.prototype.removeLastPoint.call(this);\n  }\n};\n\n/** \n * Get the current polygon to hole\n * @return {ol.Feature}\n */\nol_interaction_DrawHole.prototype.getPolygon = function() {\n  return this._polygon;\n  // return this._select.getFeatures().item(0).getGeometry();\n};\n\n/**\n * Get current feature to add a hole and start drawing\n * @param {ol_interaction_Draw.Event} e\n * @private\n */\nol_interaction_DrawHole.prototype._startDrawing = function(e) {\n  var map = this.getMap();\n  var layersFilter = this.layers_;\n  this._feature = e.feature;\n  var coord = e.feature.getGeometry().getCoordinates()[0][0];\n  // Check object under the pointer\n  var features = map.getFeaturesAtPixel(\n    map.getPixelFromCoordinate(coord), {\n      layerFilter: layersFilter\n    }\n  );\n  this._current = null;\n  if (features) {\n    for (var k=0; k<features.length; k++) {\n      var poly = features[k].getGeometry();\n      if (poly.getType() === \"Polygon\"\n        && poly.intersectsCoordinate(coord)) {\n        this._polygonIndex = false;\n        this._polygon = poly;\n        this._current = features[k];\n      }\n      else if (poly.getType() === \"MultiPolygon\"\n        && poly.intersectsCoordinate(coord)) {\n        for (var i=0, p; p=poly.getPolygon(i); i++) {\n          if (p.intersectsCoordinate(coord)) {\n            this._polygonIndex = i;\n            this._polygon = p;\n            this._current = features[k];\n            break;\n          }\n        }\n      }\n      if (this._current) break;\n    }\n  }\n  this._select.getFeatures().clear();\n  if (!this._current) {\n    this.setActive(false);\n    this.setActive(true);\n  } else {\n    this._select.getFeatures().push(this._current);\n  }\n};\n\n/**\n * Stop drawing and add the sketch feature to the target feature. \n * @param {ol_interaction_Draw.Event} e\n * @private\n */\nol_interaction_DrawHole.prototype._finishDrawing = function(e) {\n  // The feature is the hole\n  e.hole = e.feature;\n  // Get the current feature\n  e.feature = this._select.getFeatures().item(0);\n  this.dispatchEvent({ type: 'modifystart', features: [ this._current ] });\n  // Create the hole\n  var c = e.hole.getGeometry().getCoordinates()[0];\n  if (c.length > 3) {\n    if (this._polygonIndex!==false) {\n      var geom = e.feature.getGeometry();\n      var newGeom = new ol_geom_MultiPolygon([]);\n      for (var i=0, pi; pi=geom.getPolygon(i); i++) {\n        if (i===this._polygonIndex) {\n          pi.appendLinearRing(new ol_geom_LinearRing(c));\n          newGeom.appendPolygon(pi);\n        } else {\n          newGeom.appendPolygon(pi);\n        }\n      }\n      e.feature.setGeometry(newGeom);\n    } else {\n      this.getPolygon().appendLinearRing(new ol_geom_LinearRing(c));\n    }\n  }\n  this.dispatchEvent({ type: 'modifyend', features: [ this._current ] });\n  // reset\n  this._feature = null;\n  this._select.getFeatures().clear();\n};\n\n/**\n * Function that is called when a geometry's coordinates are updated.\n * @param {Array<ol.coordinate>} coordinates\n * @param {ol_geom_Polygon} geometry\n * @return {ol_geom_Polygon}\n * @private\n */\nol_interaction_DrawHole.prototype._geometryFn = function(coordinates, geometry) {\n  var coord = coordinates[0].pop();\n  if (!this.getPolygon() || this.getPolygon().intersectsCoordinate(coord)) {\n    this.lastOKCoord = [coord[0],coord[1]];\n  }\n  coordinates[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]);\n\n  if (geometry) {\n    geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n  } else {\n    geometry = new ol_geom_Polygon(coordinates);\n  }\n  return geometry;\n};\n\nexport default ol_interaction_DrawHole\n","import ol_ext_inherits from '../util/ext'\nimport {shiftKeyOnly as ol_events_condition_shiftKeyOnly} from 'ol/events/condition'\nimport {click as ol_events_condition_click} from 'ol/events/condition'\nimport ol_interaction_Draw from 'ol/interaction/Draw'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_interaction_Select from 'ol/interaction/Select'\n\nimport ol_control_Bar from './Bar'\nimport ol_control_Button from './Button'\nimport ol_control_Toggle from './Toggle'\nimport ol_control_TextButton from './TextButton'\nimport ol_interaction_Delete from '../interaction/Delete'\nimport ol_ext_element from '../util/element'\nimport ol_interaction_Offset from '../interaction/Offset'\nimport ol_interaction_Split from '../interaction/Split'\nimport ol_interaction_Transform from '../interaction/Transform'\nimport ol_interaction_ModifyFeature from '../interaction/ModifyFeature'\nimport ol_interaction_DrawRegular from '../interaction/DrawRegular'\nimport ol_interaction_DrawHole from '../interaction/DrawHole'\n\n/** Control bar for editing in a layer\n * @constructor\n * @extends {ol_control_Bar}\n * @fires info\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {boolean} options.edition false to remove the edition tools, default true\n *\t@param {Object} options.interactions List of interactions to add to the bar \n *    ie. Select, Delete, Info, DrawPoint, DrawLine, DrawPolygon\n *    Each interaction can be an interaction or true (to get the default one) or false to remove it from bar\n *\t@param {ol.source.Vector} options.source Source for the drawn features. \n */\nvar ol_control_EditBar = function(options) {\n  options = options || {};\n  options.interactions = options.interactions || {};\n\n  // New bar\n\tol_control_Bar.call(this, {\n    className: (options.className ? options.className+' ': '') + 'ol-editbar',\n    toggleOne: true,\n\t\ttarget: options.target\n  });\n\n  this._source = options.source;\n  // Add buttons / interaction\n  this._interactions = {};\n  this._setSelectInteraction(options);\n  if (options.edition!==false) this._setEditInteraction(options);\n  this._setModifyInteraction(options);\n};\nol_ext_inherits(ol_control_EditBar, ol_control_Bar);\n\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_EditBar.prototype.setMap = function (map) {\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().removeInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().removeInteraction(this._interactions.ModifySelect);\n  }\n  \n  ol_control_Bar.prototype.setMap.call(this, map);\n\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().addInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().addInteraction(this._interactions.ModifySelect);\n  }\n};\n\n/** Get an interaction associated with the bar\n * @param {string} name \n */\nol_control_EditBar.prototype.getInteraction = function (name) {\n  return this._interactions[name];\n};\n\n/** Get the option title */\nol_control_EditBar.prototype._getTitle = function (option) {\n  return (option && option.title) ? option.title : option;\n};\n\n/** Add selection tool:\n * 1. a toggle control with a select interaction\n * 2. an option bar to delete / get information on the selected feature\n * @private\n */\nol_control_EditBar.prototype._setSelectInteraction = function (options) {\n  var self = this;\n  \n  // Sub bar\n  var sbar = new ol_control_Bar();\n  var selectCtrl;\n\n  // Delete button\n  if (options.interactions.Delete !== false) {\n    if (options.interactions.Delete instanceof ol_interaction_Delete) {\n      this._interactions.Delete = options.interactions.Delete; \n    } else {\n      this._interactions.Delete = new ol_interaction_Delete();\n    }\n    var del = this._interactions.Delete;\n    del.setActive(false);\n    if (this.getMap()) this.getMap().addInteraction(del);\n    sbar.addControl (new ol_control_Button({\n      className: 'ol-delete',\n      title: this._getTitle(options.interactions.Delete) || \"Delete\",\n      handleClick: function(e) {\n        // Delete selection\n        del.delete(selectCtrl.getInteraction().getFeatures());\n        console.log('del')\n        var evt = {\n          type: 'select',\n          selected: [],\n          deselected: selectCtrl.getInteraction().getFeatures().getArray().slice(),\n          mapBrowserEvent: e.mapBrowserEvent\n        };\n        selectCtrl.getInteraction().getFeatures().clear();\n        selectCtrl.getInteraction().dispatchEvent(evt);\n      }\n    }));\n  }\n\n  // Info button\n  if (options.interactions.Info !== false) {\n    sbar.addControl (new ol_control_Button({\n      className: 'ol-info',\n      title: this._getTitle(options.interactions.Info) || \"Show informations\",\n      handleClick: function() {\n        self.dispatchEvent({ \n          type: 'info', \n          features: selectCtrl.getInteraction().getFeatures() \n        });\n      }\n    }));\n  }\n\n  // Select button\n  if (options.interactions.Select !== false) {\n    if (options.interactions.Select instanceof ol_interaction_Select) {\n      this._interactions.Select = options.interactions.Select\n    } else {\n      this._interactions.Select = new ol_interaction_Select({\n        condition: ol_events_condition_click\n      });\n    }\n    var sel = this._interactions.Select;\n    selectCtrl = new ol_control_Toggle({\n      className: 'ol-selection',\n      title: this._getTitle(options.interactions.Select) || \"Select\",\n      interaction: sel,\n      bar: sbar.getControls().length ? sbar : undefined,\n      autoActivate:true,\n      active:true\n    });\n\n    this.addControl(selectCtrl);\n    sel.on('change:active', function() {\n      sel.getFeatures().clear();\n    });\n  }\n};\n\n\n/** Add editing tools\n * @private\n */ \nol_control_EditBar.prototype._setEditInteraction = function (options) {\n  if (options.interactions.DrawPoint !== false) {\n    if (options.interactions.DrawPoint instanceof ol_interaction_Draw) {\n      this._interactions.DrawPoint = options.interactions.DrawPoint;\n    } else {\n      this._interactions.DrawPoint = new ol_interaction_Draw({\n        type: 'Point',\n        source: this._source\n      });\n    }\n    var pedit = new ol_control_Toggle({\n      className: 'ol-drawpoint',\n      title: this._getTitle(options.interactions.DrawPoint) || 'Point',\n      interaction: this._interactions.DrawPoint\n    });\n    this.addControl ( pedit );\n  }\n\n  if (options.interactions.DrawLine !== false) {\n    if (options.interactions.DrawLine instanceof ol_interaction_Draw) {\n      this._interactions.DrawLine = options.interactions.DrawLine\n    } else {\n      this._interactions.DrawLine = new ol_interaction_Draw ({\n        type: 'LineString',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          if (geometry) geometry.setCoordinates(coordinates);\n          else geometry = new ol_geom_LineString(coordinates);\n          this.nbpts = geometry.getCoordinates().length;\n          return geometry;\n        }\n      });\n    }\n    var ledit = new ol_control_Toggle({\n      className: 'ol-drawline',\n      title: this._getTitle(options.interactions.DrawLine) || 'LineString',\n      interaction: this._interactions.DrawLine,\n      // Options bar associated with the control\n      bar: new ol_control_Bar ({\n        controls:[ \n          new ol_control_TextButton({\n            html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n            title: this._getTitle(options.interactions.UndoDraw) || \"delete last point\",\n            handleClick: function() {\n              if (ledit.getInteraction().nbpts>1) ledit.getInteraction().removeLastPoint();\n            }\n          }),\n          new ol_control_TextButton ({\n            html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n            title: this._getTitle(options.interactions.FinishDraw) || \"finish\",\n            handleClick: function() {\n              // Prevent null objects on finishDrawing\n              if (ledit.getInteraction().nbpts>2) ledit.getInteraction().finishDrawing();\n            }\n          })\n        ]\n      }) \n    });\n\n    this.addControl ( ledit );\n  }\n\n  if (options.interactions.DrawPolygon !== false) {\n    if (options.interactions.DrawPolygon instanceof ol_interaction_Draw){\n      this._interactions.DrawPolygon = options.interactions.DrawPolygon\n    } else {\n      this._interactions.DrawPolygon = new ol_interaction_Draw ({\n        type: 'Polygon',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          this.nbpts = coordinates[0].length;\n          if (geometry) geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n          else geometry = new ol_geom_Polygon(coordinates);\n          return geometry;\n        }\n      });\n    }\n    this._setDrawPolygon(\n      'ol-drawpolygon', \n      this._interactions.DrawPolygon, \n      this._getTitle(options.interactions.DrawPolygon) || 'Polygon', \n      options\n    );\n  }\n\n  // Draw hole\n  if (options.interactions.DrawHole !== false) {\n    if (options.interactions.DrawHole instanceof ol_interaction_DrawHole){\n      this._interactions.DrawHole = options.interactions.DrawHole;\n    } else {\n      this._interactions.DrawHole = new ol_interaction_DrawHole ();\n    }\n    this._setDrawPolygon(\n      'ol-drawhole', \n      this._interactions.DrawHole, \n      this._getTitle(options.interactions.DrawHole) || 'Hole', \n      options\n    );\n  }\n\n  // Draw regular\n  if (options.interactions.DrawRegular !== false) {\n    if (options.interactions.DrawRegular instanceof ol_interaction_DrawRegular) {\n      this._interactions.DrawRegular = options.interactions.DrawRegular\n    } else {\n      this._interactions.DrawRegular = new ol_interaction_DrawRegular ({\n        source: this._source,\n        sides: 4\n      });\n    }\n    var regular = this._interactions.DrawRegular;\n\n    var div = document.createElement('DIV');\n\n    var down = ol_ext_element.create('DIV', { parent: div });\n    ol_ext_element.addListener(down, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() -1;\n      if (sides < 2) sides = 2;\n      regular.setSides (sides);\n      text.textContent = sides>2 ? sides+' pts' : 'circle';\n    }.bind(this));\n\n    var text = ol_ext_element.create('TEXT', { html:'4 pts', parent: div });\n    \n    var up = ol_ext_element.create('DIV', { parent: div });\n    ol_ext_element.addListener(up, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() +1;\n      if (sides<3) sides=3;\n      regular.setSides(sides);\n      text.textContent = sides+' pts';\n    }.bind(this));\n\n    var ctrl = new ol_control_Toggle({\n      className: 'ol-drawregular',\n      title: this._getTitle(options.interactions.DrawRegular) || 'Regular',\n      interaction: this._interactions.DrawRegular,\n      // Options bar associated with the control\n      bar: new ol_control_Bar ({\n        controls:[ \n          new ol_control_TextButton({\n            html: div\n          })\n        ]\n      }) \n    });\n    this.addControl (ctrl);\n  }\n\n};\n\n/**\n * @private\n */\nol_control_EditBar.prototype._setDrawPolygon = function (className, interaction, title, options) {\n  var fedit = new ol_control_Toggle ({\n    className: className,\n    title: title,\n    interaction: interaction,\n    // Options bar associated with the control\n    bar: new ol_control_Bar({\n      controls:[ \n        new ol_control_TextButton ({\n          html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n          title: this._getTitle(options.interactions.UndoDraw) || 'undo last point',\n          handleClick: function(){\n            if (fedit.getInteraction().nbpts>1) fedit.getInteraction().removeLastPoint();\n          }\n        }),\n        new ol_control_TextButton({\n          html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          title: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          handleClick: function() {\n            // Prevent null objects on finishDrawing\n            if (fedit.getInteraction().nbpts>3) fedit.getInteraction().finishDrawing();\n          }\n        })\n      ]\n    }) \n  });\n  this.addControl (fedit);\n};\n\n/** Add modify tools\n * @private\n */ \nol_control_EditBar.prototype._setModifyInteraction = function (options) {\n  // Modify on selected features\n  if (options.interactions.ModifySelect !== false && options.interactions.Select !== false) {\n    if (options.interactions.ModifySelect instanceof ol_interaction_ModifyFeature) {\n      this._interactions.ModifySelect = options.interactions.ModifySelect;\n    } else {\n      this._interactions.ModifySelect = new ol_interaction_ModifyFeature({\n        features: this.getInteraction('Select').getFeatures()\n      });\n    }\n    if (this.getMap()) this.getMap().addInteraction(this._interactions.ModifySelect);\n    // Activate with select\n    this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    this._interactions.Select.on('change:active', function() {\n      this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    }.bind(this));\n  }\n\n  if (options.interactions.Transform !== false) {\n    if (options.interactions.Transform instanceof ol_interaction_Transform) {\n      this._interactions.Transform = options.interactions.Transform;\n    } else {\n      this._interactions.Transform = new ol_interaction_Transform ({\n        addCondition: ol_events_condition_shiftKeyOnly\n      });\n    }\n    var transform = new ol_control_Toggle ({\n      html: '<i></i>',\n      className: 'ol-transform',\n      title: this._getTitle(options.interactions.Transform) || 'Transform',\n      interaction: this._interactions.Transform\n    });\n    this.addControl (transform);\n  }\n\n  if (options.interactions.Split !== false) {\n    if (options.interactions.Split instanceof ol_interaction_Split) {\n      this._interactions.Split = options.interactions.Split;\n    } else {\n      this._interactions.Split = new ol_interaction_Split ({\n          sources: this._source\n      });\n    }\n    var split = new ol_control_Toggle ({\n      className: 'ol-split',\n      title: this._getTitle(options.interactions.Split) || 'Split',\n      interaction: this._interactions.Split\n    });\n    this.addControl (split);\n  }\n\n  if (options.interactions.Offset !== false) {\n    if (options.interactions.Offset instanceof ol_interaction_Offset) {\n      this._interactions.Offset = options.interactions.Offset;\n    } else {\n      this._interactions.Offset = new ol_interaction_Offset ({\n          source: this._source\n      });\n    }\n    var offset = new ol_control_Toggle ({\n      html: '<i></i>',\n      className: 'ol-offset',\n      title: this._getTitle(options.interactions.Offset) || 'Offset',\n      interaction: this._interactions.Offset\n    });\n    this.addControl (offset);\n  }\n\n};\n\nexport default ol_control_EditBar\n","/*\n  Copyright (c) 2015 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\n/**\n * @classdesc Swipe Control.\n *\n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} Control options.\n *  @param {ol.layer} options.layers layer to swipe\n *  @param {ol.layer} options.rightLayer layer to swipe on right side\n *  @param {string} options.className control class name\n *  @param {number} options.position position propertie of the swipe [0,1], default 0.5\n *  @param {string} options.orientation orientation propertie (vertical|horizontal), default vertical\n */\nvar ol_control_Swipe = function(options) {\n  options = options || {};\n\n  var button = document.createElement('button');\n\n  var element = document.createElement('div');\n  element.className = (options.className || \"ol-swipe\") + \" ol-unselectable ol-control\";\n  element.appendChild(button);\n\n  element.addEventListener(\"mousedown\", this.move.bind(this));\n  element.addEventListener(\"touchstart\", this.move.bind(this));\n\n  ol_control_Control.call(this, {\n    element: element\n  });\n\n  // An array of listener on layer postcompose\n  this.precomposeRight_ = this.precomposeRight.bind(this);\n  this.precomposeLeft_ = this.precomposeLeft.bind(this);\n  this.postcompose_ = this.postcompose.bind(this);\n\n  this.layers = [];\n  if (options.layers) this.addLayer(options.layers, false);\n  if (options.rightLayers) this.addLayer(options.rightLayers, true);\n\n  this.on('propertychange', function() {\n    if (this.getMap()) this.getMap().renderSync();\n    if (this.get('orientation') === \"horizontal\") {\n      this.element.style.top = this.get('position')*100+\"%\";\n      this.element.style.left = \"\";\n    } else {\n      if (this.get('orientation') !== \"vertical\") this.set('orientation', \"vertical\");\n      this.element.style.left = this.get('position')*100+\"%\";\n      this.element.style.top = \"\";\n    }\n    this.element.classList.remove(\"horizontal\", \"vertical\");\n    this.element.classList.add(this.get('orientation'));\n  }.bind(this));\n\n  this.set('position', options.position || 0.5);\n  this.set('orientation', options.orientation || 'vertical');\n};\nol_ext_inherits(ol_control_Swipe, ol_control_Control);\n\n/**\n * Set the map instance the control associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Swipe.prototype.setMap = function(map) {\n  var i;\n  var l;\n\n  if (this.getMap()) {\n    for (i=0; i<this.layers.length; i++) {\n      l = this.layers[i];\n      if (l.right) l.layer.un(['precompose','prerender'], this.precomposeRight_);\n      else l.layer.un(['precompose','prerender'], this.precomposeLeft_);\n      l.layer.un(['postcompose','postrender'], this.postcompose_);\n    }\n    this.getMap().renderSync();\n  }\n\n  ol_control_Control.prototype.setMap.call(this, map);\n\n  if (map) {\n    this._listener = [];\n    for (i=0; i<this.layers.length; i++) {\n      l = this.layers[i];\n      if (l.right) l.layer.on(['precompose','prerender'], this.precomposeRight_);\n      else l.layer.on(['precompose','prerender'], this.precomposeLeft_);\n      l.layer.on(['postcompose','postrender'], this.postcompose_);\n    }\n    map.renderSync();\n  }\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.isLayer_ = function(layer){\n  for (var k=0; k<this.layers.length; k++) {\n    if (this.layers[k].layer === layer) return k;\n  }\n  return -1;\n};\n\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*\t@param {bool} add layer in the right part of the map, default left.\n*/\nol_control_Swipe.prototype.addLayer = function(layers, right) {\n  if (!(layers instanceof Array)) layers = [layers];\n  for (var i=0; i<layers.length; i++) {\n    var l = layers[i];\n    if (this.isLayer_(l) < 0) {\n      this.layers.push({ layer:l, right:right });\n      if (this.getMap()) {\n        if (right) l.on(['precompose','prerender'], this.precomposeRight_);\n        else l.on(['precompose','prerender'], this.precomposeLeft_);\n        l.on(['postcompose','postrender'], this.postcompose_);\n        this.getMap().renderSync();\n      }\n    }\n  }\n};\n\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*/\nol_control_Swipe.prototype.removeLayer = function(layers) {\n  if (!(layers instanceof Array)) layers = [layers];\n  for (var i=0; i<layers.length; i++) {\n    var k = this.isLayer_(layers[i]);\n    if (k >=0 && this.getMap()) {\n      if (this.layers[k].right) layers[i].un(['precompose','prerender'], this.precomposeRight_);\n      else layers[i].un(['precompose','prerender'], this.precomposeLeft_);\n      layers[i].un(['postcompose','postrender'], this.postcompose_);\n      this.layers.splice(k,1);\n      this.getMap().renderSync();\n    }\n  }\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.move = function(e) {\n  var self = this;\n  var l;\n  switch (e.type) {\n    case 'touchcancel':\n    case 'touchend':\n    case 'mouseup': {\n      self.isMoving = false;\n      [\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n        .forEach(function(eventName) {\n          document.removeEventListener(eventName, self.move);\n        });\n      break;\n    }\n    case 'mousedown':\n    case 'touchstart': {\n      self.isMoving = true;\n      [\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n        .forEach(function(eventName) {\n          document.addEventListener(eventName, self.move.bind(self));\n        });\n    }\n    // fallthrough\n    case 'mousemove':\n    case 'touchmove': {\n      if (self.isMoving) {\n        if (self.get('orientation') === \"vertical\") {\n          var pageX = e.pageX\n            || (e.touches && e.touches.length && e.touches[0].pageX)\n            || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n          if (!pageX) break;\n          pageX -= self.getMap().getTargetElement().getBoundingClientRect().left +\n            window.pageXOffset - document.documentElement.clientLeft;\n\n          l = self.getMap().getSize()[0];\n          l = Math.min(Math.max(0, 1-(l-pageX)/l), 1);\n          self.set('position', l);\n        } else {\n          var pageY = e.pageY\n            || (e.touches && e.touches.length && e.touches[0].pageY)\n            || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n          if (!pageY) break;\n          pageY -= self.getMap().getTargetElement().getBoundingClientRect().top +\n            window.pageYOffset - document.documentElement.clientTop;\n\n          l = self.getMap().getSize()[1];\n          l = Math.min(Math.max(0, 1-(l-pageY)/l), 1);\n          self.set('position', l);\n        }\n      }\n      break;\n    }\n    default: break;\n  }\n};\n\nol_control_Swipe.prototype._drawRect = function(e, pts) {\n  var tr = e.inversePixelTransform;\n  if (tr) {\n    var r = [\n      [pts[0][0], pts[0][1]],\n      [pts[0][0], pts[1][1]],\n      [pts[1][0], pts[1][1]],\n      [pts[1][0], pts[0][1]],\n      [pts[0][0], pts[0][1]]\n    ];\n    r.forEach(function (pt, i) {\n      pt = [\n        (pt[0]*tr[0] - pt[1]*tr[1] + tr[4]),\n        (-pt[0]*tr[2] + pt[1]*tr[3] + tr[5])\n      ];\n      if (!i) {\n        e.context.moveTo(pt[0], pt[1]);\n      } else {\n        e.context.lineTo(pt[0], pt[1]);\n      }\n    });\n  } else {\n    var ratio = e.frameState.pixelRatio;\n    e.context.rect(pts[0][0]*ratio,pts[0][1]*ratio,pts[1][0]*ratio,pts[1][1]*ratio);\n  }\n};\n\n\n/** @private\n*/\nol_control_Swipe.prototype.precomposeLeft = function(e) {\n  var ctx = e.context;\n  var size = e.frameState.size;\n  ctx.save();\n  ctx.beginPath();\n  var pts = [[0,0],[size[0],size[1]]];\n  if (this.get('orientation') === \"vertical\") {\n    pts[1] = [\n      size[0]*this.get('position'), \n      size[1]\n    ];\n  } else {\n    pts[1] = [\n      size[0],\n      size[1]*this.get('position')\n    ];\n  }\n  this._drawRect(e, pts);\n  ctx.clip();\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.precomposeRight = function(e) {\n  var ctx = e.context;\n  var size = e.frameState.size;\n  ctx.save();\n  ctx.beginPath();\n  var pts = [[0,0],[size[0],size[1]]];\n  if (this.get('orientation') === \"vertical\") {\n    pts[0] = [\n      size[0]*this.get('position'), \n      0\n    ];\n  } else {\n    pts[0] = [\n      0,\n      size[1]*this.get('position')\n    ]\n  }\n  this._drawRect(e, pts);\n  ctx.clip();\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.postcompose = function(e) {\n  // restore context when decluttering is done\n  // https://github.com/openlayers/openlayers/issues/10096\n  if (e.target.getClassName()!=='ol-layer' && e.target.get('declutter')) {\n    setTimeout(function () {\n      e.context.restore();\n    }, 0);\n  } else {\n    e.context.restore();\n  }\n};\n\nexport default ol_control_Swipe\n","import ol_source_Vector from 'ol/source/Vector'\n\n(function () {\n  var clear = ol_source_Vector.prototype.clear;\n\n  /** Overwrite ol/source/Vector clear to fire clearstart / clearend event\n   */\n  ol_source_Vector.prototype.clear = function(opt_fast) {\n    this.dispatchEvent({ type: 'clearstart' });\n    clear.call(this, opt_fast)\n    this.dispatchEvent({ type: 'clearend' });\n  };\n})();\n","import ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\nimport '../source/Vector' \n\n/** Undo/redo interaction\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires undo\n * @fires redo\n * @param {*} options\n */\nvar ol_interaction_UndoRedo = function(options) {\n  if (!options) options = {};\n\n\tol_interaction_Interaction.call(this, {\t\n    handleEvent: function() { \n      return true; \n    }\n  });\n\n  this._undoStack = [];\n  this._redoStack = [];\n  // Block counter\n  this._block = 0;\n  // Start recording\n  this._record = true;\n  // Custom definitions\n  this._defs = {};\n};\nol_ext_inherits(ol_interaction_UndoRedo, ol_interaction_Interaction);\n\n/** Add a custom undo/redo\n * @param {string} action the action key name\n * @param {function} undoFn function called when undoing\n * @param {function} redoFn function called when redoing\n * @api\n */\nol_interaction_UndoRedo.prototype.define = function(action, undoFn, redoFn) {\n  this._defs['_'+action] = { undo: undoFn, redo: redoFn };\n};\n\n/** Set a custom undo/redo\n * @param {string} action the action key name\n * @param {any} prop an object that will be passed in the undo/redo fucntions of the action\n * @return {boolean} true if the action is defined\n */\nol_interaction_UndoRedo.prototype.push = function(action, prop) {\n  if (this._defs['_'+action]) {\n    this._undoStack.push({type: '_'+action, prop: prop });\n    return true;\n  } else {\n    return false;\n  }\n};\n\n/** Activate or deactivate the interaction, ie. records or not events on the map.\n * @param {boolean} active\n * @api stable\n */\nol_interaction_UndoRedo.prototype.setActive = function(active) {\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\n  this._record = active;\n};\n\n/**\n * Remove the interaction from its current map, if any, and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_UndoRedo.prototype.setMap = function(map) {\n  if (this._mapListener) {\n    this._mapListener.forEach(function(l) { ol_Observable_unByKey(l); })\n  }\n  this._mapListener = [];\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  // Watch blocks\n  if (map) {\n    this._mapListener.push(map.on('undoblockstart', this.blockStart.bind(this)));\n    this._mapListener.push(map.on('undoblockend', this.blockEnd.bind(this)));\n  }\n  // Watch sources\n  this._watchSources();\n  this._watchInteractions();\n};\n\n/** Watch for changes in the map sources\n * @private\n */\nol_interaction_UndoRedo.prototype._watchSources = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._sourceListener) {\n    this._sourceListener.forEach(function(l) { ol_Observable_unByKey(l); })\n  }\n  this._sourceListener = [];\n\n  // Ges vector layers \n  function getVectorLayers(layers, init) {\n    if (!init) init = [];\n    layers.forEach(function(l) {\n      if (l instanceof ol_layer_Vector) {\n        init.push(l);\n      } else if (l.getLayers) {\n        getVectorLayers(l.getLayers(), init);\n      }\n    });\n    return init;\n  }\n\n  if (map) {\n    // Watch the vector sources in the map \n    var vectors = getVectorLayers(map.getLayers());\n    vectors.forEach((function(l) {\n      var s = l.getSource();\n      this._sourceListener.push( s.on(['addfeature', 'removefeature'], this._onAddRemove.bind(this)) );\n      this._sourceListener.push( s.on('clearstart', this.blockStart.bind(this)) );\n      this._sourceListener.push( s.on('clearend', this.blockEnd.bind(this)) );\n    }).bind(this));\n\n    // Watch new inserted/removed\n    this._sourceListener.push( map.getLayers().on(['add', 'remove'], this._watchSources.bind(this) ) );\n  }\n};\n\n/** Watch for interactions\n * @private\n */\nol_interaction_UndoRedo.prototype._watchInteractions = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._interactionListener) {\n    this._interactionListener.forEach(function(l) { ol_Observable_unByKey(l); })\n  }\n  this._interactionListener = [];\n\n  if (map) {\n    // Watch the interactions in the map \n    map.getInteractions().forEach((function(i) {\n      this._interactionListener.push(i.on(\n        ['setattributestart', 'modifystart', 'rotatestart', 'translatestart', 'scalestart', 'deletestart', 'deleteend', 'beforesplit', 'aftersplit'], \n        this._onInteraction.bind(this)\n      ));\n    }).bind(this));\n\n    // Watch new inserted / unwatch removed\n    this._interactionListener.push( map.getInteractions().on(\n      ['add', 'remove'], \n      this._watchInteractions.bind(this)\n    ));\n  }\n};\n\n/** A feature is added / removed\n */\nol_interaction_UndoRedo.prototype._onAddRemove = function(e) {\n  if (this._record) {\n    this._undoStack.push({type: e.type, source: e.target, feature: e.feature });\n    this._redoStack = [];\n  }\n};\n\nol_interaction_UndoRedo.prototype._onInteraction = function(e) {\n  var fn = this._onInteraction[e.type];\n  if (fn) fn.call(this,e);\n};\n\n/** Set attribute\n * @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.setattributestart = function(e) {\n  this.blockStart();\n  var newp = Object.assign({}, e.properties);\n  e.features.forEach(function(f) {\n    var oldp = {};\n    for (var p in newp) {\n      oldp[p] = f.get(p);\n    }\n    this._undoStack.push({\n      type: 'changeattribute', \n      feature: f, \n      newProperties: newp,\n      oldProperties: oldp\n    });\n  }.bind(this));\n  this.blockEnd();\n};\n\nol_interaction_UndoRedo.prototype._onInteraction.rotatestart = \nol_interaction_UndoRedo.prototype._onInteraction.translatestart = \nol_interaction_UndoRedo.prototype._onInteraction.scalestart = \nol_interaction_UndoRedo.prototype._onInteraction.modifystart = function (e) {\n  this.blockStart();\n  e.features.forEach(function(m) {\n    this._undoStack.push({type: 'changefeature', feature: m, oldFeature: m.clone()  });\n  }.bind(this));\n  this.blockEnd();\n};\n\n/** Start an undo block\n * @api\n */\nol_interaction_UndoRedo.prototype.blockStart = function () {\n  this._undoStack.push({ type: 'blockstart' });\n  this._redoStack = [];\n};\n\n/** @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.beforesplit =\nol_interaction_UndoRedo.prototype._onInteraction.deletestart =\nol_interaction_UndoRedo.prototype.blockStart;\n\n/** End an undo block\n * @api\n */\nol_interaction_UndoRedo.prototype.blockEnd = function () {\n  this._undoStack.push({ type: 'blockend' });\n};\n\n/** @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.aftersplit =\nol_interaction_UndoRedo.prototype._onInteraction.deleteend =\nol_interaction_UndoRedo.prototype.blockEnd;\n\n/** handle undo/redo\n * @private\n */\nol_interaction_UndoRedo.prototype._handleDo = function(e, undo) {\n  // Not active\n  if (!this.getActive()) return;\n\n  // Stop recording while undoing\n  this._record = false;\n  switch (e.type) {\n    case 'addfeature': {\n      if (undo) e.source.removeFeature(e.feature);\n      else e.source.addFeature(e.feature);\n      break;\n    }\n    case 'removefeature': {\n      if (undo) e.source.addFeature(e.feature);\n      else e.source.removeFeature(e.feature);\n      break;\n    }\n    case 'changefeature': {\n      var geom = e.feature.getGeometry();\n      e.feature.setGeometry(e.oldFeature.getGeometry());\n      e.oldFeature.setGeometry(geom);\n      break;\n    }\n    case 'changeattribute': {\n      var newp = e.newProperties;\n      var oldp = e.oldProperties;\n      for (var p in oldp) {\n        if (oldp === undefined) e.feature.unset(p);\n        else e.feature.set(p, oldp[p]);\n      }\n      e.oldProperties = newp;\n      e.newProperties = oldp;\n      break;\n    }\n    case 'blockstart': {\n      this._block += undo ? -1 : 1;\n      break;\n    }\n    case 'blockend': {\n      this._block += undo ? 1 : -1;\n      break;\n    }\n    default: {\n      if (this._defs[e.type]) {\n        if (undo) this._defs[e.type].undo(e.prop);\n        else this._defs[e.type].redo(e.prop);\n      } else {\n        console.warn('[UndoRedoInteraction]: \"'+e.type.substr(1)+'\" is not defined.');\n      }\n    }\n  }\n\n  // Handle block\n  if (this._block<0) this._block = 0;\n  if (this._block) {\n    if (undo) this.undo();\n    else this.redo();\n  }\n  this._record = true;\n\n  // Dispatch event\n  this.dispatchEvent( { \n    type: undo ? 'undo' : 'redo',\n    action: e\n  });\n};\n\n/** Undo last operation\n * @api\n */\nol_interaction_UndoRedo.prototype.undo = function() {\n  var e = this._undoStack.pop();\n  if (!e) return;\n  this._redoStack.push(e);\n  this._handleDo(e, true);\n};\n\n/** Redo last operation\n * @api\n */\nol_interaction_UndoRedo.prototype.redo = function() {\n  var e = this._redoStack.pop();\n  if (!e) return;\n  this._undoStack.push(e);\n  this._handleDo(e, false);\n};\n\n/** Clear undo stack\n * @api\n */\nol_interaction_UndoRedo.prototype.clear = function() {\n  this._undoStack = [];\n  this._redoStack = [];\n};\n\n/** Check if undo is avaliable\n * @return {number} the number of undo \n * @api\n */\nol_interaction_UndoRedo.prototype.hasUndo = function() {\n  return this._undoStack.length;\n};\n\n/** Check if redo is avaliable\n * @return {number} the number of redo\n * @api\n */\nol_interaction_UndoRedo.prototype.hasRedo = function() {\n  return this._redoStack.length;\n};\n\nexport default ol_interaction_UndoRedo\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nvar Disposable = function Disposable() {\n  /**\n   * The object has already been disposed.\n   * @type {boolean}\n   * @private\n   */\n  this.disposed_ = false;\n};\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function dispose () {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = function disposeInternal () {};\n\nexport default Disposable;\n\n//# sourceMappingURL=Disposable.js.map","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nvar TileRange = function TileRange(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n/**\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function contains (tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function containsTileRange (tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n     this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function containsXY (x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function equals (tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n     this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function extend (tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function getHeight () {\n  return this.maxY - this.minY + 1;\n};\n\n/**\n * @return {import(\"./size.js\").Size} Size.\n */\nTileRange.prototype.getSize = function getSize () {\n  return [this.getWidth(), this.getHeight()];\n};\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function getWidth () {\n  return this.maxX - this.minX + 1;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function intersects (tileRange) {\n  return this.minX <= tileRange.maxX &&\n     this.maxX >= tileRange.minX &&\n     this.minY <= tileRange.maxY &&\n     this.maxY >= tileRange.minY;\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange=} tileRange TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\nexport default TileRange;\n\n//# sourceMappingURL=TileRange.js.map","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\nvar MapBrowserPointerEvent = /*@__PURE__*/(function (MapBrowserEvent) {\n  function MapBrowserPointerEvent(type, map, pointerEvent, opt_dragging, opt_frameState) {\n\n    MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging, opt_frameState);\n\n    /**\n     * @const\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     */\n    this.pointerEvent = pointerEvent;\n\n  }\n\n  if ( MapBrowserEvent ) MapBrowserPointerEvent.__proto__ = MapBrowserEvent;\n  MapBrowserPointerEvent.prototype = Object.create( MapBrowserEvent && MapBrowserEvent.prototype );\n  MapBrowserPointerEvent.prototype.constructor = MapBrowserPointerEvent;\n\n  return MapBrowserPointerEvent;\n}(MapBrowserEvent));\n\nexport default MapBrowserPointerEvent;\n\n//# sourceMappingURL=MapBrowserPointerEvent.js.map","/**\n * @module ol/Object\n */\nimport {getUid} from './util.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport var ObjectEvent = /*@__PURE__*/(function (Event) {\n  function ObjectEvent(type, key, oldValue) {\n    Event.call(this, type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n\n  }\n\n  if ( Event ) ObjectEvent.__proto__ = Event;\n  ObjectEvent.prototype = Object.create( Event && Event.prototype );\n  ObjectEvent.prototype.constructor = ObjectEvent;\n\n  return ObjectEvent;\n}(Event));\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nvar BaseObject = /*@__PURE__*/(function (Observable) {\n  function BaseObject(opt_values) {\n    Observable.call(this);\n\n    // Call {@link module:ol/util~getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {!Object<string, *>}\n     */\n    this.values_ = {};\n\n    if (opt_values !== undefined) {\n      this.setProperties(opt_values);\n    }\n  }\n\n  if ( Observable ) BaseObject.__proto__ = Observable;\n  BaseObject.prototype = Object.create( Observable && Observable.prototype );\n  BaseObject.prototype.constructor = BaseObject;\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  BaseObject.prototype.get = function get (key) {\n    var value;\n    if (this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  };\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  BaseObject.prototype.getKeys = function getKeys () {\n    return Object.keys(this.values_);\n  };\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  BaseObject.prototype.getProperties = function getProperties () {\n    return assign({}, this.values_);\n  };\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  BaseObject.prototype.notify = function notify (key, oldValue) {\n    var eventType;\n    eventType = getChangeEventType(key);\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  };\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.set = function set (key, value, opt_silent) {\n    if (opt_silent) {\n      this.values_[key] = value;\n    } else {\n      var oldValue = this.values_[key];\n      this.values_[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.setProperties = function setProperties (values, opt_silent) {\n    for (var key in values) {\n      this.set(key, values[key], opt_silent);\n    }\n  };\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean=} opt_silent Unset without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.unset = function unset (key, opt_silent) {\n    if (key in this.values_) {\n      var oldValue = this.values_[key];\n      delete this.values_[key];\n      if (!opt_silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  return BaseObject;\n}(Observable));\n\n\n/**\n * @type {Object<string, string>}\n */\nvar changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\nexport default BaseObject;\n\n//# sourceMappingURL=Object.js.map","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nvar Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n */\nexport var CollectionEvent = /*@__PURE__*/(function (Event) {\n  function CollectionEvent(type, opt_element) {\n    Event.call(this, type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {*}\n     * @api\n     */\n    this.element = opt_element;\n\n  }\n\n  if ( Event ) CollectionEvent.__proto__ = Event;\n  CollectionEvent.prototype = Object.create( Event && Event.prototype );\n  CollectionEvent.prototype.constructor = CollectionEvent;\n\n  return CollectionEvent;\n}(Event));\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nvar Collection = /*@__PURE__*/(function (BaseObject) {\n  function Collection(opt_array, opt_options) {\n\n    BaseObject.call(this);\n\n    var options = opt_options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = opt_array ? opt_array : [];\n\n    if (this.unique_) {\n      for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n\n  }\n\n  if ( BaseObject ) Collection.__proto__ = BaseObject;\n  Collection.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Collection.prototype.constructor = Collection;\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  Collection.prototype.clear = function clear () {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  };\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  Collection.prototype.extend = function extend (arr) {\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  };\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  Collection.prototype.forEach = function forEach (f) {\n    var array = this.array_;\n    for (var i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  };\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  Collection.prototype.getArray = function getArray () {\n    return this.array_;\n  };\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  Collection.prototype.item = function item (index) {\n    return this.array_[index];\n  };\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  Collection.prototype.getLength = function getLength () {\n    return this.get(Property.LENGTH);\n  };\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.insertAt = function insertAt (index, elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  };\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  Collection.prototype.pop = function pop () {\n    return this.removeAt(this.getLength() - 1);\n  };\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  Collection.prototype.push = function push (elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    var n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  };\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  Collection.prototype.remove = function remove (elem) {\n    var arr = this.array_;\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  Collection.prototype.removeAt = function removeAt (index) {\n    var prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n    return prev;\n  };\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.setAt = function setAt (index, elem) {\n    var n = this.getLength();\n    if (index < n) {\n      if (this.unique_) {\n        this.assertUnique_(elem, index);\n      }\n      var prev = this.array_[index];\n      this.array_[index] = elem;\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.REMOVE, prev));\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.ADD, elem));\n    } else {\n      for (var j = n; j < index; ++j) {\n        this.insertAt(j, undefined);\n      }\n      this.insertAt(index, elem);\n    }\n  };\n\n  /**\n   * @private\n   */\n  Collection.prototype.updateLength_ = function updateLength_ () {\n    this.set(Property.LENGTH, this.array_.length);\n  };\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number=} opt_except Optional index to ignore.\n   */\n  Collection.prototype.assertUnique_ = function assertUnique_ (elem, opt_except) {\n    for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== opt_except) {\n        throw new AssertionError(58);\n      }\n    }\n  };\n\n  return Collection;\n}(BaseObject));\n\n\nexport default Collection;\n\n//# sourceMappingURL=Collection.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\nimport ol_ext_element from '../util/element'\n\n/** A simple push button control\n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {String} options.title title of the control\n *  @param {String} options.name an optional name, default none\n *  @param {String} options.html html to insert in the control\n *  @param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\nvar ol_control_Button = function(options){\n  options = options || {};\n\n  var element = document.createElement(\"div\");\n  element.className = (options.className || '') + \" ol-button ol-unselectable ol-control\";\n  var self = this;\n\n  var bt = this.button_ = document.createElement(/ol-text-button/.test(options.className) ? \"div\": \"button\");\n  bt.type = \"button\";\n  if (options.title) bt.title = options.title;\n  if (options.html instanceof Element) bt.appendChild(options.html)\n  else bt.innerHTML = options.html || \"\";\n  var evtFunction = function(e) {\n    if (e && e.preventDefault) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    if (options.handleClick) {\n      options.handleClick.call(self, e);\n    }\n  };\n  bt.addEventListener(\"click\", evtFunction);\n  bt.addEventListener(\"touchstart\", evtFunction);\n  element.appendChild(bt);\n\n  // Try to get a title in the button content\n  if (!options.title && bt.firstElementChild) {\n    bt.title = bt.firstElementChild.title;\n  }\n\n  ol_control_Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  if (options.title) {\n    this.set(\"title\", options.title);\n  }\n  if (options.title) this.set(\"title\", options.title);\n  if (options.name) this.set(\"name\", options.name);\n};\nol_ext_inherits(ol_control_Button, ol_control_Control);\n\n/** Set the control visibility\n* @param {boolean} b \n*/\nol_control_Button.prototype.setVisible = function (val) {\n  if (val) ol_ext_element.show(this.element);\n  else ol_ext_element.hide(this.element);\n};\n\n/**\n * Set the button title\n * @param {string} title\n * @returns {undefined}\n */\nol_control_Button.prototype.setTitle = function(title) {\n  this.button_.setAttribute('title', title);\n};\n\n/**\n * Set the button html\n * @param {string} html\n * @returns {undefined}\n */\nol_control_Button.prototype.setHtml = function(html) {\n  ol_ext_element.setHTML (this.button_, html);\n};\n\n/**\n * Get the button element\n * @returns {undefined}\n */\nol_control_Button.prototype.getButtonElement = function() {\n  return this.button_;\n};\n\nexport default ol_control_Button\n","/**\n * @module ol/ImageBase\n */\nimport {abstract} from './util.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @abstract\n */\nvar ImageBase = /*@__PURE__*/(function (EventTarget) {\n  function ImageBase(extent, resolution, pixelRatio, state) {\n\n    EventTarget.call(this);\n\n    /**\n     * @protected\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = extent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number|undefined}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = state;\n\n  }\n\n  if ( EventTarget ) ImageBase.__proto__ = EventTarget;\n  ImageBase.prototype = Object.create( EventTarget && EventTarget.prototype );\n  ImageBase.prototype.constructor = ImageBase;\n\n  /**\n   * @protected\n   */\n  ImageBase.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  ImageBase.prototype.getExtent = function getExtent () {\n    return this.extent;\n  };\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   */\n  ImageBase.prototype.getImage = function getImage () {\n    return abstract();\n  };\n\n  /**\n   * @return {number} PixelRatio.\n   */\n  ImageBase.prototype.getPixelRatio = function getPixelRatio () {\n    return this.pixelRatio_;\n  };\n\n  /**\n   * @return {number} Resolution.\n   */\n  ImageBase.prototype.getResolution = function getResolution () {\n    return /** @type {number} */ (this.resolution);\n  };\n\n  /**\n   * @return {import(\"./ImageState.js\").default} State.\n   */\n  ImageBase.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  ImageBase.prototype.load = function load () {\n    abstract();\n  };\n\n  return ImageBase;\n}(EventTarget));\n\n\nexport default ImageBase;\n\n//# sourceMappingURL=ImageBase.js.map","/**\n * @module ol/ImageCanvas\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error=))} Loader\n */\n\n\nvar ImageCanvas = /*@__PURE__*/(function (ImageBase) {\n  function ImageCanvas(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n    var state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n    ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n    /**\n     * Optional canvas loader function.\n     * @type {?Loader}\n     * @private\n     */\n    this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = canvas;\n\n    /**\n     * @private\n     * @type {Error}\n     */\n    this.error_ = null;\n\n  }\n\n  if ( ImageBase ) ImageCanvas.__proto__ = ImageBase;\n  ImageCanvas.prototype = Object.create( ImageBase && ImageBase.prototype );\n  ImageCanvas.prototype.constructor = ImageCanvas;\n\n  /**\n   * Get any error associated with asynchronous rendering.\n   * @return {Error} Any error that occurred during rendering.\n   */\n  ImageCanvas.prototype.getError = function getError () {\n    return this.error_;\n  };\n\n  /**\n   * Handle async drawing complete.\n   * @param {Error=} err Any error during drawing.\n   * @private\n   */\n  ImageCanvas.prototype.handleLoad_ = function handleLoad_ (err) {\n    if (err) {\n      this.error_ = err;\n      this.state = ImageState.ERROR;\n    } else {\n      this.state = ImageState.LOADED;\n    }\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageCanvas.prototype.load = function load () {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.loader_(this.handleLoad_.bind(this));\n    }\n  };\n\n  /**\n   * @return {HTMLCanvasElement} Canvas element.\n   */\n  ImageCanvas.prototype.getImage = function getImage () {\n    return this.canvas_;\n  };\n\n  return ImageCanvas;\n}(ImageBase));\n\n\nexport default ImageCanvas;\n\n//# sourceMappingURL=ImageCanvas.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {bool} options.group is a group, default false\n *  @param {bool} options.toggleOne only one toggle control is active at a time, default false\n *  @param {bool} options.autoDeactivate used with subbar to deactivate all control when top level control deactivate, default false\n *  @param {Array<_ol_control_>} options.controls a list of control to add to the bar\n */\nvar ol_control_Bar = function(options) {\n  if (!options) options={};\n  var element = document.createElement(\"div\");\n      element.classList.add('ol-unselectable', 'ol-control', 'ol-bar');\n  if (options.className) {\n    var classes = options.className.split(' ').filter(function(className) {\n      return className.length > 0;\n    });\n    element.classList.add.apply(element.classList, classes)\n  }\n  if (options.group) element.classList.add('ol-group');\n\n  ol_control_Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  this.set('toggleOne', options.toggleOne);\n  this.set('autoDeactivate', options.autoDeactivate);\n\n  this.controls_ = [];\n  if (options.controls instanceof Array) {\n    for (var i=0; i<options.controls.length; i++) {\n      this.addControl(options.controls[i]);\n    }\n  }\n};\nol_ext_inherits(ol_control_Bar, ol_control_Control);\n\n/** Set the control visibility\n * @param {boolean} b\n */\nol_control_Bar.prototype.setVisible = function (val) {\n  if (val) this.element.style.display = '';\n  else this.element.style.display = 'none';\n}\n\n/** Get the control visibility\n * @return {boolean} b\n */\nol_control_Bar.prototype.getVisible = function () {\n  return this.element.style.display != 'none';\n}\n\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Bar.prototype.setMap = function (map) {\n  ol_control_Control.prototype.setMap.call(this, map);\n\n  for (var i=0; i<this.controls_.length; i++) {\n    var c = this.controls_[i];\n    // map.addControl(c);\n    c.setMap(map);\n  }\n};\n\n/** Get controls in the panel\n *\t@param {Array<_ol_control_>}\n */\nol_control_Bar.prototype.getControls = function () {\n  return this.controls_;\n};\n\n/** Set tool bar position\n *\t@param {top|left|bottom|right} pos\n */\nol_control_Bar.prototype.setPosition = function (pos) {\n  this.element.classList.remove('ol-left', 'ol-top', 'ol-bottom', 'ol-right');\n  pos=pos.split ('-');\n  for (var i=0; i<pos.length; i++) {\n    switch (pos[i]) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n        this.element.classList.add(\"ol-\"+pos[i]);\n        break;\n      default: break;\n    }\n  }\n};\n\n/** Add a control to the bar\n *\t@param {_ol_control_} c control to add\n */\nol_control_Bar.prototype.addControl = function (c) {\n  this.controls_.push(c);\n  c.setTarget(this.element);\n  if (this.getMap()) {\n    this.getMap().addControl(c);\n  }\n  // Activate and toogleOne\n  c.on ('change:active', function(e) { this.onActivateControl_(e, c); }.bind(this));\n  if (c.getActive) {\n    // c.dispatchEvent({ type:'change:active', key:'active', oldValue:false, active:true });\n    this.onActivateControl_({ target: c, active: c.getActive() }, c);\n  }\n};\n\n/** Deativate all controls in a bar\n * @param {_ol_control_} except a control\n */\nol_control_Bar.prototype.deactivateControls = function (except) {\n  for (var i=0; i<this.controls_.length; i++) {\n  if (this.controls_[i] !== except && this.controls_[i].setActive) {\n    this.controls_[i].setActive(false);\n    }\n  }\n};\n\n\nol_control_Bar.prototype.getActiveControls = function () {\n  var active = [];\n  for (var i=0, c; c=this.controls_[i]; i++) {\n    if (c.getActive && c.getActive()) active.push(c);\n  }\n  return active;\n}\n\n/** Auto activate/deactivate controls in the bar\n * @param {boolean} b activate/deactivate\n */\nol_control_Bar.prototype.setActive = function (b) {\n  if (!b && this.get(\"autoDeactivate\")) {\n    this.deactivateControls();\n  }\n  if (b) {\n    var ctrls = this.getControls();\n    for (var i=0, sb; (sb = ctrls[i]); i++) {\n      if (sb.get(\"autoActivate\")) sb.setActive(true);\n    }\n  }\n}\n\n/** Post-process an activated/deactivated control\n *\t@param {ol.event} e :an object with a target {_ol_control_} and active flag {bool}\n */\nol_control_Bar.prototype.onActivateControl_ = function (e, ctrl) {\n  if (this.get('toggleOne')) {\n    if (e.active) {\n      var n;\n      //var ctrl = e.target;\n      for (n=0; n<this.controls_.length; n++) {\n        if (this.controls_[n]===ctrl) break;\n      }\n      // Not here!\n      if (n==this.controls_.length) return;\n      this.deactivateControls (this.controls_[n]);\n    } else {\n      // No one active > test auto activate\n      if (!this.getActiveControls().length) {\n        for (var i=0, c; c=this.controls_[i]; i++) {\n          if (c.get(\"autoActivate\")) {\n            c.setActive(true);\n            break;\n          }\n        }\n      }\n    }\n  }\n};\n\n/**\n * @param {string} name of the control to search\n * @return {ol.control.Control}\n */\nol_control_Bar.prototype.getControlsByName = function(name) {\n  var controls = this.getControls();\n  return controls.filter(\n    function(control) {\n      return (control.get('name') === name);\n    }\n  );\n};\n\nexport default ol_control_Bar\n"],"sourceRoot":""}