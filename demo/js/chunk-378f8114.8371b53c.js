(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-378f8114"],{"0354":function(e,t,s){"use strict";e.exports=a,e.exports.default=a;var i=s("61ca");function a(e,t){if(!(this instanceof a))return new a(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function r(e,t,s){if(!s)return t.indexOf(e);for(var i=0;i<t.length;i++)if(s(e,t[i]))return i;return-1}function n(e,t){o(e,0,e.children.length,t,e)}function o(e,t,s,i,a){a||(a=v(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var r,n=t;n<s;n++)r=e.children[n],l(a,e.leaf?i(r):r);return a}function l(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function u(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function f(e,t){var s=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),a=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,a-s)*Math.max(0,r-i)}function m(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function v(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function b(e,t,s,a,r){var n,o=[t,s];while(o.length)s=o.pop(),t=o.pop(),s-t<=a||(n=t+Math.ceil((s-t)/a/2)*a,i(e,n,t,s,r),o.push(t,n,n,s))}a.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,s=[],i=this.toBBox;if(!g(e,t))return s;var a,r,n,o,l=[];while(t){for(a=0,r=t.children.length;a<r;a++)n=t.children[a],o=t.leaf?i(n):n,g(e,o)&&(t.leaf?s.push(n):m(e,o)?this._all(n,s):l.push(n));t=l.pop()}return s},collides:function(e){var t=this.data,s=this.toBBox;if(!g(e,t))return!1;var i,a,r,n,o=[];while(t){for(i=0,a=t.children.length;i<a;i++)if(r=t.children[i],n=t.leaf?s(r):r,g(e,n)){if(t.leaf||m(e,n))return!0;o.push(r)}t=o.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,s=e.length;t<s;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var a=this.data;this.data=i,i=a}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=v([]),this},remove:function(e,t){if(!e)return this;var s,i,a,n,o=this.data,l=this.toBBox(e),c=[],u=[];while(o||c.length){if(o||(o=c.pop(),i=c[c.length-1],s=u.pop(),n=!0),o.leaf&&(a=r(e,o.children,t),-1!==a))return o.children.splice(a,1),c.push(o),this._condense(c),this;n||o.leaf||!m(o,l)?i?(s++,o=i.children[s],n=!1):o=null:(c.push(o),u.push(s),s=0,i=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:c,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){var s=[];while(e)e.leaf?t.push.apply(t,e.children):s.push.apply(s,e.children),e=s.pop();return t},_build:function(e,t,s,i){var a,r=s-t+1,o=this._maxEntries;if(r<=o)return a=v(e.slice(t,s+1)),n(a,this.toBBox),a;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),a=v([]),a.leaf=!1,a.height=i;var l,c,u,h,d=Math.ceil(r/o),p=d*Math.ceil(Math.sqrt(o));for(b(e,t,s,p,this.compareMinX),l=t;l<=s;l+=p)for(u=Math.min(l+p-1,s),b(e,l,u,d,this.compareMinY),c=l;c<=u;c+=d)h=Math.min(c+d-1,u),a.children.push(this._build(e,c,h,i-1));return n(a,this.toBBox),a},_chooseSubtree:function(e,t,s,i){var a,r,n,o,l,c,u,d;while(1){if(i.push(t),t.leaf||i.length-1===s)break;for(u=d=1/0,a=0,r=t.children.length;a<r;a++)n=t.children[a],l=h(n),c=p(e,n)-l,c<d?(d=c,u=l<u?l:u,o=n):c===d&&l<u&&(u=l,o=n);t=o||t.children[0]}return t},_insert:function(e,t,s){var i=this.toBBox,a=s?e:i(e),r=[],n=this._chooseSubtree(a,this.data,t,r);n.children.push(e),l(n,a);while(t>=0){if(!(r[t].children.length>this._maxEntries))break;this._split(r,t),t--}this._adjustParentBBoxes(a,r,t)},_split:function(e,t){var s=e[t],i=s.children.length,a=this._minEntries;this._chooseSplitAxis(s,a,i);var r=this._chooseSplitIndex(s,a,i),o=v(s.children.splice(r,s.children.length-r));o.height=s.height,o.leaf=s.leaf,n(s,this.toBBox),n(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(s,o)},_splitRoot:function(e,t){this.data=v([e,t]),this.data.height=e.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,s){var i,a,r,n,l,c,u,d;for(c=u=1/0,i=t;i<=s-t;i++)a=o(e,0,i,this.toBBox),r=o(e,i,s,this.toBBox),n=f(a,r),l=h(a)+h(r),n<c?(c=n,d=i,u=l<u?l:u):n===c&&l<u&&(u=l,d=i);return d},_chooseSplitAxis:function(e,t,s){var i=e.leaf?this.compareMinX:c,a=e.leaf?this.compareMinY:u,r=this._allDistMargin(e,t,s,i),n=this._allDistMargin(e,t,s,a);r<n&&e.children.sort(i)},_allDistMargin:function(e,t,s,i){e.children.sort(i);var a,r,n=this.toBBox,c=o(e,0,t,n),u=o(e,s-t,s,n),h=d(c)+d(u);for(a=t;a<s-t;a++)r=e.children[a],l(c,e.leaf?n(r):r),h+=d(c);for(a=s-t-1;a>=t;a--)r=e.children[a],l(u,e.leaf?n(r):r),h+=d(u);return h},_adjustParentBBoxes:function(e,t,s){for(var i=s;i>=0;i--)l(t[i],e)},_condense:function(e){for(var t,s=e.length-1;s>=0;s--)0===e[s].children.length?s>0?(t=e[s-1].children,t.splice(t.indexOf(e[s]),1)):this.clear():n(e[s],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},"0791":function(e,t,s){"use strict";s("c240")},"0921":function(e,t,s){"use strict";var i=s("3115"),a=s("025e"),r=(s("5bc0"),s("c320")),n=s("9d47"),o=s("8f3a"),l=s("0af5"),c=s("a2e1"),u=s("5eee"),h=s("a2c7"),d=s("256f"),p=s("480c"),f=s("3e6b"),m=s("5831"),g=s("d0e9"),v=(s("1399"),s("0417")),b=s("3900");class y{constructor(){this.createHtml(),this.loading=0,this.loaded=0}addLoading(){this.loading++,this.update()}addLoaded(){this.loaded++,this.update()}update(){var e=(this.loaded/this.loading*100).toFixed(1)+"%";this.label.innerText="Loading Tiles ("+e+")",this.progressBarInner.style.width=e,this.loading===this.loaded&&(this.loading=0,this.loaded=0),this.el.style.opacity=this.show()?1:0}show(){return this.loading>0&&this.loaded<=this.loading}createHtml(){this.el=document.createElement("div"),this.el.className="ol-unselectable ol-progress-control",this.progressBar=document.createElement("div"),this.progressBar.className="progress-bar",this.progressBarInner=document.createElement("div"),this.progressBarInner.className="progress-bar-inner",this.progressBar.appendChild(this.progressBarInner),this.label=document.createElement("div"),this.label.className="progress-label",this.el.appendChild(this.progressBar),this.el.appendChild(this.label)}getControl(){var e=new b["a"]({element:this.el});return e}}var w,x,S={mixins:[i["a"]],props:{id:{type:String,required:!0},center:{type:Array,default:()=>[0,0]},zoom:{type:Number,default:1},show:{type:Boolean,default:!0},editable:{type:Boolean,default:!0}},data(){return{map:null,baseLayer:null,osm:null,progress:null}},watch:{show(){this.showMap()}},mounted(){this.showMap()},methods:{showMap(){this.show&&this.$nextTick(this.renderMap)},createMap(e=!1){if(null!==this.map)return this.map.updateSize(),void this.map.render();this.progress=new y,this.osm=new g["a"],this.baseLayer=new p["a"]({source:this.trackTileProgress(this.osm),baseLayer:!0,title:"OpenStreetMap"});var t=[new r["a"],new n["a"],this.progress.getControl()];e&&t.push(new v["a"]);var s={target:this.id,layers:[this.baseLayer],view:new h["a"]({center:Object(d["d"])([this.center[1],this.center[0]]),zoom:this.zoom})};this.editable?s.controls=Object(o["a"])().extend(t):(s.interactions=[],s.controls=t),this.map=new u["a"](s),this.listen("windowResized",this.updateMapSize)},renderMap(){this.createMap()},updateMapSize(){this.map&&this.map.updateSize()},addGeoJson(e){var t={};a["a"].detectGeoJson(e)&&(t.features=(new c["a"]).readFeatures(e,{featureProjection:this.osm.getProjection()}));var s=new m["a"](t),i=new f["a"]({title:"GeoJSON",source:s});this.map.addLayer(i);var r=s.getExtent();return Object(l["H"])(r)||this.map.getView().fit(r),i},trackTileProgress(e){return e.on("tileloadstart",()=>{this.progress.addLoading()}),e.on("tileloadend",()=>{this.progress.addLoaded()}),e.on("tileloaderror",()=>{this.progress.addLoaded()}),e}}},C=S,E=s("2877"),_=Object(E["a"])(C,w,x,!1,null,null,null);t["a"]=_.exports},"0f29":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textEditor",class:e.languageString},[s("div",{staticClass:"sourceHeader"},[e.title?s("h3",[e._v(e._s(e.title))]):e._e(),s("div",{staticClass:"sourceToolbar"},[e.editable?s("span",{staticClass:"sepr"},[s("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:e.confirmClear}},[s("i",{staticClass:"fas fa-file"})]),e._t("file-toolbar")],2):e._e(),e.editable?s("span",{staticClass:"sepr"},[s("button",{attrs:{type:"button",disabled:!e.canUndo,title:"Revert last change"},on:{click:function(t){return e.editor.undo()}}},[s("i",{staticClass:"fas fa-undo-alt"})]),s("button",{attrs:{type:"button",disabled:!e.canRedo,title:"Redo last reverted change"},on:{click:function(t){return e.editor.redo()}}},[s("i",{staticClass:"fas fa-redo-alt"})]),e._t("edit-toolbar")],2):e._e(),s("FullscreenButton",{attrs:{element:e.$el}}),e._t("toolbar")],2)]),s("div",{staticClass:"sourceCodeEditor",attrs:{id:e.id}})])},a=[],r=s("025e"),n=s("5472"),o=s("a76e"),l=s("56b3"),c=s.n(l),u=(s("a7be"),s("f9d4"),s("959b"),s("ced6"),s("db91"),s("903e"),s("d7d5"),s("8c33"),s("10b2"),s("0dd0"),s("8822"),s("d2de"),s("4ebc")),h=s.n(u);window.jsonlint=h.a;var d={name:"TextEditor",components:{FullscreenButton:n["a"]},props:{id:String,editable:{type:Boolean,default:!0},value:{required:!0},language:{type:String,default:null},placeholder:{type:String,default:""},title:{type:String}},computed:{...r["a"].mapGetters(["processRegistry"]),languageString(){return"string"===typeof this.language?this.language.toLowerCase():""},editorOptions(){let e={indentUnit:2,lineNumbers:!0,indentWithTabs:!0,matchBrackets:!0,autoCloseBrackets:!0,readOnly:!this.editable,placeholder:this.placeholder};switch(this.languageString){case"r":e.mode="text/x-rsrc";break;case"python":e.mode="text/x-python";break;case"math":e.mode="text/x-mathematica";break;case"markdown":e.mode="text/x-markdown";break;case"json":case"processgraph":Object.assign(e,{mode:"application/json",gutters:["CodeMirror-lint-markers"],lint:!0});break}return e}},data(){return{canUndo:!1,canRedo:!1,editor:null,emitValue:this.value}},watch:{value(){this.emitValue!==this.value&&(this.updateContent(),this.editor.clearHistory())},editorOptions(){for(var e in this.editorOptions)this.editor.setOption(e,this.editorOptions[e])}},mounted(){this.editor=c()(document.getElementById(this.id),this.editorOptions),this.editor.setSize(null,"100%"),"processgraph"===this.languageString&&this.editor.on("change",()=>this.updateState()),this.updateContent(),this.editor.on("changes",(e,t)=>{try{0===Object.values(t).filter(e=>"setValue"===e.origin).length&&this.commit()}catch(s){this.$emit("error",s)}})},methods:{confirmClear(){var e=confirm("Do you really want to clear the existing code?");e&&(this.insert(""),this.emit(null))},updateState(){this.editor.setOption("lint",!!this.editor.getValue().trim());let e=this.editor.getDoc().historySize();this.canUndo=e.undo>0,this.canRedo=e.redo>0,this.editor.refresh()},commit(){var e=this.editor.getValue();switch(this.languageString){case"math":return this.emit(e.replace(/[\r\n\t]+/," "));case"processgraph":if(e){var t=JSON.parse(e);if(r["a"].size(t)>0){var s=new o["ProcessGraph"](t,this.processRegistry);return s.allowEmpty(),s.parse(),this.emit(t)}}return this.emit(null);case"json":return e?this.emit(JSON.parse(e)):this.emit(null);default:return this.emit(e)}},emit(e){this.emitValue=e,this.$emit("input",e)},insert(e,t=!0){if("string"!==typeof e&&(e=String(e)),t){const t=this.editor.getValue();if(e!==t){const t=this.editor.getScrollInfo();this.editor.setValue(e),this.editor.scrollTo(t.left,t.top)}}else this.editor.replaceSelection(e)},updateContent(){if(this.value)switch(this.languageString){case"processgraph":r["a"].isObject(this.value)?this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit)):this.insert("");break;case"json":this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit));break;default:this.insert(this.value)}else this.insert("");this.editor.getDoc().clearHistory(),this.updateState()},insertProcess(e){try{this.insert(JSON.stringify(e,null,2),!1)}catch(t){r["a"].exception(this,t)}}}},p=d,f=(s("4cd1"),s("ccbe"),s("2877")),m=Object(f["a"])(p,i,a,!1,null,"17370a10",null);t["a"]=m.exports},"0f38":function(e,t,s){},"15dd":function(e,t,s){"use strict";s("bdf7")},"1b7a":function(e,t,s){"use strict";s("7ae6")},"1fa6":function(e,t,s){"use strict";s("de39")},"206d":function(e,t,s){},"25f7":function(e,t,s){},"2f5a":function(e,t,s){"use strict";s("dc31")},3265:function(e,t,s){},"352f":function(e,t,s){"use strict";s("da12")},"357d":function(e,t,s){},"35cc":function(e,t,s){"use strict";s("375e")},"36a6":function(e,t,s){"use strict";s("f778")},"375e":function(e,t,s){},3916:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.selectedSchema?s("div",{staticClass:"fieldContainer"},[e.showDataTypeChooser?s("div",{staticClass:"dataTypeChooser"},[s("select",{attrs:{name:"dataType",disabled:!e.editable},domProps:{value:e.selectedType},on:{input:e.onSelectType}},[e.groupedAllowedTypes.length>1?e._l(e.groupedAllowedTypes,(function(t){return s("optgroup",{key:t.name,attrs:{label:t.name}},e._l(t.types,(function(t){return s("option",{key:t.dataType(),domProps:{value:t.dataType()}},[e._v(e._s(e._f("dataTypeTitle")(t)))])})),0)})):e._l(e.groupedAllowedTypes[0].types,(function(t){return s("option",{key:t.dataType(),domProps:{value:t.dataType()}},[e._v(e._s(e._f("dataTypeTitle")(t)))])}))],2)]):e._e(),!e.isItem&&e.selectedSchema.description()?s("div",{staticClass:"description"},[s("i",{staticClass:"fas fa-info-circle"}),s("Description",{attrs:{description:e.selectedSchema.description(),compact:!0}})],1):e._e(),s("ParameterDataType",{attrs:{editable:e.editable,parameter:e.parameter,schema:e.selectedSchema,processId:e.processId,context:e.context,parent:e.parent},on:{changeType:e.setSelected},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1):e._e()},a=[],r=s("025e"),n=s("a76e"),o=s("783b"),l=s.n(o),c=s("fbdae"),u=null;class h extends n["JsonSchemaValidator"]{static create(e){return null===u&&(u=new h(e)),u}constructor(e){super(),this.store=e,this.setFileFormats(this.store.getters.fileFormats)}async validateBandName(e){return e.length>0}async validateEpsgCode(e){if(await this.store.dispatch("editor/loadEpsgCodes"),this.store.state.editor.epsgCodes[e])return!0;throw new l.a.ValidationError([{message:"Invalid EPSG code '"+e+"' specified."}])}async validateCollectionId(e){if(this.store.state.collections.filter(t=>t.id===e).length>0)return!0;throw new l.a.ValidationError([{message:"Collection with id '"+e+"' doesn't exist."}])}async validateFilePath(e){if(this.store.getters["files/getById"](e))return!0;throw new l.a.ValidationError([{message:"File at '"+e+"' doesn't exist."}])}async validateInputFormatOptions(e){throw"Not supported"}async validateOutputFormatOptions(e){throw"Not supported"}async validateJobId(e){if(this.store.getters["jobs/getById"](e))return!0;throw new l.a.ValidationError([{message:"Job with id '"+e+"' doesn't exist."}])}async validateUri(e){if(e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/))return!0;throw new l.a.ValidationError([{message:"URI is invalid"}])}async validateUdfCode(e){if(e.match(/(\r|\n)/))return!0;throw new l.a.ValidationError([{message:"UDF Code is invalid"}])}async validateUdfRuntime(e){if(e in this.store.state.udfRuntimes)return!0;throw new l.a.ValidationError([{message:"UDF runtime '"+e+"' is not supported."}])}async validateUdfRuntimeVersion(e){if(c["Versions"].validate(e))return!0;throw new l.a.ValidationError([{message:"UDF runtime version '"+e+"' is not a valid version number."}])}}var d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fieldEditorContainer"},[e.isResult?[s("div",{staticClass:"fieldValue externalData fromNode"},[s("span",[e._v("Output of "),s("tt",[e._v("#"+e._s(e.state.from_node))])],1)]),"array"===e.nativeParameterType?s("button",{attrs:{type:"button"},on:{click:function(t){return e.convertToArray()}}},[s("i",{staticClass:"fas fa-list"}),e._v(" Convert to array")]):e._e()]:"raster-cube"===e.type||"vector-cube"===e.type?s("div",{staticClass:"fieldValue description"},[s("i",{staticClass:"fas fa-exclamation-circle"}),e._v(' This parameter can only be set by creating a connection between an "Output" / "Result" and this parameter in the Visual Model. ')]):e.isPgParameter?[s("div",{staticClass:"fieldValue externalData fromArgument"},[s("span",[e._v("Value of process parameter "),s("tt",[e._v(e._s(e.state.from_parameter))])],1)]),"array"===e.nativeParameterType?s("button",{attrs:{type:"button"},on:{click:function(t){return e.convertToArray()}}},[s("i",{staticClass:"fas fa-list"}),e._v(" Convert to array")]):e._e()]:"null"===e.type?s("div",{staticClass:"description"},[s("i",{staticClass:"fas fa-info-circle"}),e._v(" This is set to "),s("strong",[s("tt",[e._v("null")])],1),e._v(", which is usually used as placeholder for no-data values or a default value.")]):e.isSelection?s("SelectBox",{key:e.type,attrs:{type:e.type,editable:e.editable,schema:e.schema,context:e.dependency},on:{onDetails:e.onSelectDetails},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):e.isTemporal?s("TemporalPicker",{key:e.type,attrs:{type:e.type,editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"bounding-box"===e.type?s("MapAreaSelect",{key:e.type,staticClass:"areaSelector",attrs:{id:e.name+"_bbox",editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"geojson"===e.type?s("MapGeoJsonEditor",{key:e.type,staticClass:"geoJsonEditor",attrs:{id:e.name+"_geojson",editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"process-graph"===e.type?s("Editor",{staticClass:"callbackEditor",attrs:{id:e.name,editable:e.editable,pgParameters:e.processParameters,showDiscoveryToolbar:!0,defaultValue:e.editorDefaultValue},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"output-format-options"===e.type||"input-format-options"===e.type?s("FileFormatOptionsEditor",{ref:"fileFormatOptionsEditor",attrs:{type:e.type,format:e.dependency},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"budget"===e.type?s("Budget",{attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"udf-code"===e.type?s("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:e.dependency},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"commonmark"===e.type?s("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:"markdown"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"wkt2-definition"===e.type||"proj-definition"===e.type?s("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"json"==e.type?s("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:"json"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"boolean"===e.type?s("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"checkbox",name:e.name,disabled:!e.editable},domProps:{checked:Array.isArray(e.state)?e._i(e.state,null)>-1:e.state},on:{change:function(t){var s=e.state,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);i.checked?n<0&&(e.state=s.concat([r])):n>-1&&(e.state=s.slice(0,n).concat(s.slice(n+1)))}else e.state=a}}}):"integer"===e.type||"number"===e.type?s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.state,expression:"state",modifiers:{number:!0}}],staticClass:"fieldValue",attrs:{type:"number",min:e.numericMin,max:e.numericMax,step:e.numericStep,name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}):"url"===e.type||"uri"===e.type?s("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"url",name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=t.target.value)}}}):"object"===e.nativeType||"array"===e.nativeType?s("ObjectEditor",{attrs:{editable:e.editable,parameter:e.parameter,schema:e.schema,isObject:"object"===e.nativeType,context:e.context},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"text",name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=t.target.value)}}})],2)},p=[],f=s("3115"),m=function(){var e=this,t=this,s=t.$createElement,i=t._self._c||s;return i("div",{class:{editor:!0,array:!t.isObject,object:t.isObject}},[i("div",{staticClass:"buttons"},[t.editable?i("button",{staticClass:"addBtn",attrs:{type:"button"},on:{click:function(e){return t.add()}}},[i("i",{staticClass:"fas fa-plus"}),t._v(" Add")]):t._e(),i("FullscreenButton",{attrs:{element:function(){return e.$el}}})],1),t.elements.length?i("draggable",{attrs:{handle:".mover"},model:{value:t.elements,callback:function(e){t.elements=e},expression:"elements"}},t._l(t.elements,(function(e,s){return i("div",{key:e.id,staticClass:"fieldValue element"},[i("label",{key:s,staticClass:"fieldLabel"},[t.isObject?i("input",{directives:[{name:"model",rawName:"v-model",value:e.key,expression:"e.key"}],attrs:{type:"text",disabled:!t.editable},domProps:{value:e.key},on:{input:function(s){s.target.composing||t.$set(e,"key",s.target.value)}}}):[t._v(t._s(s))]],2),i("ParameterDataTypes",{attrs:{editable:t.editable,parameter:t.elementSchema(s,e.key),isItem:!0,context:t.context},model:{value:e.value,callback:function(s){t.$set(e,"value",s)},expression:"e.value"}}),t.editable?i("button",{staticClass:"deleteBtn",attrs:{type:"button"},on:{click:function(e){return t.remove(s)}}},[i("i",{staticClass:"fas fa-trash"})]):t._e(),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editable&&!t.isObject,expression:"editable && !isObject"}],staticClass:"mover",attrs:{type:"button"}},[i("i",{staticClass:"fas fa-arrows-alt"})])],1)})),0):i("div",{staticClass:"empty description"},[i("i",{staticClass:"fas fa-info-circle"}),t.isObject?[t._v(" Object is empty")]:[t._v(" Array is empty")]],2)],1)},g=[],v=s("b76a"),b=s.n(v),y=s("5472"),w={name:"ObjectEditor",components:{draggable:b.a,FullscreenButton:y["a"],ParameterDataTypes:()=>Promise.resolve().then(s.bind(null,"3916"))},props:{parameter:Object,editable:{type:Boolean,default:!0},schema:Object,value:{},isObject:{type:Boolean,default:!1},context:{}},data(){return{elements:[]}},computed:{newValue(){if(this.isObject){let e={};for(let t of this.elements)e[t.key]=t.value;return e}return this.elements.map(e=>e.value)}},watch:{newValue:{deep:!0,handler(e){this.$emit("input",e)}},value:{immediate:!0,handler(e){if(this.newValue!==e&&(this.elements=[],e&&"object"===typeof e))for(var t in e)this.add(t,e[t])}}},methods:{elementSchema(e,t=null){return this.schema.getElementSchema(t||e)},add(e=null,t){let s={id:String(this.elements.length),value:t};this.isObject&&(s.key=e||"unnamed"+this.elements.length),"undefined"===typeof s.value&&(s.value=this.elementSchema(this.elements.length,s.key).default),this.elements.push(s)},remove(e){this.elements.splice(e,1)}}},x=w,S=(s("35cc"),s("2877")),C=Object(S["a"])(x,m,g,!1,null,"e5082542",null),E=C.exports,_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"datatypeEditor budget"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.hasBudget,expression:"hasBudget"}],attrs:{type:"checkbox",disabled:!e.editable},domProps:{checked:Array.isArray(e.hasBudget)?e._i(e.hasBudget,null)>-1:e.hasBudget},on:{change:function(t){var s=e.hasBudget,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);i.checked?n<0&&(e.hasBudget=s.concat([r])):n>-1&&(e.hasBudget=s.slice(0,n).concat(s.slice(n+1)))}else e.hasBudget=a}}}),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.amount,expression:"amount",modifiers:{number:!0}}],attrs:{type:"number",min:"0.00",max:e.max,step:"0.01",disabled:!e.hasBudget||!e.editable},domProps:{value:e.amount},on:{input:function(t){t.target.composing||(e.amount=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e._v(" "+e._s(e.capabilities.currency())+" ")])},k=[],P={name:"Budget",computed:{...r["a"].mapState(["userInfo"]),...r["a"].mapGetters(["capabilities"]),max(){return this.userInfo.budget>0?this.userInfo.budget:Number.MAX_VALUE}},props:{value:{type:Number,default:null},editable:{type:Boolean,default:!0}},data(){return{hasBudget:"number"===typeof this.value,amount:this.value}},watch:{hasBudget(){this.updateData()},amount(){this.updateData()}},methods:{updateData(){this.$emit("input",this.hasBudget&&!Number.isNaN(this.amount)?this.amount:null)}}},T=P,D=Object(S["a"])(T,_,k,!1,null,null,null),M=D.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:e.id}})},I=[],F=s("0921"),j=s("3900"),B=s("256f");class ${constructor(e,t=!0,s=null,i=null){this.map=e;var a=this.map.getSize();this.width=s||(a[0]>0?.7*a[0]:300),this.height=i||(a[1]>0?.7*a[1]:200),this.moving=!1,this.editable=t,this.interactionListener=null,this.createElements(),this.addControls(),this.render()}setInteractionListener(e){this.interactionListener=e}getBounds(e=!1){var t=this.map.getSize(),s=[0,0],i=[0,0];i[0]=Math.round((t[0]-this.width)/2),s[1]=Math.round((t[1]-this.height)/2),s[0]=t[0]-i[0],i[1]=t[1]-s[1];var a=Object(B["i"])(this.map.getCoordinateFromPixel(i)),r=Object(B["i"])(this.map.getCoordinateFromPixel(s));return e?a.concat(r):{west:a[0],south:a[1],east:r[0],north:r[1]}}setBounds(e){if(e){Array.isArray(e)&&(e=r["a"].extentToBBox(e));var t=Object(B["d"])([e.west,e.south]),s=Object(B["d"])([e.east,e.north]),i={callback:()=>{var e=this.map.getPixelFromCoordinate(t),i=this.map.getPixelFromCoordinate(s);this.width=Number.parseInt(Math.abs(e[0]-i[0])),this.height=Number.parseInt(Math.abs(e[1]-i[1])),this.render()}},a=this.map.getSize();!this.editable&&a&&(i.padding=[a[0]/3,a[1]/3,a[0]/3,a[1]/3]),this.map.getView().fit([...t,...s],i)}}createElement(e,t,s){var i=document.createElement(e);return i.className=t,s&&s.appendChild(i),i}createElements(){this.overlayContainer||(this.overlayContainer=this.createElement("div","ol-unselectable ol-areaselect ol-areaselect-shade-container",this.map.getOverlayContainer()),this.topShade=this.createElement("div","ol-areaselect-shade",this.overlayContainer),this.bottomShade=this.createElement("div","ol-areaselect-shade",this.overlayContainer),this.leftShade=this.createElement("div","ol-areaselect-shade",this.overlayContainer),this.rightShade=this.createElement("div","ol-areaselect-shade",this.overlayContainer),this.editable&&(this.nwHandle=this.createElement("div","ol-areaselect-handle"),this.swHandle=this.createElement("div","ol-areaselect-handle"),this.neHandle=this.createElement("div","ol-areaselect-handle"),this.seHandle=this.createElement("div","ol-areaselect-handle"),this.setUpHandlerEvents(this.nwHandle,1,1),this.setUpHandlerEvents(this.neHandle,-1,1),this.setUpHandlerEvents(this.swHandle,1,-1),this.setUpHandlerEvents(this.seHandle,-1,-1)),this.map.on("change:size",()=>this.onInteraction()))}setUpHandlerEvents(e,t,s){var i=e=>{if(this.moving){var i=this.map.getSize();this.width+=2*(this.moving[0]-e.pageX)*t,this.height+=2*(this.moving[1]-e.pageY)*s,this.width=Math.max(30,this.width),this.height=Math.max(30,this.height),this.width=Math.min(i[0]-30,this.width),this.height=Math.min(i[1]-30,this.height),this.moving=[e.pageX,e.pageY],this.render()}},a=this.map.getTargetElement(),r=document.querySelector("html"),n=()=>{this.map.getTargetElement()&&(a.removeEventListener("mousemove",i),r.removeEventListener("mouseup",n),this.moving=!1,"function"===typeof this.interactionListener&&this.interactionListener())};e.addEventListener("mousedown",e=>{e.stopPropagation(),this.moving=[e.pageX,e.pageY],a.addEventListener("mousemove",i),r.addEventListener("mouseup",n)})}onInteraction(){this.render()}render(){var e=this.map.getSize(),t=Math.round((e[1]-this.height)/2),s=Math.round((e[0]-this.width)/2);if(this.setElementDimensions(this.overlayContainer,{width:e[0],height:e[1]}),this.setElementDimensions(this.topShade,{width:e[0],height:t,top:0,left:0}),this.setElementDimensions(this.bottomShade,{width:e[0],height:t,bottom:0,left:0}),this.setElementDimensions(this.leftShade,{width:s,height:e[1]-2*t,top:t,left:0}),this.setElementDimensions(this.rightShade,{width:s,height:e[1]-2*t,top:t,right:0}),this.editable){var i=Math.round(this.nwHandle.offsetWidth/2);this.setElementDimensions(this.nwHandle,{left:s-i,top:t-7}),this.setElementDimensions(this.neHandle,{right:s-i,top:t-7}),this.setElementDimensions(this.swHandle,{left:s-i,bottom:t-7}),this.setElementDimensions(this.seHandle,{right:s-i,bottom:t-7})}}setElementDimensions(e,t){e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.top=t.top+"px",e.style.left=t.left+"px",e.style.bottom=t.bottom+"px",e.style.right=t.right+"px"}addControls(){this.editable&&(this.addControl(this.nwHandle),this.addControl(this.neHandle),this.addControl(this.swHandle),this.addControl(this.seHandle))}addControl(e){this.map.addControl(new j["a"]({element:e}))}}var R={name:"MapAreaSelect",mixins:[F["a"]],props:{value:{type:[Object,Array],default:()=>null}},computed:{asArray(){return Array.isArray(this.value)}},methods:{renderMap(){if(this.createMap(),this.areaSelect=new $(this.map,this.editable),null!==this.value&&this.areaSelect.setBounds(this.value),this.editable){var e=()=>this.$emit("input",this.areaSelect.getBounds(this.asArray));this.areaSelect.setInteractionListener(e),this.map.on("change",e),this.map.getView().on("change",e),this.map.on("propertychange",e)}}}},A=R,N=(s("991b"),s("1fa6"),Object(S["a"])(A,O,I,!1,null,null,null)),L=N.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:e.id}})},U=[],J=s("a2e1"),z=s("b2fc"),X=(s("faaa"),s("f087")),Y=s("e887"),H=(s("159a"),s("c516")),G=s("d803"),q={name:"MapGeoJsonEditor",mixins:[F["a"]],props:{value:{type:Object,default:null}},data(){return{geoJsonLayer:null}},methods:{showMap(){this.show&&this.$nextTick(this.renderMap)},renderMap(){if(this.createMap(!0),this.editable?this.geoJsonLayer=this.geoJsonEditor(this.value):this.geoJsonLayer=this.addGeoJson(this.value),this.editable){var e=()=>this.$emit("input",this.getGeoJson());this.geoJsonLayer.getSource().on("change",e)}},geoJsonEditor(e){var t=this.addGeoJson(e),s=new X["a"];this.map.addControl(s);var i=new H["a"]({source:t.getSource(),interactions:{Info:!1,DrawHole:!1,Offset:!1,Split:!1}});s.addControl(i);var a=new G["a"];this.map.addInteraction(a),a.on("undo",e=>{"addfeature"===e.action.type&&(i.getInteraction("Select").getFeatures().clear(),i.getInteraction("Transform").select())});var r=new X["a"]({group:!0,controls:[new Y["a"]({html:'<i class="fas fa-undo-alt"></i>',title:"Undo",handleClick:()=>a.undo()}),new Y["a"]({html:'<i class="fas fa-redo-alt"></i>',title:"Redo",handleClick:()=>a.redo()})]});return s.addControl(r),this.map.addInteraction(new z["a"]({source:t.getSource()})),t},getGeoJson(){var e=new J["a"],t=this.geoJsonLayer.getSource().getFeatures(),s=[];for(var i in t)s.push(e.writeFeatureObject(t[i],{dataProjection:"EPSG:4326",featureProjection:this.osm.getProjection()}));return 0===s.length?null:1===s.length?!s[0].properties&&s[0].geometry?s[0].geometry:s[0]:{type:"FeatureCollection",features:s}}}},W=q,K=Object(S["a"])(W,V,U,!1,null,null,null),Z=K.exports,Q=s("0f29"),ee={name:"ParameterDataType",mixins:[f["a"]],components:{ObjectEditor:E,Budget:M,MapAreaSelect:L,MapGeoJsonEditor:Z,TextEditor:Q["a"],Editor:()=>Promise.resolve().then(s.bind(null,"ceb0")),FileFormatOptionsEditor:()=>s.e("chunk-68913ea4").then(s.bind(null,"eeea")),ParameterDataTypes:()=>Promise.resolve().then(s.bind(null,"3916")),SelectBox:()=>s.e("chunk-d5393026").then(s.bind(null,"3e57")),TemporalPicker:()=>s.e("chunk-74ac3557").then(s.bind(null,"cca6"))},props:{parameter:Object,editable:{type:Boolean,default:!0},schema:Object,value:{},processId:String,context:{},parent:{}},data(){return{state:this.value}},computed:{type(){return this.schema.dataType()},nativeType(){return this.schema.nativeDataType()},nativeParameterType(){return this.parameter.nativeDataType()},editorDefaultValue(){if("process-graph"===this.type){if("undefined"!==typeof this.parameter.default)return this.parameter.default;if(this.parameter.nullable())return null}},isTemporal(){return"date"===this.type||"time"===this.type||"date-time"===this.type||"temporal-interval"===this.type||"year"===this.type},isSelection(){switch(this.type){case"collection-id":case"job-id":case"file-path":case"file-paths":case"epsg-code":case"input-format":case"output-format":case"service-type":case"billing-plan":case"udf-runtime":case"udf-runtime-version":return!0;case"band-name":return!!this.dependency;default:return this.schema.isEnum()}},name(){return this.parameter.name+(Array.isArray(this.parameter.value)?"[]":"")},isResult(){return Boolean(r["a"].isObject(this.state)&&this.state.from_node&&1===r["a"].size(this.state)&&this.schema.schema.isRef)},isPgParameter(){return Boolean(r["a"].isObject(this.state)&&this.state.from_parameter&&1===r["a"].size(this.state)&&this.schema.schema.isRef)},numericMin(){return"number"===typeof this.schema.minimum?this.schema.minimum:""},numericMax(){return"number"===typeof this.schema.maximum?this.schema.maximum:""},numericStep(){return"number"===typeof this.schema.multipleOf?this.schema.multipleOf:"integer"===this.type?1:"any"},newValue(){if("number"===this.type){var e=Number.parseFloat(this.state);return Number.isNaN(e)?null:e}if("integer"===this.type){e=Number.parseInt(this.state);return Number.isNaN(e)?null:e}if("null"===this.type)return null;if("string"===typeof this.state&&this.state.length>0&&("any"===this.type||"mixed"===this.type)){e=Number(this.state);return Number.isNaN(e)?this.state:e}return this.state},dependency(){switch(this.type){case"output-format-options":case"input-format-options":return this.getValueFromOtherParameterByDataType(this.type.replace("-options",""));case"udf-runtime-version":case"udf-code":return this.getValueFromOtherParameterByDataType("udf-runtime");case"band-name":return this.getValueFromOtherParameterByDataType("collection-id");default:return}},processParameters(){let e=this.schema.getCallbackParameters(),t=[];r["a"].isObject(this.parent)&&"function"===typeof this.parent.getPgParameters&&(t=this.parent.getPgParameters().map(e=>e.spec));let s=e.map(e=>e.name),i=t.filter(e=>!s.includes(e.name));return e.concat(i)}},watch:{value(e){e!==this.newValue&&(this.state=this.value)},async newValue(e){this.$emit("input",e)}},methods:{getValueFromOtherParameterByDataType(e){if(r["a"].isObject(this.context)&&r["a"].isObject(this.context.schemas)&&r["a"].isObject(this.context.values))for(let t in this.context.schemas){let s=this.context.schemas[t];if(r["a"].isObject(s)&&s.dataType()===e)return this.context.values[t]}},convertToArray(){this.state=[this.state],this.$emit("input",this.state),this.$emit("changeType","array")},onSelectDetails(){"collection-id"===this.type&&this.emit("showCollection",this.state)}}},te=ee,se=(s("9408"),Object(S["a"])(te,d,p,!1,null,"45e6a39c",null)),ie=se.exports,ae=s("8088"),re=s("79e5");const ne=r["a"].resolveJsonRefs(s("ff6c")).definitions,oe=["Basics","References","Spatial","Temporal","File and Folders","Resources","CRS","UDF","Other"],le=()=>(new Date).toISOString().replace(/\.\d+/,""),ce=["string","integer","number","boolean","array","object"],ue=[{type:"null",const:null,group:"Basics"},{type:"string",default:"",group:"Basics"},{type:"integer",default:0,group:"Basics"},{type:"number",default:0,group:"Basics"},{type:"boolean",default:!1,group:"Basics"},{type:"array",default:[],group:"Basics"},{type:"object",default:{},group:"Basics"},{type:"string",subtype:"date-time",format:"date-time",title:"Date and Time",group:"Temporal",default:()=>le()},{type:"string",subtype:"date",format:"date",title:"Date only",group:"Temporal",default:()=>le().substring(0,10)},{type:"string",subtype:"time",format:"time",title:"Time only",group:"Temporal",default:()=>le().substring(11)},{type:"string",subtype:"year",title:"Year only",group:"Temporal"},{type:"array",subtype:"temporal-interval",title:"Temporal interval",group:"Temporal"},{type:"array",subtype:"temporal-intervals",title:"Temporal intervals (multiple)",group:"Temporal",default:[]},{type:"object",subtype:"geojson",title:"GeoJSON",group:"Spatial"},{type:"object",subtype:"bounding-box",title:"Bounding Box",group:"Spatial"},{type:"string",subtype:"band-name",title:"Band",group:"Resources"},{type:"string",subtype:"collection-id",title:"Collection",group:"Resources"},{type:"string",subtype:"job-id",title:"Batch Job",group:"Resources"},{type:"string",subtype:"udf-code",title:"UDF Source Code",group:"UDF",default:""},{type:"string",subtype:"udf-runtime",title:"UDF Runtime",group:"UDF"},{type:"string",subtype:"udf-runtime-version",title:"UDF Runtime Version",group:"UDF",any:!1},{type:"integer",subtype:"epsg-code",title:"EPSG Code (CRS)",group:"CRS"},{type:"string",subtype:"proj-definition",title:"PROJ defintiion (CRS)",group:"CRS",default:""},{type:"string",subtype:"wkt2-definition",title:"WKT2 defintiion (CRS)",group:"CRS",default:""},{type:"array",subtype:"file-path",title:"File path",group:"File and Folders"},{type:"array",subtype:"file-paths",title:"File paths (multiple)",group:"File and Folders",default:[]},{type:"string",subtype:"uri",format:"uri",title:"URI / URL",group:"File and Folders"},{type:"string",subtype:"output-format",title:"Export file format",group:"File and Folders"},{type:"object",subtype:"output-format-options",title:"Export file format parameters",group:"File and Folders",any:!1},{type:"string",subtype:"input-format",title:"Import file format",group:"File and Folders"},{type:"object",subtype:"input-format-options",title:"Import file format parameters",group:"File and Folders",any:!1},{type:"object",subtype:"process-graph",title:"Custom Process"},{subtype:"json",title:"JSON"}];var he={name:"ParameterDataTypes",mixins:[f["a"]],components:{Description:ae["default"],ParameterDataType:ie},props:{parameter:{type:Object,default:()=>new re["c"]({})},editable:{type:Boolean,default:!0},processId:String,value:{},isItem:{type:Boolean,default:!1},context:{},parent:{}},data(){return{state:"undefined"===typeof this.value?this.parameter.default:this.value,selectedType:null,selectedNativeType:null,selectedSchema:null,jsonSchemaValidator:h.create(this.$store)}},filters:{dataTypeTitle(e){if(e.schema&&!e.schema.title){let t=ue.find(t=>t.subtype===e.schema.subtype||t.type===e.schema.type);if(t&&t.title)return t.title}return e.title()}},async created(){await this.detectType()},computed:{refSchemas(){let e={};for(let t of this.parameter.getRefs()){let s;t.from_node?(s="from_node:"+t.from_node,e[s]=new re["b"]({type:"object",group:"References",refId:s,isRef:"from_node",from_node:t.from_node,title:"Output of #"+t.from_node,required:["from_node"],properties:{from_node:{type:"string",const:t.from_node}},const:t,additionalProperties:!1})):t.from_parameter&&(s="from_parameter:"+t.from_parameter,e[s]=new re["b"]({type:"object",group:"References",refId:s,isRef:"from_parameter",from_parameter:t.from_parameter,title:'Value of process parameter "'+t.from_parameter+'"',required:["from_parameter"],properties:{from_parameter:{type:"string",const:t.from_parameter}},const:t,additionalProperties:!1}))}return e},showDataTypeChooser(){return r["a"].size(this.allowedTypes)>=2},allowedTypes(){if("any"===this.parameter.dataType())return Object.assign({},this.supportedTypes,this.refSchemas);{let e={};for(let t of this.parameter.schemas){let s=t.dataType();e[s]=t}return Object.assign(e,this.refSchemas)}},supportedTypes(){let e={};for(let t of ue){if(!1===t.any)continue;let s=t.subtype||t.type,i=Object.assign({},ne[s],t);e[s]=new re["b"](i,this.parameter)}return e},groupedAllowedTypes(){let e={};for(let t in this.allowedTypes){let s=this.allowedTypes[t],i=s.group();Array.isArray(e[i])?e[i].push(s):e[i]=[s]}return oe.map(t=>({name:t,types:e[t]||[]})).filter(e=>0!==e.types.length)}},watch:{value(e){e!==this.state&&(this.state=e)},state(e){this.$emit("input",e)},selectedType(e){this.$emit("schemaSelected",this.supportedTypes[e])}},methods:{async getTypeForValue(e,t){var s=[];for(var i of e)try{var a=await this.jsonSchemaValidator.validateValue(t,i.schema);if(a.length>0)continue;s.push(i.dataType())}catch(r){}return s},async detectType(){let e=Object.keys(this.allowedTypes),t="undefined"===typeof this.state;if(0===e.length)await this.setSelected("json");else if(1===e.length)await this.setSelected(e[0],t);else if(t){let t=e.filter(e=>"null"!==e);await this.setSelected(t[0],!0)}else{let e=await this.getTypeForValue(Object.values(this.allowedTypes),this.state);if(0===e.length)await this.setSelected("json");else if(1===e.length)await this.setSelected(e[0]);else{e.includes("integer")&&e.includes("number")&&(e=e.filter(e=>"integer"!==e)),!r["a"].isRef(this.state)&&e.length>1&&console.warn("A parameter is ambiguous. Potential types: "+e.join(", ")+". Value: "+JSON.stringify(this.state));let t=e.findIndex(e=>ce.includes(e))||0;await this.setSelected(e[t])}}},async onSelectType(e){await this.setSelected(e.target.value,!0)},async setSelected(e,t=!1){let s=e;if(e instanceof re["b"]?(this.selectedSchema=e,this.selectedType=e.dataType(),s=e.nativeDataType()):(this.selectedSchema=this.allowedTypes[e]?this.allowedTypes[e]:this.supportedTypes[e],this.selectedType=e),t){if("number"===typeof this.state&&"string"===s)this.state=String(this.state);else if("string"===typeof this.state&&"integer"===s){if(this.state.match(/^([+-]?\d+)$/)){let e=Number.parseInt(this.state,10);Number.isNaN(e)||(this.state=e)}}else if("string"===typeof this.state&&"number"===s){let e=Number.parseFloat(this.state);Number.isNaN(e)||(this.state=e)}if(this.selectedSchema.isNull())this.state=null;else if("undefined"!==typeof this.selectedSchema.const)this.state=this.selectedSchema.const;else if(this.selectedSchema.isEnum()&&1===this.selectedSchema.getEnumChoices().length)this.state=this.selectedSchema.getEnumChoices()[0];else{let e=this.selectedSchema.default();try{("undefined"===typeof this.state||(await this.jsonSchemaValidator.validateValue(this.state,this.selectedSchema)).length>0)&&(this.state=e)}catch(i){this.state=e}}}}}},de=he,pe=(s("2f5a"),Object(S["a"])(de,i,a,!1,null,null,null));t["default"]=pe.exports},3986:function(e,t,s){},4525:function(e,t,s){},4833:function(e,t,s){},"4cd1":function(e,t,s){"use strict";s("3265")},"4d982":function(e,t,s){"use strict";s("c98e")},"50e5":function(e,t,s){},5472:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("button",{attrs:{type:"button",title:e.isFullscreen?"Close fullscreen":"Show fullscreen"},on:{click:e.toggleFullscreen}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.isFullscreen,expression:"isFullscreen"}]},[s("i",{staticClass:"fas fa-compress"})]),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFullscreen,expression:"!isFullscreen"}]},[s("i",{staticClass:"fas fa-expand"})])])},a=[],r=s("025e"),n={name:"FullscreenButton",props:{element:{type:[String,Function,Object],required:!0}},data(){return{isFullscreen:!1,keyDownFn:null,oldZIndex:"auto"}},mounted(){this.keyDownFn=this.onkeyDown.bind(this);let e=this.getElement();e&&e.addEventListener("keydown",this.keyDownFn)},beforeDestroy(){let e=this.getElement();e&&e.removeEventListener("keydown",this.keyDownFn)},computed:{...r["a"].mapState("editor",["hightestModalZIndex"])},methods:{...r["a"].mapMutations("editor",["openModal","closeModal"]),onkeyDown(e){!this.isFullscreen||"F11"!==e.key&&"Escape"!==e.key||(this.toggleFullscreen(),e.preventDefault(),e.stopPropagation())},getElement(){return"string"===typeof this.element?document.querySelector(this.element):"function"===typeof this.element?this.element():this.element},toggleFullscreen(){let e=this.getElement();this.isFullscreen?(this.isFullscreen=!1,e.classList.remove("fullscreen"),e.style.zIndex=this.oldZIndex,this.closeModal()):(this.isFullscreen=!0,e.classList.add("fullscreen"),this.openModal(),this.oldZIndex=e.style.zIndex,e.style.zIndex=this.hightestModalZIndex),this.$emit("changed",this.isFullscreen)}}},o=n,l=(s("90f4"),s("2877")),c=Object(l["a"])(o,i,a,!1,null,null,null);t["a"]=c.exports},"5e74":function(e,t,s){},"61ca":function(e,t,s){(function(t,s){e.exports=s()})(0,(function(){"use strict";function e(e,s,a,r,n){t(e,s,a||0,r||e.length-1,n||i)}function t(e,i,a,r,n){while(r>a){if(r-a>600){var o=r-a+1,l=i-a+1,c=Math.log(o),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(o-u)/o)*(l-o/2<0?-1:1),d=Math.max(a,Math.floor(i-l*u/o+h)),p=Math.min(r,Math.floor(i+(o-l)*u/o+h));t(e,i,d,p,n)}var f=e[i],m=a,g=r;s(e,a,i),n(e[r],f)>0&&s(e,a,r);while(m<g){s(e,m,g),m++,g--;while(n(e[m],f)<0)m++;while(n(e[g],f)>0)g--}0===n(e[a],f)?s(e,a,g):(g++,s(e,g,r)),g<=i&&(a=g+1),i<=g&&(r=g-1)}}function s(e,t,s){var i=e[t];e[t]=e[s],e[s]=i}function i(e,t){return e<t?-1:e>t?1:0}return e}))},"6e6b":function(e,t,s){"use strict";s("ded2")},"74bf":function(e,t,s){"use strict";s("78d9")},"751a":function(e,t,s){"use strict";s("4833")},"76b6":function(e,t,s){},"78d9":function(e,t,s){},"7ae6":function(e,t,s){},"7b86":function(e,t,s){"use strict";s("3986")},8862:function(e,t,s){"use strict";s("5e74")},"8f78":function(e,t,s){"use strict";s("c5cf")},"90b4":function(e,t,s){},"90f4":function(e,t,s){"use strict";s("206d")},"916f":function(e,t,s){"use strict";s("ebe9")},"93ec":function(e,t,s){"use strict";s("9bfa")},9408:function(e,t,s){"use strict";s("0f38")},9512:function(e,t,s){},"991b":function(e,t,s){"use strict";s("90b4")},9961:function(e,t,s){"use strict";s("76b6")},"9bfa":function(e,t,s){},a5c1:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:e.id}})},a=[],r=s("0921"),n=s("025e"),o=s("4cdf"),l=s("5bc3"),c=s("256f"),u=s("480c"),h=s("6cf3"),d=s("3e6b"),p=s("5831"),f=s("2ef1"),m=(s("7505"),s("cfd3")),g={name:"MapViewer",mixins:[r["a"]],props:{extents:{type:Array,default:()=>null},geoJson:{type:Object,default:()=>null}},data(){return{userLayers:{},swipe:{control:null,left:null,right:null}}},methods:{renderMap(){let e=Array.isArray(this.extents)&&this.extents.length>0;if(this.createMap(!e),e)for(let s of this.extents){var t=n["a"].extentToBBox(s);this.addRectangle(t.west,t.east,t.north,t.south)}n["a"].isObject(this.geoJson)&&(this.geoJsonLayer=this.addGeoJson(this.geoJson))},addRectangle(e,t,s,i){var a=[...Object(c["d"])([e,i]),...Object(c["d"])([t,s])];this.map.addLayer(new d["a"]({title:"Extent",displayInLayerSwitcher:!1,source:new p["a"]({features:[new o["a"](Object(l["c"])(a))],wrapX:!1})})),this.map.getView().fit(a)},getVisibleLayers(){var e=[];for(var t in this.userLayers)this.userLayers[t].getVisible()&&e.push(t);return e},showWebService(e){switch(e.type.toLowerCase()){case"xyz":this.updateXYZLayer(e);break;default:n["a"].error(this,"Sorry, the service type is not supported by the map.")}},toggleSwipeControl(){var e=this.getVisibleLayers();2===e.length?(null===this.swipe.control&&(this.swipe.control=new m["a"],this.map.addControl(this.swipe.control)),this.swipe.left!==e[0]&&(this.swipe.control.addLayer(this.userLayers[e[0]]),this.swipe.left=e[0]),this.swipe.right!==e[1]&&(this.swipe.control.addLayer(this.userLayers[e[1]],!0),this.swipe.right=e[1])):(this.map.removeControl(this.swipe.control),this.swipe.control=null,this.swipe.left=null,this.swipe.right=null)},addLayerToMap(e,t){this.userLayers[e]=t,this.map.addLayer(t),this.toggleSwipeControl(),t.on("change",()=>this.toggleSwipeControl()),t.on("change:visible",()=>this.toggleSwipeControl()),t.on("change:zIndex",()=>this.toggleSwipeControl())},removeLayerFromMap(e){this.userLayers[e]&&(this.map.removeLayer(this.userLayers[e]),delete this.userLayers[e],this.toggleSwipeControl())},updateGeoTiffLayer(e,t=null){var s=new u["a"]({source:new h["a"]({url:"http://tiles.rdnt.io/tiles?url="+encodeURIComponent(e),crossOrigin:"anonymous"})});this.addLayerToMap(t||"GeoTiff",s)},updateXYZLayer(e){var t=e.id,s=e.url,i=n["a"].getResourceTitle(e,"Service")+" (XYZ)";if("undefined"===typeof this.userLayers[t]){var a=new u["a"]({source:this.trackTileProgress(new f["a"]({url:s})),title:i});this.addLayerToMap(t,a)}else{var r=n["a"].replaceParam(s,"__editorSessionId",(new Date).getTime());r=r.replace(/%7B/g,"{").replace(/%7D/g,"}"),this.userLayers[t].getSource().setUrl(r)}}}},v=g,b=(s("991b"),s("2877")),y=Object(b["a"])(v,i,a,!1,null,null,null);t["a"]=y.exports},a89b:function(e,t,s){"use strict";s("357d")},aa47:function(e,t,s){"use strict";
/**!
 * Sortable 1.10.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},r.apply(this,arguments)}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},i=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),i.forEach((function(t){a(e,t,s[t])}))}return e}function o(e,t){if(null==e)return{};var s,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(a[s]=e[s]);return a}function l(e,t){if(null==e)return{};var s,i,a=o(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function c(e){return u(e)||h(e)||d()}function u(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}function h(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}s.r(t),s.d(t,"MultiDrag",(function(){return At})),s.d(t,"Sortable",(function(){return Ze})),s.d(t,"Swap",(function(){return kt}));var p="1.10.2";function f(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var m=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=f(/Edge/i),v=f(/firefox/i),b=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),y=f(/iP(ad|od|hone)/i),w=f(/chrome/i)&&f(/android/i),x={capture:!1,passive:!1};function S(e,t,s){e.addEventListener(t,s,!m&&x)}function C(e,t,s){e.removeEventListener(t,s,!m&&x)}function E(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(s){return!1}return!1}}function _(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function k(e,t,s,i){if(e){s=s||document;do{if(null!=t&&(">"===t[0]?e.parentNode===s&&E(e,t):E(e,t))||i&&e===s)return e;if(e===s)break}while(e=_(e))}return null}var P,T=/\s+/g;function D(e,t,s){if(e&&t)if(e.classList)e.classList[s?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(T," ").replace(" "+t+" "," ");e.className=(i+(s?" "+t:"")).replace(T," ")}}function M(e,t,s){var i=e&&e.style;if(i){if(void 0===s)return document.defaultView&&document.defaultView.getComputedStyle?s=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(s=e.currentStyle),void 0===t?s:s[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=s+("string"===typeof s?"":"px")}}function O(e,t){var s="";if("string"===typeof e)s=e;else do{var i=M(e,"transform");i&&"none"!==i&&(s=i+" "+s)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(s)}function I(e,t,s){if(e){var i=e.getElementsByTagName(t),a=0,r=i.length;if(s)for(;a<r;a++)s(i[a],a);return i}return[]}function F(){var e=document.scrollingElement;return e||document.documentElement}function j(e,t,s,i,a){if(e.getBoundingClientRect||e===window){var r,n,o,l,c,u,h;if(e!==window&&e!==F()?(r=e.getBoundingClientRect(),n=r.top,o=r.left,l=r.bottom,c=r.right,u=r.height,h=r.width):(n=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(t||s)&&e!==window&&(a=a||e.parentNode,!m))do{if(a&&a.getBoundingClientRect&&("none"!==M(a,"transform")||s&&"static"!==M(a,"position"))){var d=a.getBoundingClientRect();n-=d.top+parseInt(M(a,"border-top-width")),o-=d.left+parseInt(M(a,"border-left-width")),l=n+r.height,c=o+r.width;break}}while(a=a.parentNode);if(i&&e!==window){var p=O(a||e),f=p&&p.a,g=p&&p.d;p&&(n/=g,o/=f,h/=f,u/=g,l=n+u,c=o+h)}return{top:n,left:o,bottom:l,right:c,width:h,height:u}}}function B(e,t,s){var i=V(e,!0),a=j(e)[t];while(i){var r=j(i)[s],n=void 0;if(n="top"===s||"left"===s?a>=r:a<=r,!n)return i;if(i===F())break;i=V(i,!1)}return!1}function $(e,t,s){var i=0,a=0,r=e.children;while(a<r.length){if("none"!==r[a].style.display&&r[a]!==Ze.ghost&&r[a]!==Ze.dragged&&k(r[a],s.draggable,e,!1)){if(i===t)return r[a];i++}a++}return null}function R(e,t){var s=e.lastElementChild;while(s&&(s===Ze.ghost||"none"===M(s,"display")||t&&!E(s,t)))s=s.previousElementSibling;return s||null}function A(e,t){var s=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ze.clone||t&&!E(e,t)||s++;return s}function N(e){var t=0,s=0,i=F();if(e)do{var a=O(e),r=a.a,n=a.d;t+=e.scrollLeft*r,s+=e.scrollTop*n}while(e!==i&&(e=e.parentNode));return[t,s]}function L(e,t){for(var s in e)if(e.hasOwnProperty(s))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[s][i])return Number(s);return-1}function V(e,t){if(!e||!e.getBoundingClientRect)return F();var s=e,i=!1;do{if(s.clientWidth<s.scrollWidth||s.clientHeight<s.scrollHeight){var a=M(s);if(s.clientWidth<s.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||s.clientHeight<s.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!s.getBoundingClientRect||s===document.body)return F();if(i||t)return s;i=!0}}}while(s=s.parentNode);return F()}function U(e,t){if(e&&t)for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e}function J(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function z(e,t){return function(){if(!P){var s=arguments,i=this;1===s.length?e.call(i,s[0]):e.apply(i,s),P=setTimeout((function(){P=void 0}),t)}}}function X(){clearTimeout(P),P=void 0}function Y(e,t,s){e.scrollLeft+=t,e.scrollTop+=s}function H(e){var t=window.Polymer,s=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):s?s(e).clone(!0)[0]:e.cloneNode(!0)}function G(e,t){M(e,"position","absolute"),M(e,"top",t.top),M(e,"left",t.left),M(e,"width",t.width),M(e,"height",t.height)}function q(e){M(e,"position",""),M(e,"top",""),M(e,"left",""),M(e,"width",""),M(e,"height","")}var W="Sortable"+(new Date).getTime();function K(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==M(e,"display")&&e!==Ze.ghost){t.push({target:e,rect:j(e)});var s=n({},t[t.length-1].rect);if(e.thisAnimationDuration){var i=O(e,!0);i&&(s.top-=i.f,s.left-=i.e)}e.fromRect=s}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(L(t,{target:e}),1)},animateAll:function(s){var i=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof s&&s());var a=!1,r=0;t.forEach((function(e){var t=0,s=e.target,n=s.fromRect,o=j(s),l=s.prevFromRect,c=s.prevToRect,u=e.rect,h=O(s,!0);h&&(o.top-=h.f,o.left-=h.e),s.toRect=o,s.thisAnimationDuration&&J(l,o)&&!J(n,o)&&(u.top-o.top)/(u.left-o.left)===(n.top-o.top)/(n.left-o.left)&&(t=Q(u,l,c,i.options)),J(o,n)||(s.prevFromRect=n,s.prevToRect=o,t||(t=i.options.animation),i.animate(s,u,o,t)),t&&(a=!0,r=Math.max(r,t),clearTimeout(s.animationResetTimer),s.animationResetTimer=setTimeout((function(){s.animationTime=0,s.prevFromRect=null,s.fromRect=null,s.prevToRect=null,s.thisAnimationDuration=null}),t),s.thisAnimationDuration=t)})),clearTimeout(e),a?e=setTimeout((function(){"function"===typeof s&&s()}),r):"function"===typeof s&&s(),t=[]},animate:function(e,t,s,i){if(i){M(e,"transition",""),M(e,"transform","");var a=O(this.el),r=a&&a.a,n=a&&a.d,o=(t.left-s.left)/(r||1),l=(t.top-s.top)/(n||1);e.animatingX=!!o,e.animatingY=!!l,M(e,"transform","translate3d("+o+"px,"+l+"px,0)"),Z(e),M(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),M(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){M(e,"transition",""),M(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}}function Z(e){return e.offsetWidth}function Q(e,t,s,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-s.top,2)+Math.pow(t.left-s.left,2))*i.animation}var ee=[],te={initializeByDefault:!0},se={mount:function(e){for(var t in te)te.hasOwnProperty(t)&&!(t in e)&&(e[t]=te[t]);ee.push(e)},pluginEvent:function(e,t,s){var i=this;this.eventCanceled=!1,s.cancel=function(){i.eventCanceled=!0};var a=e+"Global";ee.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][a]&&t[i.pluginName][a](n({sortable:t},s)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](n({sortable:t},s)))}))},initializePlugins:function(e,t,s,i){for(var a in ee.forEach((function(i){var a=i.pluginName;if(e.options[a]||i.initializeByDefault){var n=new i(e,t,e.options);n.sortable=e,n.options=e.options,e[a]=n,r(s,n.defaults)}})),e.options)if(e.options.hasOwnProperty(a)){var n=this.modifyOption(e,a,e.options[a]);"undefined"!==typeof n&&(e.options[a]=n)}},getEventProperties:function(e,t){var s={};return ee.forEach((function(i){"function"===typeof i.eventProperties&&r(s,i.eventProperties.call(t[i.pluginName],e))})),s},modifyOption:function(e,t,s){var i;return ee.forEach((function(a){e[a.pluginName]&&a.optionListeners&&"function"===typeof a.optionListeners[t]&&(i=a.optionListeners[t].call(e[a.pluginName],s))})),i}};function ie(e){var t=e.sortable,s=e.rootEl,i=e.name,a=e.targetEl,r=e.cloneEl,o=e.toEl,l=e.fromEl,c=e.oldIndex,u=e.newIndex,h=e.oldDraggableIndex,d=e.newDraggableIndex,p=e.originalEvent,f=e.putSortable,v=e.extraEventProperties;if(t=t||s&&s[W],t){var b,y=t.options,w="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||m||g?(b=document.createEvent("Event"),b.initEvent(i,!0,!0)):b=new CustomEvent(i,{bubbles:!0,cancelable:!0}),b.to=o||s,b.from=l||s,b.item=a||s,b.clone=r,b.oldIndex=c,b.newIndex=u,b.oldDraggableIndex=h,b.newDraggableIndex=d,b.originalEvent=p,b.pullMode=f?f.lastPutMode:void 0;var x=n({},v,se.getEventProperties(i,t));for(var S in x)b[S]=x[S];s&&s.dispatchEvent(b),y[w]&&y[w].call(t,b)}}var ae=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.evt,a=l(s,["evt"]);se.pluginEvent.bind(Ze)(e,t,n({dragEl:ne,parentEl:oe,ghostEl:le,rootEl:ce,nextEl:ue,lastDownEl:he,cloneEl:de,cloneHidden:pe,dragStarted:ke,putSortable:ye,activeSortable:Ze.active,originalEvent:i,oldIndex:fe,oldDraggableIndex:ge,newIndex:me,newDraggableIndex:ve,hideGhostForTarget:Ge,unhideGhostForTarget:qe,cloneNowHidden:function(){pe=!0},cloneNowShown:function(){pe=!1},dispatchSortableEvent:function(e){re({sortable:t,name:e,originalEvent:i})}},a))};function re(e){ie(n({putSortable:ye,cloneEl:de,targetEl:ne,rootEl:ce,oldIndex:fe,oldDraggableIndex:ge,newIndex:me,newDraggableIndex:ve},e))}var ne,oe,le,ce,ue,he,de,pe,fe,me,ge,ve,be,ye,we,xe,Se,Ce,Ee,_e,ke,Pe,Te,De,Me,Oe=!1,Ie=!1,Fe=[],je=!1,Be=!1,$e=[],Re=!1,Ae=[],Ne="undefined"!==typeof document,Le=y,Ve=g||m?"cssFloat":"float",Ue=Ne&&!w&&!y&&"draggable"in document.createElement("div"),Je=function(){if(Ne){if(m)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),ze=function(e,t){var s=M(e),i=parseInt(s.width)-parseInt(s.paddingLeft)-parseInt(s.paddingRight)-parseInt(s.borderLeftWidth)-parseInt(s.borderRightWidth),a=$(e,0,t),r=$(e,1,t),n=a&&M(a),o=r&&M(r),l=n&&parseInt(n.marginLeft)+parseInt(n.marginRight)+j(a).width,c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+j(r).width;if("flex"===s.display)return"column"===s.flexDirection||"column-reverse"===s.flexDirection?"vertical":"horizontal";if("grid"===s.display)return s.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&n["float"]&&"none"!==n["float"]){var u="left"===n["float"]?"left":"right";return!r||"both"!==o.clear&&o.clear!==u?"horizontal":"vertical"}return a&&("block"===n.display||"flex"===n.display||"table"===n.display||"grid"===n.display||l>=i&&"none"===s[Ve]||r&&"none"===s[Ve]&&l+c>i)?"vertical":"horizontal"},Xe=function(e,t,s){var i=s?e.left:e.top,a=s?e.right:e.bottom,r=s?e.width:e.height,n=s?t.left:t.top,o=s?t.right:t.bottom,l=s?t.width:t.height;return i===n||a===o||i+r/2===n+l/2},Ye=function(e,t){var s;return Fe.some((function(i){if(!R(i)){var a=j(i),r=i[W].options.emptyInsertThreshold,n=e>=a.left-r&&e<=a.right+r,o=t>=a.top-r&&t<=a.bottom+r;return r&&n&&o?s=i:void 0}})),s},He=function(e){function t(e,s){return function(i,a,r,n){var o=i.options.group.name&&a.options.group.name&&i.options.group.name===a.options.group.name;if(null==e&&(s||o))return!0;if(null==e||!1===e)return!1;if(s&&"clone"===e)return e;if("function"===typeof e)return t(e(i,a,r,n),s)(i,a,r,n);var l=(s?i:a).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var s={},a=e.group;a&&"object"==i(a)||(a={name:a}),s.name=a.name,s.checkPull=t(a.pull,!0),s.checkPut=t(a.put),s.revertClone=a.revertClone,e.group=s},Ge=function(){!Je&&le&&M(le,"display","none")},qe=function(){!Je&&le&&M(le,"display","")};Ne&&document.addEventListener("click",(function(e){if(Ie)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ie=!1,!1}),!0);var We=function(e){if(ne){e=e.touches?e.touches[0]:e;var t=Ye(e.clientX,e.clientY);if(t){var s={};for(var i in e)e.hasOwnProperty(i)&&(s[i]=e[i]);s.target=s.rootEl=t,s.preventDefault=void 0,s.stopPropagation=void 0,t[W]._onDragOver(s)}}},Ke=function(e){ne&&ne.parentNode[W]._isOutsideThisEl(e.target)};function Ze(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=r({},t),e[W]=this;var s={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ze(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ze.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var i in se.initializePlugins(this,e,s),s)!(i in t)&&(t[i]=s[i]);for(var a in He(t),this)"_"===a.charAt(0)&&"function"===typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&Ue,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?S(e,"pointerdown",this._onTapStart):(S(e,"mousedown",this._onTapStart),S(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(S(e,"dragover",this),S(e,"dragenter",this)),Fe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),r(this,K())}function Qe(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function et(e,t,s,i,a,r,n,o){var l,c,u=e[W],h=u.options.onMove;return!window.CustomEvent||m||g?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=s,l.draggedRect=i,l.related=a||t,l.relatedRect=r||j(t),l.willInsertAfter=o,l.originalEvent=n,e.dispatchEvent(l),h&&(c=h.call(u,l,n)),c}function tt(e){e.draggable=!1}function st(){Re=!1}function it(e,t,s){var i=j(R(s.el,s.options.draggable)),a=10;return t?e.clientX>i.right+a||e.clientX<=i.right&&e.clientY>i.bottom&&e.clientX>=i.left:e.clientX>i.right&&e.clientY>i.top||e.clientX<=i.right&&e.clientY>i.bottom+a}function at(e,t,s,i,a,r,n,o){var l=i?e.clientY:e.clientX,c=i?s.height:s.width,u=i?s.top:s.left,h=i?s.bottom:s.right,d=!1;if(!n)if(o&&De<c*a){if(!je&&(1===Te?l>u+c*r/2:l<h-c*r/2)&&(je=!0),je)d=!0;else if(1===Te?l<u+De:l>h-De)return-Te}else if(l>u+c*(1-a)/2&&l<h-c*(1-a)/2)return rt(t);return d=d||n,d&&(l<u+c*r/2||l>h-c*r/2)?l>u+c/2?1:-1:0}function rt(e){return A(ne)<A(e)?1:-1}function nt(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,s=t.length,i=0;while(s--)i+=t.charCodeAt(s);return i.toString(36)}function ot(e){Ae.length=0;var t=e.getElementsByTagName("input"),s=t.length;while(s--){var i=t[s];i.checked&&Ae.push(i)}}function lt(e){return setTimeout(e,0)}function ct(e){return clearTimeout(e)}Ze.prototype={constructor:Ze,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Pe=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,ne):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,s=this.el,i=this.options,a=i.preventOnFilter,r=e.type,n=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,o=(n||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||o,c=i.filter;if(ot(s),!ne&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||i.disabled)&&!l.isContentEditable&&(o=k(o,i.draggable,s,!1),(!o||!o.animated)&&he!==o)){if(fe=A(o),ge=A(o,i.draggable),"function"===typeof c){if(c.call(this,e,o,this))return re({sortable:t,rootEl:l,name:"filter",targetEl:o,toEl:s,fromEl:s}),ae("filter",t,{evt:e}),void(a&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=k(l,i.trim(),s,!1),i)return re({sortable:t,rootEl:i,name:"filter",targetEl:o,fromEl:s,toEl:s}),ae("filter",t,{evt:e}),!0})),c))return void(a&&e.cancelable&&e.preventDefault());i.handle&&!k(l,i.handle,s,!1)||this._prepareDragStart(e,n,o)}}},_prepareDragStart:function(e,t,s){var i,a=this,r=a.el,n=a.options,o=r.ownerDocument;if(s&&!ne&&s.parentNode===r){var l=j(s);if(ce=r,ne=s,oe=ne.parentNode,ue=ne.nextSibling,he=s,be=n.group,Ze.dragged=ne,we={target:ne,clientX:(t||e).clientX,clientY:(t||e).clientY},Ee=we.clientX-l.left,_e=we.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ne.style["will-change"]="all",i=function(){ae("delayEnded",a,{evt:e}),Ze.eventCanceled?a._onDrop():(a._disableDelayedDragEvents(),!v&&a.nativeDraggable&&(ne.draggable=!0),a._triggerDragStart(e,t),re({sortable:a,name:"choose",originalEvent:e}),D(ne,n.chosenClass,!0))},n.ignore.split(",").forEach((function(e){I(ne,e.trim(),tt)})),S(o,"dragover",We),S(o,"mousemove",We),S(o,"touchmove",We),S(o,"mouseup",a._onDrop),S(o,"touchend",a._onDrop),S(o,"touchcancel",a._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ne.draggable=!0),ae("delayStart",this,{evt:e}),!n.delay||n.delayOnTouchOnly&&!t||this.nativeDraggable&&(g||m))i();else{if(Ze.eventCanceled)return void this._onDrop();S(o,"mouseup",a._disableDelayedDrag),S(o,"touchend",a._disableDelayedDrag),S(o,"touchcancel",a._disableDelayedDrag),S(o,"mousemove",a._delayedDragTouchMoveHandler),S(o,"touchmove",a._delayedDragTouchMoveHandler),n.supportPointer&&S(o,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(i,n.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ne&&tt(ne),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;C(e,"mouseup",this._disableDelayedDrag),C(e,"touchend",this._disableDelayedDrag),C(e,"touchcancel",this._disableDelayedDrag),C(e,"mousemove",this._delayedDragTouchMoveHandler),C(e,"touchmove",this._delayedDragTouchMoveHandler),C(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?S(document,"pointermove",this._onTouchMove):S(document,t?"touchmove":"mousemove",this._onTouchMove):(S(ne,"dragend",this),S(ce,"dragstart",this._onDragStart));try{document.selection?lt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(s){}},_dragStarted:function(e,t){if(Oe=!1,ce&&ne){ae("dragStarted",this,{evt:t}),this.nativeDraggable&&S(document,"dragover",Ke);var s=this.options;!e&&D(ne,s.dragClass,!1),D(ne,s.ghostClass,!0),Ze.active=this,e&&this._appendGhost(),re({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(xe){this._lastX=xe.clientX,this._lastY=xe.clientY,Ge();var e=document.elementFromPoint(xe.clientX,xe.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(xe.clientX,xe.clientY),e===t)break;t=e}if(ne.parentNode[W]._isOutsideThisEl(e),t)do{if(t[W]){var s=void 0;if(s=t[W]._onDragOver({clientX:xe.clientX,clientY:xe.clientY,target:e,rootEl:t}),s&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);qe()}},_onTouchMove:function(e){if(we){var t=this.options,s=t.fallbackTolerance,i=t.fallbackOffset,a=e.touches?e.touches[0]:e,r=le&&O(le,!0),n=le&&r&&r.a,o=le&&r&&r.d,l=Le&&Me&&N(Me),c=(a.clientX-we.clientX+i.x)/(n||1)+(l?l[0]-$e[0]:0)/(n||1),u=(a.clientY-we.clientY+i.y)/(o||1)+(l?l[1]-$e[1]:0)/(o||1);if(!Ze.active&&!Oe){if(s&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<s)return;this._onDragStart(e,!0)}if(le){r?(r.e+=c-(Se||0),r.f+=u-(Ce||0)):r={a:1,b:0,c:0,d:1,e:c,f:u};var h="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");M(le,"webkitTransform",h),M(le,"mozTransform",h),M(le,"msTransform",h),M(le,"transform",h),Se=c,Ce=u,xe=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!le){var e=this.options.fallbackOnBody?document.body:ce,t=j(ne,!0,Le,!0,e),s=this.options;if(Le){Me=e;while("static"===M(Me,"position")&&"none"===M(Me,"transform")&&Me!==document)Me=Me.parentNode;Me!==document.body&&Me!==document.documentElement?(Me===document&&(Me=F()),t.top+=Me.scrollTop,t.left+=Me.scrollLeft):Me=F(),$e=N(Me)}le=ne.cloneNode(!0),D(le,s.ghostClass,!1),D(le,s.fallbackClass,!0),D(le,s.dragClass,!0),M(le,"transition",""),M(le,"transform",""),M(le,"box-sizing","border-box"),M(le,"margin",0),M(le,"top",t.top),M(le,"left",t.left),M(le,"width",t.width),M(le,"height",t.height),M(le,"opacity","0.8"),M(le,"position",Le?"absolute":"fixed"),M(le,"zIndex","100000"),M(le,"pointerEvents","none"),Ze.ghost=le,e.appendChild(le),M(le,"transform-origin",Ee/parseInt(le.style.width)*100+"% "+_e/parseInt(le.style.height)*100+"%")}},_onDragStart:function(e,t){var s=this,i=e.dataTransfer,a=s.options;ae("dragStart",this,{evt:e}),Ze.eventCanceled?this._onDrop():(ae("setupClone",this),Ze.eventCanceled||(de=H(ne),de.draggable=!1,de.style["will-change"]="",this._hideClone(),D(de,this.options.chosenClass,!1),Ze.clone=de),s.cloneId=lt((function(){ae("clone",s),Ze.eventCanceled||(s.options.removeCloneOnHide||ce.insertBefore(de,ne),s._hideClone(),re({sortable:s,name:"clone"}))})),!t&&D(ne,a.dragClass,!0),t?(Ie=!0,s._loopId=setInterval(s._emulateDragOver,50)):(C(document,"mouseup",s._onDrop),C(document,"touchend",s._onDrop),C(document,"touchcancel",s._onDrop),i&&(i.effectAllowed="move",a.setData&&a.setData.call(s,i,ne)),S(document,"drop",s),M(ne,"transform","translateZ(0)")),Oe=!0,s._dragStartId=lt(s._dragStarted.bind(s,t,e)),S(document,"selectstart",s),ke=!0,b&&M(document.body,"user-select","none"))},_onDragOver:function(e){var t,s,i,a,r=this.el,o=e.target,l=this.options,c=l.group,u=Ze.active,h=be===c,d=l.sort,p=ye||u,f=this,m=!1;if(!Re){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=k(o,l.draggable,r,!0),I("dragOver"),Ze.eventCanceled)return m;if(ne.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||f._ignoreWhileAnimating===o)return $(!1);if(Ie=!1,u&&!l.disabled&&(h?d||(i=!ce.contains(ne)):ye===this||(this.lastPutMode=be.checkPull(this,u,ne,e))&&c.checkPut(this,u,ne,e))){if(a="vertical"===this._getDirection(e,o),t=j(ne),I("dragOverValid"),Ze.eventCanceled)return m;if(i)return oe=ce,F(),this._hideClone(),I("revert"),Ze.eventCanceled||(ue?ce.insertBefore(ne,ue):ce.appendChild(ne)),$(!0);var g=R(r,l.draggable);if(!g||it(e,a,this)&&!g.animated){if(g===ne)return $(!1);if(g&&r===e.target&&(o=g),o&&(s=j(o)),!1!==et(ce,r,ne,t,o,s,e,!!o))return F(),r.appendChild(ne),oe=r,N(),$(!0)}else if(o.parentNode===r){s=j(o);var v,b,y=0,w=ne.parentNode!==r,x=!Xe(ne.animated&&ne.toRect||t,o.animated&&o.toRect||s,a),S=a?"top":"left",C=B(o,"top","top")||B(ne,"top","top"),E=C?C.scrollTop:void 0;if(Pe!==o&&(v=s[S],je=!1,Be=!x&&l.invertSwap||w),y=at(e,o,s,a,x?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Be,Pe===o),0!==y){var _=A(ne);do{_-=y,b=oe.children[_]}while(b&&("none"===M(b,"display")||b===le))}if(0===y||b===o)return $(!1);Pe=o,Te=y;var P=o.nextElementSibling,T=!1;T=1===y;var O=et(ce,r,ne,t,o,s,e,T);if(!1!==O)return 1!==O&&-1!==O||(T=1===O),Re=!0,setTimeout(st,30),F(),T&&!P?r.appendChild(ne):o.parentNode.insertBefore(ne,T?P:o),C&&Y(C,0,E-C.scrollTop),oe=ne.parentNode,void 0===v||Be||(De=Math.abs(v-j(o)[S])),N(),$(!0)}if(r.contains(ne))return $(!1)}return!1}function I(l,c){ae(l,f,n({evt:e,isOwner:h,axis:a?"vertical":"horizontal",revert:i,dragRect:t,targetRect:s,canSort:d,fromSortable:p,target:o,completed:$,onMove:function(s,i){return et(ce,r,ne,t,s,j(s),e,i)},changed:N},c))}function F(){I("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function $(t){return I("dragOverCompleted",{insertion:t}),t&&(h?u._hideClone():u._showClone(f),f!==p&&(D(ne,ye?ye.options.ghostClass:u.options.ghostClass,!1),D(ne,l.ghostClass,!0)),ye!==f&&f!==Ze.active?ye=f:f===Ze.active&&ye&&(ye=null),p===f&&(f._ignoreWhileAnimating=o),f.animateAll((function(){I("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(o===ne&&!ne.animated||o===r&&!o.animated)&&(Pe=null),l.dragoverBubble||e.rootEl||o===document||(ne.parentNode[W]._isOutsideThisEl(e.target),!t&&We(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function N(){me=A(ne),ve=A(ne,l.draggable),re({sortable:f,name:"change",toEl:r,newIndex:me,newDraggableIndex:ve,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){C(document,"mousemove",this._onTouchMove),C(document,"touchmove",this._onTouchMove),C(document,"pointermove",this._onTouchMove),C(document,"dragover",We),C(document,"mousemove",We),C(document,"touchmove",We)},_offUpEvents:function(){var e=this.el.ownerDocument;C(e,"mouseup",this._onDrop),C(e,"touchend",this._onDrop),C(e,"pointerup",this._onDrop),C(e,"touchcancel",this._onDrop),C(document,"selectstart",this)},_onDrop:function(e){var t=this.el,s=this.options;me=A(ne),ve=A(ne,s.draggable),ae("drop",this,{evt:e}),oe=ne&&ne.parentNode,me=A(ne),ve=A(ne,s.draggable),Ze.eventCanceled||(Oe=!1,Be=!1,je=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ct(this.cloneId),ct(this._dragStartId),this.nativeDraggable&&(C(document,"drop",this),C(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),b&&M(document.body,"user-select",""),M(ne,"transform",""),e&&(ke&&(e.cancelable&&e.preventDefault(),!s.dropBubble&&e.stopPropagation()),le&&le.parentNode&&le.parentNode.removeChild(le),(ce===oe||ye&&"clone"!==ye.lastPutMode)&&de&&de.parentNode&&de.parentNode.removeChild(de),ne&&(this.nativeDraggable&&C(ne,"dragend",this),tt(ne),ne.style["will-change"]="",ke&&!Oe&&D(ne,ye?ye.options.ghostClass:this.options.ghostClass,!1),D(ne,this.options.chosenClass,!1),re({sortable:this,name:"unchoose",toEl:oe,newIndex:null,newDraggableIndex:null,originalEvent:e}),ce!==oe?(me>=0&&(re({rootEl:oe,name:"add",toEl:oe,fromEl:ce,originalEvent:e}),re({sortable:this,name:"remove",toEl:oe,originalEvent:e}),re({rootEl:oe,name:"sort",toEl:oe,fromEl:ce,originalEvent:e}),re({sortable:this,name:"sort",toEl:oe,originalEvent:e})),ye&&ye.save()):me!==fe&&me>=0&&(re({sortable:this,name:"update",toEl:oe,originalEvent:e}),re({sortable:this,name:"sort",toEl:oe,originalEvent:e})),Ze.active&&(null!=me&&-1!==me||(me=fe,ve=ge),re({sortable:this,name:"end",toEl:oe,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){ae("nulling",this),ce=ne=oe=le=ue=de=he=pe=we=xe=ke=me=ve=fe=ge=Pe=Te=ye=be=Ze.dragged=Ze.ghost=Ze.clone=Ze.active=null,Ae.forEach((function(e){e.checked=!0})),Ae.length=Se=Ce=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ne&&(this._onDragOver(e),Qe(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],s=this.el.children,i=0,a=s.length,r=this.options;i<a;i++)e=s[i],k(e,r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||nt(e));return t},sort:function(e){var t={},s=this.el;this.toArray().forEach((function(e,i){var a=s.children[i];k(a,this.options.draggable,s,!1)&&(t[e]=a)}),this),e.forEach((function(e){t[e]&&(s.removeChild(t[e]),s.appendChild(t[e]))}))},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return k(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var s=this.options;if(void 0===t)return s[e];var i=se.modifyOption(this,e,t);s[e]="undefined"!==typeof i?i:t,"group"===e&&He(s)},destroy:function(){ae("destroy",this);var e=this.el;e[W]=null,C(e,"mousedown",this._onTapStart),C(e,"touchstart",this._onTapStart),C(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(C(e,"dragover",this),C(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Fe.splice(Fe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!pe){if(ae("hideClone",this),Ze.eventCanceled)return;M(de,"display","none"),this.options.removeCloneOnHide&&de.parentNode&&de.parentNode.removeChild(de),pe=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(pe){if(ae("showClone",this),Ze.eventCanceled)return;ce.contains(ne)&&!this.options.group.revertClone?ce.insertBefore(de,ne):ue?ce.insertBefore(de,ue):ce.appendChild(de),this.options.group.revertClone&&this.animate(ne,de),M(de,"display",""),pe=!1}}else this._hideClone()}},Ne&&S(document,"touchmove",(function(e){(Ze.active||Oe)&&e.cancelable&&e.preventDefault()})),Ze.utils={on:S,off:C,css:M,find:I,is:function(e,t){return!!k(e,t,e,!1)},extend:U,throttle:z,closest:k,toggleClass:D,clone:H,index:A,nextTick:lt,cancelNextTick:ct,detectDirection:ze,getChild:$},Ze.get=function(e){return e[W]},Ze.mount=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ze.utils=n({},Ze.utils,e.utils)),se.mount(e)}))},Ze.create=function(e,t){return new Ze(e,t)},Ze.version=p;var ut,ht,dt,pt,ft,mt,gt=[],vt=!1;function bt(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?S(document,"dragover",this._handleAutoScroll):this.options.supportPointer?S(document,"pointermove",this._handleFallbackAutoScroll):t.touches?S(document,"touchmove",this._handleFallbackAutoScroll):S(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?C(document,"dragover",this._handleAutoScroll):(C(document,"pointermove",this._handleFallbackAutoScroll),C(document,"touchmove",this._handleFallbackAutoScroll),C(document,"mousemove",this._handleFallbackAutoScroll)),wt(),yt(),X()},nulling:function(){ft=ht=ut=vt=mt=dt=pt=null,gt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var s=this,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(i,a);if(ft=e,t||g||m||b){St(e,this.options,r,t);var n=V(r,!0);!vt||mt&&i===dt&&a===pt||(mt&&wt(),mt=setInterval((function(){var r=V(document.elementFromPoint(i,a),!0);r!==n&&(n=r,yt()),St(e,s.options,r,t)}),10),dt=i,pt=a)}else{if(!this.options.bubbleScroll||V(r,!0)===F())return void yt();St(e,this.options,V(r,!1),!1)}}},r(e,{pluginName:"scroll",initializeByDefault:!0})}function yt(){gt.forEach((function(e){clearInterval(e.pid)})),gt=[]}function wt(){clearInterval(mt)}var xt,St=z((function(e,t,s,i){if(t.scroll){var a,r=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,o=t.scrollSensitivity,l=t.scrollSpeed,c=F(),u=!1;ht!==s&&(ht=s,yt(),ut=t.scroll,a=t.scrollFn,!0===ut&&(ut=V(s,!0)));var h=0,d=ut;do{var p=d,f=j(p),m=f.top,g=f.bottom,v=f.left,b=f.right,y=f.width,w=f.height,x=void 0,S=void 0,C=p.scrollWidth,E=p.scrollHeight,_=M(p),k=p.scrollLeft,P=p.scrollTop;p===c?(x=y<C&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),S=w<E&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(x=y<C&&("auto"===_.overflowX||"scroll"===_.overflowX),S=w<E&&("auto"===_.overflowY||"scroll"===_.overflowY));var T=x&&(Math.abs(b-r)<=o&&k+y<C)-(Math.abs(v-r)<=o&&!!k),D=S&&(Math.abs(g-n)<=o&&P+w<E)-(Math.abs(m-n)<=o&&!!P);if(!gt[h])for(var O=0;O<=h;O++)gt[O]||(gt[O]={});gt[h].vx==T&&gt[h].vy==D&&gt[h].el===p||(gt[h].el=p,gt[h].vx=T,gt[h].vy=D,clearInterval(gt[h].pid),0==T&&0==D||(u=!0,gt[h].pid=setInterval(function(){i&&0===this.layer&&Ze.active._onTouchMove(ft);var t=gt[this.layer].vy?gt[this.layer].vy*l:0,s=gt[this.layer].vx?gt[this.layer].vx*l:0;"function"===typeof a&&"continue"!==a.call(Ze.dragged.parentNode[W],s,t,e,ft,gt[this.layer].el)||Y(gt[this.layer].el,s,t)}.bind({layer:h}),24))),h++}while(t.bubbleScroll&&d!==c&&(d=V(d,!1)));vt=u}}),30),Ct=function(e){var t=e.originalEvent,s=e.putSortable,i=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,n=e.hideGhostForTarget,o=e.unhideGhostForTarget;if(t){var l=s||a;n();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);o(),l&&!l.el.contains(u)&&(r("spill"),this.onSpill({dragEl:i,putSortable:s}))}};function Et(){}function _t(){}function kt(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;xt=t},dragOverValid:function(e){var t=e.completed,s=e.target,i=e.onMove,a=e.activeSortable,r=e.changed,n=e.cancel;if(a.options.swap){var o=this.sortable.el,l=this.options;if(s&&s!==o){var c=xt;!1!==i(s)?(D(s,l.swapClass,!0),xt=s):xt=null,c&&c!==xt&&D(c,l.swapClass,!1)}r(),t(!0),n()}},drop:function(e){var t=e.activeSortable,s=e.putSortable,i=e.dragEl,a=s||this.sortable,r=this.options;xt&&D(xt,r.swapClass,!1),xt&&(r.swap||s&&s.options.swap)&&i!==xt&&(a.captureAnimationState(),a!==t&&t.captureAnimationState(),Pt(i,xt),a.animateAll(),a!==t&&t.animateAll())},nulling:function(){xt=null}},r(e,{pluginName:"swap",eventProperties:function(){return{swapItem:xt}}})}function Pt(e,t){var s,i,a=e.parentNode,r=t.parentNode;a&&r&&!a.isEqualNode(t)&&!r.isEqualNode(e)&&(s=A(e),i=A(t),a.isEqualNode(r)&&s<i&&i++,a.insertBefore(t,a.children[s]),r.insertBefore(e,r.children[i]))}Et.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,s=e.putSortable;this.sortable.captureAnimationState(),s&&s.captureAnimationState();var i=$(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),s&&s.animateAll()},drop:Ct},r(Et,{pluginName:"revertOnSpill"}),_t.prototype={onSpill:function(e){var t=e.dragEl,s=e.putSortable,i=s||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Ct},r(_t,{pluginName:"removeOnSpill"});var Tt,Dt,Mt,Ot,It,Ft=[],jt=[],Bt=!1,$t=!1,Rt=!1;function At(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this));e.options.supportPointer?S(document,"pointerup",this._deselectMultiDrag):(S(document,"mouseup",this._deselectMultiDrag),S(document,"touchend",this._deselectMultiDrag)),S(document,"keydown",this._checkKeyDown),S(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,s){var i="";Ft.length&&Dt===e?Ft.forEach((function(e,t){i+=(t?", ":"")+e.textContent})):i=s.textContent,t.setData("Text",i)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;Mt=t},delayEnded:function(){this.isMultiDrag=~Ft.indexOf(Mt)},setupClone:function(e){var t=e.sortable,s=e.cancel;if(this.isMultiDrag){for(var i=0;i<Ft.length;i++)jt.push(H(Ft[i])),jt[i].sortableIndex=Ft[i].sortableIndex,jt[i].draggable=!1,jt[i].style["will-change"]="",D(jt[i],this.options.selectedClass,!1),Ft[i]===Mt&&D(jt[i],this.options.chosenClass,!1);t._hideClone(),s()}},clone:function(e){var t=e.sortable,s=e.rootEl,i=e.dispatchSortableEvent,a=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Ft.length&&Dt===t&&(Lt(!0,s),i("clone"),a()))},showClone:function(e){var t=e.cloneNowShown,s=e.rootEl,i=e.cancel;this.isMultiDrag&&(Lt(!1,s),jt.forEach((function(e){M(e,"display","")})),t(),It=!1,i())},hideClone:function(e){var t=this,s=(e.sortable,e.cloneNowHidden),i=e.cancel;this.isMultiDrag&&(jt.forEach((function(e){M(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)})),s(),It=!0,i())},dragStartGlobal:function(e){e.sortable;!this.isMultiDrag&&Dt&&Dt.multiDrag._deselectMultiDrag(),Ft.forEach((function(e){e.sortableIndex=A(e)})),Ft=Ft.sort((function(e,t){return e.sortableIndex-t.sortableIndex})),Rt=!0},dragStarted:function(e){var t=this,s=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Ft.forEach((function(e){e!==Mt&&M(e,"position","absolute")}));var i=j(Mt,!1,!0,!0);Ft.forEach((function(e){e!==Mt&&G(e,i)})),$t=!0,Bt=!0}s.animateAll((function(){$t=!1,Bt=!1,t.options.animation&&Ft.forEach((function(e){q(e)})),t.options.sort&&Vt()}))}},dragOver:function(e){var t=e.target,s=e.completed,i=e.cancel;$t&&~Ft.indexOf(t)&&(s(!1),i())},revert:function(e){var t=e.fromSortable,s=e.rootEl,i=e.sortable,a=e.dragRect;Ft.length>1&&(Ft.forEach((function(e){i.addAnimationState({target:e,rect:$t?j(e):a}),q(e),e.fromRect=a,t.removeAnimationState(e)})),$t=!1,Nt(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(e){var t=e.sortable,s=e.isOwner,i=e.insertion,a=e.activeSortable,r=e.parentEl,n=e.putSortable,o=this.options;if(i){if(s&&a._hideClone(),Bt=!1,o.animation&&Ft.length>1&&($t||!s&&!a.options.sort&&!n)){var l=j(Mt,!1,!0,!0);Ft.forEach((function(e){e!==Mt&&(G(e,l),r.appendChild(e))})),$t=!0}if(!s)if($t||Vt(),Ft.length>1){var c=It;a._showClone(t),a.options.animation&&!It&&c&&jt.forEach((function(e){a.addAnimationState({target:e,rect:Ot}),e.fromRect=Ot,e.thisAnimationDuration=null}))}else a._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,s=e.isOwner,i=e.activeSortable;if(Ft.forEach((function(e){e.thisAnimationDuration=null})),i.options.animation&&!s&&i.multiDrag.isMultiDrag){Ot=r({},t);var a=O(Mt,!0);Ot.top-=a.f,Ot.left-=a.e}},dragOverAnimationComplete:function(){$t&&($t=!1,Vt())},drop:function(e){var t=e.originalEvent,s=e.rootEl,i=e.parentEl,a=e.sortable,r=e.dispatchSortableEvent,n=e.oldIndex,o=e.putSortable,l=o||this.sortable;if(t){var c=this.options,u=i.children;if(!Rt)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),D(Mt,c.selectedClass,!~Ft.indexOf(Mt)),~Ft.indexOf(Mt))Ft.splice(Ft.indexOf(Mt),1),Tt=null,ie({sortable:a,rootEl:s,name:"deselect",targetEl:Mt,originalEvt:t});else{if(Ft.push(Mt),ie({sortable:a,rootEl:s,name:"select",targetEl:Mt,originalEvt:t}),t.shiftKey&&Tt&&a.el.contains(Tt)){var h,d,p=A(Tt),f=A(Mt);if(~p&&~f&&p!==f)for(f>p?(d=p,h=f):(d=f,h=p+1);d<h;d++)~Ft.indexOf(u[d])||(D(u[d],c.selectedClass,!0),Ft.push(u[d]),ie({sortable:a,rootEl:s,name:"select",targetEl:u[d],originalEvt:t}))}else Tt=Mt;Dt=l}if(Rt&&this.isMultiDrag){if((i[W].options.sort||i!==s)&&Ft.length>1){var m=j(Mt),g=A(Mt,":not(."+this.options.selectedClass+")");if(!Bt&&c.animation&&(Mt.thisAnimationDuration=null),l.captureAnimationState(),!Bt&&(c.animation&&(Mt.fromRect=m,Ft.forEach((function(e){if(e.thisAnimationDuration=null,e!==Mt){var t=$t?j(e):m;e.fromRect=t,l.addAnimationState({target:e,rect:t})}}))),Vt(),Ft.forEach((function(e){u[g]?i.insertBefore(e,u[g]):i.appendChild(e),g++})),n===A(Mt))){var v=!1;Ft.forEach((function(e){e.sortableIndex===A(e)||(v=!0)})),v&&r("update")}Ft.forEach((function(e){q(e)})),l.animateAll()}Dt=l}(s===i||o&&"clone"!==o.lastPutMode)&&jt.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}},nullingGlobal:function(){this.isMultiDrag=Rt=!1,jt.length=0},destroyGlobal:function(){this._deselectMultiDrag(),C(document,"pointerup",this._deselectMultiDrag),C(document,"mouseup",this._deselectMultiDrag),C(document,"touchend",this._deselectMultiDrag),C(document,"keydown",this._checkKeyDown),C(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(("undefined"===typeof Rt||!Rt)&&Dt===this.sortable&&(!e||!k(e.target,this.options.draggable,this.sortable.el,!1))&&(!e||0===e.button))while(Ft.length){var t=Ft[0];D(t,this.options.selectedClass,!1),Ft.shift(),ie({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},r(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[W];t&&t.options.multiDrag&&!~Ft.indexOf(e)&&(Dt&&Dt!==t&&(Dt.multiDrag._deselectMultiDrag(),Dt=t),D(e,t.options.selectedClass,!0),Ft.push(e))},deselect:function(e){var t=e.parentNode[W],s=Ft.indexOf(e);t&&t.options.multiDrag&&~s&&(D(e,t.options.selectedClass,!1),Ft.splice(s,1))}},eventProperties:function(){var e=this,t=[],s=[];return Ft.forEach((function(i){var a;t.push({multiDragElement:i,index:i.sortableIndex}),a=$t&&i!==Mt?-1:$t?A(i,":not(."+e.options.selectedClass+")"):A(i),s.push({multiDragElement:i,index:a})})),{items:c(Ft),clones:[].concat(jt),oldIndicies:t,newIndicies:s}},optionListeners:{multiDragKey:function(e){return e=e.toLowerCase(),"ctrl"===e?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function Nt(e,t){Ft.forEach((function(s,i){var a=t.children[s.sortableIndex+(e?Number(i):0)];a?t.insertBefore(s,a):t.appendChild(s)}))}function Lt(e,t){jt.forEach((function(s,i){var a=t.children[s.sortableIndex+(e?Number(i):0)];a?t.insertBefore(s,a):t.appendChild(s)}))}function Vt(){Ft.forEach((function(e){e!==Mt&&e.parentNode&&e.parentNode.removeChild(e)}))}Ze.mount(new bt),Ze.mount(_t,Et),t["default"]=Ze},b0bb:function(e,t,s){"use strict";s("dbb6")},b16a:function(e,t,s){"use strict";s("25f7")},b5d7:function(e,t,s){"use strict";s("50e5")},b76a:function(e,t,s){(function(t,i){e.exports=i(s("aa47"))})("undefined"!==typeof self&&self,(function(e){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s="fb15")}({"01f9":function(e,t,s){"use strict";var i=s("2d00"),a=s("5ca1"),r=s("2aba"),n=s("32e9"),o=s("84f2"),l=s("41a0"),c=s("7f20"),u=s("38fd"),h=s("2b4c")("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",f="keys",m="values",g=function(){return this};e.exports=function(e,t,s,v,b,y,w){l(s,t,v);var x,S,C,E=function(e){if(!d&&e in T)return T[e];switch(e){case f:return function(){return new s(this,e)};case m:return function(){return new s(this,e)}}return function(){return new s(this,e)}},_=t+" Iterator",k=b==m,P=!1,T=e.prototype,D=T[h]||T[p]||b&&T[b],M=D||E(b),O=b?k?E("entries"):M:void 0,I="Array"==t&&T.entries||D;if(I&&(C=u(I.call(new e)),C!==Object.prototype&&C.next&&(c(C,_,!0),i||"function"==typeof C[h]||n(C,h,g))),k&&D&&D.name!==m&&(P=!0,M=function(){return D.call(this)}),i&&!w||!d&&!P&&T[h]||n(T,h,M),o[t]=M,o[_]=g,b)if(x={values:k?M:E(m),keys:y?M:E(f),entries:O},w)for(S in x)S in T||r(T,S,x[S]);else a(a.P+a.F*(d||P),t,x);return x}},"02f4":function(e,t,s){var i=s("4588"),a=s("be13");e.exports=function(e){return function(t,s){var r,n,o=String(a(t)),l=i(s),c=o.length;return l<0||l>=c?e?"":void 0:(r=o.charCodeAt(l),r<55296||r>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?e?o.charAt(l):r:e?o.slice(l,l+2):n-56320+(r-55296<<10)+65536)}}},"0390":function(e,t,s){"use strict";var i=s("02f4")(!0);e.exports=function(e,t,s){return t+(s?i(e,t).length:1)}},"0bfb":function(e,t,s){"use strict";var i=s("cb7c");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"0d58":function(e,t,s){var i=s("ce10"),a=s("e11e");e.exports=Object.keys||function(e){return i(e,a)}},1495:function(e,t,s){var i=s("86cc"),a=s("cb7c"),r=s("0d58");e.exports=s("9e1e")?Object.defineProperties:function(e,t){a(e);var s,n=r(t),o=n.length,l=0;while(o>l)i.f(e,s=n[l++],t[s]);return e}},"214f":function(e,t,s){"use strict";s("b0c5");var i=s("2aba"),a=s("32e9"),r=s("79e5"),n=s("be13"),o=s("2b4c"),l=s("520a"),c=o("species"),u=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),h=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var s="ab".split(e);return 2===s.length&&"a"===s[0]&&"b"===s[1]}();e.exports=function(e,t,s){var d=o(e),p=!r((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),f=p?!r((function(){var t=!1,s=/a/;return s.exec=function(){return t=!0,null},"split"===e&&(s.constructor={},s.constructor[c]=function(){return s}),s[d](""),!t})):void 0;if(!p||!f||"replace"===e&&!u||"split"===e&&!h){var m=/./[d],g=s(n,d,""[e],(function(e,t,s,i,a){return t.exec===l?p&&!a?{done:!0,value:m.call(t,s,i)}:{done:!0,value:e.call(s,t,i)}:{done:!1}})),v=g[0],b=g[1];i(String.prototype,e,v),a(RegExp.prototype,d,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"230e":function(e,t,s){var i=s("d3f4"),a=s("7726").document,r=i(a)&&i(a.createElement);e.exports=function(e){return r?a.createElement(e):{}}},"23c6":function(e,t,s){var i=s("2d95"),a=s("2b4c")("toStringTag"),r="Arguments"==i(function(){return arguments}()),n=function(e,t){try{return e[t]}catch(s){}};e.exports=function(e){var t,s,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=n(t=Object(e),a))?s:r?i(t):"Object"==(o=i(t))&&"function"==typeof t.callee?"Arguments":o}},2621:function(e,t){t.f=Object.getOwnPropertySymbols},"2aba":function(e,t,s){var i=s("7726"),a=s("32e9"),r=s("69a8"),n=s("ca5a")("src"),o=s("fa5b"),l="toString",c=(""+o).split(l);s("8378").inspectSource=function(e){return o.call(e)},(e.exports=function(e,t,s,o){var l="function"==typeof s;l&&(r(s,"name")||a(s,"name",t)),e[t]!==s&&(l&&(r(s,n)||a(s,n,e[t]?""+e[t]:c.join(String(t)))),e===i?e[t]=s:o?e[t]?e[t]=s:a(e,t,s):(delete e[t],a(e,t,s)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[n]||o.call(this)}))},"2aeb":function(e,t,s){var i=s("cb7c"),a=s("1495"),r=s("e11e"),n=s("613b")("IE_PROTO"),o=function(){},l="prototype",c=function(){var e,t=s("230e")("iframe"),i=r.length,a="<",n=">";t.style.display="none",s("fab2").appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(a+"script"+n+"document.F=Object"+a+"/script"+n),e.close(),c=e.F;while(i--)delete c[l][r[i]];return c()};e.exports=Object.create||function(e,t){var s;return null!==e?(o[l]=i(e),s=new o,o[l]=null,s[n]=e):s=c(),void 0===t?s:a(s,t)}},"2b4c":function(e,t,s){var i=s("5537")("wks"),a=s("ca5a"),r=s("7726").Symbol,n="function"==typeof r,o=e.exports=function(e){return i[e]||(i[e]=n&&r[e]||(n?r:a)("Symbol."+e))};o.store=i},"2d00":function(e,t){e.exports=!1},"2d95":function(e,t){var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},"2fdb":function(e,t,s){"use strict";var i=s("5ca1"),a=s("d2c8"),r="includes";i(i.P+i.F*s("5147")(r),"String",{includes:function(e){return!!~a(this,e,r).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(e,t,s){var i=s("86cc"),a=s("4630");e.exports=s("9e1e")?function(e,t,s){return i.f(e,t,a(1,s))}:function(e,t,s){return e[t]=s,e}},"38fd":function(e,t,s){var i=s("69a8"),a=s("4bf8"),r=s("613b")("IE_PROTO"),n=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},"41a0":function(e,t,s){"use strict";var i=s("2aeb"),a=s("4630"),r=s("7f20"),n={};s("32e9")(n,s("2b4c")("iterator"),(function(){return this})),e.exports=function(e,t,s){e.prototype=i(n,{next:a(1,s)}),r(e,t+" Iterator")}},"456d":function(e,t,s){var i=s("4bf8"),a=s("0d58");s("5eda")("keys",(function(){return function(e){return a(i(e))}}))},4588:function(e,t){var s=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:s)(e)}},4630:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"4bf8":function(e,t,s){var i=s("be13");e.exports=function(e){return Object(i(e))}},5147:function(e,t,s){var i=s("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(s){try{return t[i]=!1,!"/./"[e](t)}catch(a){}}return!0}},"520a":function(e,t,s){"use strict";var i=s("0bfb"),a=RegExp.prototype.exec,r=String.prototype.replace,n=a,o="lastIndex",l=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e[o]||0!==t[o]}(),c=void 0!==/()??/.exec("")[1],u=l||c;u&&(n=function(e){var t,s,n,u,h=this;return c&&(s=new RegExp("^"+h.source+"$(?!\\s)",i.call(h))),l&&(t=h[o]),n=a.call(h,e),l&&n&&(h[o]=h.global?n.index+n[0].length:t),c&&n&&n.length>1&&r.call(n[0],s,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(n[u]=void 0)})),n}),e.exports=n},"52a7":function(e,t){t.f={}.propertyIsEnumerable},5537:function(e,t,s){var i=s("8378"),a=s("7726"),r="__core-js_shared__",n=a[r]||(a[r]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:s("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(e,t,s){var i=s("7726"),a=s("8378"),r=s("32e9"),n=s("2aba"),o=s("9b43"),l="prototype",c=function(e,t,s){var u,h,d,p,f=e&c.F,m=e&c.G,g=e&c.S,v=e&c.P,b=e&c.B,y=m?i:g?i[t]||(i[t]={}):(i[t]||{})[l],w=m?a:a[t]||(a[t]={}),x=w[l]||(w[l]={});for(u in m&&(s=t),s)h=!f&&y&&void 0!==y[u],d=(h?y:s)[u],p=b&&h?o(d,i):v&&"function"==typeof d?o(Function.call,d):d,y&&n(y,u,d,e&c.U),w[u]!=d&&r(w,u,p),v&&x[u]!=d&&(x[u]=d)};i.core=a,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},"5eda":function(e,t,s){var i=s("5ca1"),a=s("8378"),r=s("79e5");e.exports=function(e,t){var s=(a.Object||{})[e]||Object[e],n={};n[e]=t(s),i(i.S+i.F*r((function(){s(1)})),"Object",n)}},"5f1b":function(e,t,s){"use strict";var i=s("23c6"),a=RegExp.prototype.exec;e.exports=function(e,t){var s=e.exec;if("function"===typeof s){var r=s.call(e,t);if("object"!==typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},"613b":function(e,t,s){var i=s("5537")("keys"),a=s("ca5a");e.exports=function(e){return i[e]||(i[e]=a(e))}},"626a":function(e,t,s){var i=s("2d95");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},6762:function(e,t,s){"use strict";var i=s("5ca1"),a=s("c366")(!0);i(i.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")("includes")},6821:function(e,t,s){var i=s("626a"),a=s("be13");e.exports=function(e){return i(a(e))}},"69a8":function(e,t){var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},"6a99":function(e,t,s){var i=s("d3f4");e.exports=function(e,t){if(!i(e))return e;var s,a;if(t&&"function"==typeof(s=e.toString)&&!i(a=s.call(e)))return a;if("function"==typeof(s=e.valueOf)&&!i(a=s.call(e)))return a;if(!t&&"function"==typeof(s=e.toString)&&!i(a=s.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},7333:function(e,t,s){"use strict";var i=s("0d58"),a=s("2621"),r=s("52a7"),n=s("4bf8"),o=s("626a"),l=Object.assign;e.exports=!l||s("79e5")((function(){var e={},t={},s=Symbol(),i="abcdefghijklmnopqrst";return e[s]=7,i.split("").forEach((function(e){t[e]=e})),7!=l({},e)[s]||Object.keys(l({},t)).join("")!=i}))?function(e,t){var s=n(e),l=arguments.length,c=1,u=a.f,h=r.f;while(l>c){var d,p=o(arguments[c++]),f=u?i(p).concat(u(p)):i(p),m=f.length,g=0;while(m>g)h.call(p,d=f[g++])&&(s[d]=p[d])}return s}:l},7726:function(e,t){var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},"77f1":function(e,t,s){var i=s("4588"),a=Math.max,r=Math.min;e.exports=function(e,t){return e=i(e),e<0?a(e+t,0):r(e,t)}},"79e5":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"7f20":function(e,t,s){var i=s("86cc").f,a=s("69a8"),r=s("2b4c")("toStringTag");e.exports=function(e,t,s){e&&!a(e=s?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},8378:function(e,t){var s=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=s)},"84f2":function(e,t){e.exports={}},"86cc":function(e,t,s){var i=s("cb7c"),a=s("c69a"),r=s("6a99"),n=Object.defineProperty;t.f=s("9e1e")?Object.defineProperty:function(e,t,s){if(i(e),t=r(t,!0),i(s),a)try{return n(e,t,s)}catch(o){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(e[t]=s.value),e}},"9b43":function(e,t,s){var i=s("d8e8");e.exports=function(e,t,s){if(i(e),void 0===t)return e;switch(s){case 1:return function(s){return e.call(t,s)};case 2:return function(s,i){return e.call(t,s,i)};case 3:return function(s,i,a){return e.call(t,s,i,a)}}return function(){return e.apply(t,arguments)}}},"9c6c":function(e,t,s){var i=s("2b4c")("unscopables"),a=Array.prototype;void 0==a[i]&&s("32e9")(a,i,{}),e.exports=function(e){a[i][e]=!0}},"9def":function(e,t,s){var i=s("4588"),a=Math.min;e.exports=function(e){return e>0?a(i(e),9007199254740991):0}},"9e1e":function(e,t,s){e.exports=!s("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a352:function(t,s){t.exports=e},a481:function(e,t,s){"use strict";var i=s("cb7c"),a=s("4bf8"),r=s("9def"),n=s("4588"),o=s("0390"),l=s("5f1b"),c=Math.max,u=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,f=function(e){return void 0===e?e:String(e)};s("214f")("replace",2,(function(e,t,s,m){return[function(i,a){var r=e(this),n=void 0==i?void 0:i[t];return void 0!==n?n.call(i,r,a):s.call(String(r),i,a)},function(e,t){var a=m(s,e,this,t);if(a.done)return a.value;var h=i(e),d=String(this),p="function"===typeof t;p||(t=String(t));var v=h.global;if(v){var b=h.unicode;h.lastIndex=0}var y=[];while(1){var w=l(h,d);if(null===w)break;if(y.push(w),!v)break;var x=String(w[0]);""===x&&(h.lastIndex=o(d,r(h.lastIndex),b))}for(var S="",C=0,E=0;E<y.length;E++){w=y[E];for(var _=String(w[0]),k=c(u(n(w.index),d.length),0),P=[],T=1;T<w.length;T++)P.push(f(w[T]));var D=w.groups;if(p){var M=[_].concat(P,k,d);void 0!==D&&M.push(D);var O=String(t.apply(void 0,M))}else O=g(_,d,k,P,D,t);k>=C&&(S+=d.slice(C,k)+O,C=k+_.length)}return S+d.slice(C)}];function g(e,t,i,r,n,o){var l=i+e.length,c=r.length,u=p;return void 0!==n&&(n=a(n),u=d),s.call(o,u,(function(s,a){var o;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(l);case"<":o=n[a.slice(1,-1)];break;default:var u=+a;if(0===u)return s;if(u>c){var d=h(u/10);return 0===d?s:d<=c?void 0===r[d-1]?a.charAt(1):r[d-1]+a.charAt(1):s}o=r[u-1]}return void 0===o?"":o}))}}))},aae3:function(e,t,s){var i=s("d3f4"),a=s("2d95"),r=s("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==a(e))}},ac6a:function(e,t,s){for(var i=s("cadf"),a=s("0d58"),r=s("2aba"),n=s("7726"),o=s("32e9"),l=s("84f2"),c=s("2b4c"),u=c("iterator"),h=c("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=a(p),m=0;m<f.length;m++){var g,v=f[m],b=p[v],y=n[v],w=y&&y.prototype;if(w&&(w[u]||o(w,u,d),w[h]||o(w,h,v),l[v]=d,b))for(g in i)w[g]||r(w,g,i[g],!0)}},b0c5:function(e,t,s){"use strict";var i=s("520a");s("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},be13:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},c366:function(e,t,s){var i=s("6821"),a=s("9def"),r=s("77f1");e.exports=function(e){return function(t,s,n){var o,l=i(t),c=a(l.length),u=r(n,c);if(e&&s!=s){while(c>u)if(o=l[u++],o!=o)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===s)return e||u||0;return!e&&-1}}},c649:function(e,t,s){"use strict";(function(e){s.d(t,"c",(function(){return c})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a})),s.d(t,"d",(function(){return l}));s("a481");function i(){return"undefined"!==typeof window?window.console:e.console}var a=i();function r(e){var t=Object.create(null);return function(s){var i=t[s];return i||(t[s]=e(s))}}var n=/-(\w)/g,o=r((function(e){return e.replace(n,(function(e,t){return t?t.toUpperCase():""}))}));function l(e){null!==e.parentElement&&e.parentElement.removeChild(e)}function c(e,t,s){var i=0===s?e.children[0]:e.children[s-1].nextSibling;e.insertBefore(t,i)}}).call(this,s("c8ba"))},c69a:function(e,t,s){e.exports=!s("9e1e")&&!s("79e5")((function(){return 7!=Object.defineProperty(s("230e")("div"),"a",{get:function(){return 7}}).a}))},c8ba:function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(i){"object"===typeof window&&(s=window)}e.exports=s},ca5a:function(e,t){var s=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+i).toString(36))}},cadf:function(e,t,s){"use strict";var i=s("9c6c"),a=s("d53b"),r=s("84f2"),n=s("6821");e.exports=s("01f9")(Array,"Array",(function(e,t){this._t=n(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,s=this._i++;return!e||s>=e.length?(this._t=void 0,a(1)):a(0,"keys"==t?s:"values"==t?e[s]:[s,e[s]])}),"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},cb7c:function(e,t,s){var i=s("d3f4");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},ce10:function(e,t,s){var i=s("69a8"),a=s("6821"),r=s("c366")(!1),n=s("613b")("IE_PROTO");e.exports=function(e,t){var s,o=a(e),l=0,c=[];for(s in o)s!=n&&i(o,s)&&c.push(s);while(t.length>l)i(o,s=t[l++])&&(~r(c,s)||c.push(s));return c}},d2c8:function(e,t,s){var i=s("aae3"),a=s("be13");e.exports=function(e,t,s){if(i(t))throw TypeError("String#"+s+" doesn't accept regex!");return String(a(e))}},d3f4:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},d53b:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},d8e8:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},e11e:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(e,t,s){"use strict";var i=s("5ca1"),a=s("9def"),r=s("d2c8"),n="startsWith",o=""[n];i(i.P+i.F*s("5147")(n),"String",{startsWith:function(e){var t=r(this,e,n),s=a(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return o?o.call(t,i,s):t.slice(s,s+i.length)===i}})},f6fd:function(e,t){(function(e){var t="currentScript",s=e.getElementsByTagName("script");t in e||Object.defineProperty(e,t,{get:function(){try{throw new Error}catch(i){var e,t=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(i.stack)||[!1])[1];for(e in s)if(s[e].src==t||"interactive"==s[e].readyState)return s[e];return null}}})})(document)},f751:function(e,t,s){var i=s("5ca1");i(i.S+i.F,"Object",{assign:s("7333")})},fa5b:function(e,t,s){e.exports=s("5537")("native-function-to-string",Function.toString)},fab2:function(e,t,s){var i=s("7726").document;e.exports=i&&i.documentElement},fb15:function(e,t,s){"use strict";var i;(s.r(t),"undefined"!==typeof window)&&(s("f6fd"),(i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(s.p=i[1]));s("f751"),s("f559"),s("ac6a"),s("cadf"),s("456d");function a(e){if(Array.isArray(e))return e}function r(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var s=[],i=!0,a=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(i=(n=o.next()).done);i=!0)if(s.push(n.value),t&&s.length===t)break}catch(l){a=!0,r=l}finally{try{i||null==o["return"]||o["return"]()}finally{if(a)throw r}}return s}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}function o(e,t){if(e){if("string"===typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(e,t):void 0}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){return a(e)||r(e,t)||o(e,t)||l()}s("6762"),s("2fdb");function u(e){if(Array.isArray(e))return n(e)}function h(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e){return u(e)||h(e)||o(e)||d()}var f=s("a352"),m=s.n(f),g=s("c649");function v(e,t,s){return void 0===s||(e=e||{},e[t]=s),e}function b(e,t){return e.map((function(e){return e.elm})).indexOf(t)}function y(e,t,s,i){if(!e)return[];var a=e.map((function(e){return e.elm})),r=t.length-i,n=p(t).map((function(e,t){return t>=r?a.length:a.indexOf(e)}));return s?n.filter((function(e){return-1!==e})):n}function w(e,t){var s=this;this.$nextTick((function(){return s.$emit(e.toLowerCase(),t)}))}function x(e){var t=this;return function(s){null!==t.realList&&t["onDrag"+e](s),w.call(t,e,s)}}function S(e){return["transition-group","TransitionGroup"].includes(e)}function C(e){if(!e||1!==e.length)return!1;var t=c(e,1),s=t[0].componentOptions;return!!s&&S(s.tag)}function E(e,t,s){return e[s]||(t[s]?t[s]():void 0)}function _(e,t,s){var i=0,a=0,r=E(t,s,"header");r&&(i=r.length,e=e?[].concat(p(r),p(e)):p(r));var n=E(t,s,"footer");return n&&(a=n.length,e=e?[].concat(p(e),p(n)):p(n)),{children:e,headerOffset:i,footerOffset:a}}function k(e,t){var s=null,i=function(e,t){s=v(s,e,t)},a=Object.keys(e).filter((function(e){return"id"===e||e.startsWith("data-")})).reduce((function(t,s){return t[s]=e[s],t}),{});if(i("attrs",a),!t)return s;var r=t.on,n=t.props,o=t.attrs;return i("on",r),i("props",n),Object.assign(s.attrs,o),s}var P=["Start","Add","Remove","Update","End"],T=["Choose","Unchoose","Sort","Filter","Clone"],D=["Move"].concat(P,T).map((function(e){return"on"+e})),M=null,O={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(e){return e}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},I={name:"draggable",inheritAttrs:!1,props:O,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(e){var t=this.$slots.default;this.transitionMode=C(t);var s=_(t,this.$slots,this.$scopedSlots),i=s.children,a=s.headerOffset,r=s.footerOffset;this.headerOffset=a,this.footerOffset=r;var n=k(this.$attrs,this.componentData);return e(this.getTag(),n,i)},created:function(){null!==this.list&&null!==this.value&&g["b"].error("Value and list props are mutually exclusive! Please set one or another."),"div"!==this.element&&g["b"].warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),void 0!==this.options&&g["b"].warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var e=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var t={};P.forEach((function(s){t["on"+s]=x.call(e,s)})),T.forEach((function(s){t["on"+s]=w.bind(e,s)}));var s=Object.keys(this.$attrs).reduce((function(t,s){return t[Object(g["a"])(s)]=e.$attrs[s],t}),{}),i=Object.assign({},this.options,s,t,{onMove:function(t,s){return e.onDragMove(t,s)}});!("draggable"in i)&&(i.draggable=">*"),this._sortable=new m.a(this.rootContainer,i),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(e){this.updateOptions(e)},deep:!0},$attrs:{handler:function(e){this.updateOptions(e)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var e=this._vnode.fnOptions;return e&&e.functional},getTag:function(){return this.tag||this.element},updateOptions:function(e){for(var t in e){var s=Object(g["a"])(t);-1===D.indexOf(s)&&this._sortable.option(s,e[t])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var e=this.$slots.default;return this.transitionMode?e[0].child.$slots.default:e},computeIndexes:function(){var e=this;this.$nextTick((function(){e.visibleIndexes=y(e.getChildrenNodes(),e.rootContainer.children,e.transitionMode,e.footerOffset)}))},getUnderlyingVm:function(e){var t=b(this.getChildrenNodes()||[],e);if(-1===t)return null;var s=this.realList[t];return{index:t,element:s}},getUnderlyingPotencialDraggableComponent:function(e){var t=e.__vue__;return t&&t.$options&&S(t.$options._componentTag)?t.$parent:!("realList"in t)&&1===t.$children.length&&"realList"in t.$children[0]?t.$children[0]:t},emitChanges:function(e){var t=this;this.$nextTick((function(){t.$emit("change",e)}))},alterList:function(e){if(this.list)e(this.list);else{var t=p(this.value);e(t),this.$emit("input",t)}},spliceList:function(){var e=arguments,t=function(t){return t.splice.apply(t,p(e))};this.alterList(t)},updatePosition:function(e,t){var s=function(s){return s.splice(t,0,s.splice(e,1)[0])};this.alterList(s)},getRelatedContextFromMoveEvent:function(e){var t=e.to,s=e.related,i=this.getUnderlyingPotencialDraggableComponent(t);if(!i)return{component:i};var a=i.realList,r={list:a,component:i};if(t!==s&&a&&i.getUnderlyingVm){var n=i.getUnderlyingVm(s);if(n)return Object.assign(n,r)}return r},getVmIndex:function(e){var t=this.visibleIndexes,s=t.length;return e>s-1?s:t[e]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(e){if(this.noTransitionOnDrag&&this.transitionMode){var t=this.getChildrenNodes();t[e].data=null;var s=this.getComponent();s.children=[],s.kept=void 0}},onDragStart:function(e){this.context=this.getUnderlyingVm(e.item),e.item._underlying_vm_=this.clone(this.context.element),M=e.item},onDragAdd:function(e){var t=e.item._underlying_vm_;if(void 0!==t){Object(g["d"])(e.item);var s=this.getVmIndex(e.newIndex);this.spliceList(s,0,t),this.computeIndexes();var i={element:t,newIndex:s};this.emitChanges({added:i})}},onDragRemove:function(e){if(Object(g["c"])(this.rootContainer,e.item,e.oldIndex),"clone"!==e.pullMode){var t=this.context.index;this.spliceList(t,1);var s={element:this.context.element,oldIndex:t};this.resetTransitionData(t),this.emitChanges({removed:s})}else Object(g["d"])(e.clone)},onDragUpdate:function(e){Object(g["d"])(e.item),Object(g["c"])(e.from,e.item,e.oldIndex);var t=this.context.index,s=this.getVmIndex(e.newIndex);this.updatePosition(t,s);var i={element:this.context.element,oldIndex:t,newIndex:s};this.emitChanges({moved:i})},updateProperty:function(e,t){e.hasOwnProperty(t)&&(e[t]+=this.headerOffset)},computeFutureIndex:function(e,t){if(!e.element)return 0;var s=p(t.to.children).filter((function(e){return"none"!==e.style["display"]})),i=s.indexOf(t.related),a=e.component.getVmIndex(i),r=-1!==s.indexOf(M);return r||!t.willInsertAfter?a:a+1},onDragMove:function(e,t){var s=this.move;if(!s||!this.realList)return!0;var i=this.getRelatedContextFromMoveEvent(e),a=this.context,r=this.computeFutureIndex(i,e);Object.assign(a,{futureIndex:r});var n=Object.assign({},e,{relatedContext:i,draggedContext:a});return s(n,t)},onDragEnd:function(){this.computeIndexes(),M=null}}};"undefined"!==typeof window&&"Vue"in window&&window.Vue.component("draggable",I);var F=I;t["default"]=F}})["default"]}))},bdf7:function(e,t,s){},c240:function(e,t,s){},c261:function(e,t,s){},c2dc:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{ref:"__modal",attrs:{minWidth:"60%",maxWidth:"90%",minHeight:"75%"},scopedSlots:e._u([{key:"main",fn:function(){return[0===e.editableFields.length?s("p",[e._v("No editable parameters available.")]):s("form",{attrs:{id:"parameterModal"},on:{submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[e._l(e.editableFields,(function(t,i){return s("div",{key:i,staticClass:"fieldRow"},[s("label",{class:{fieldLabel:!0,highlight:t.name===e.selectParameter}},[e._v(" "+e._s(e.displayLabel(t))),t.optional?e._e():s("strong",{staticClass:"required",attrs:{title:"required"}},[e._v("*")]),t.description?s("div",{staticClass:"description"},[s("Description",{attrs:{description:t.description}})],1):e._e()]),s("ParameterDataTypes",{ref:t.name,refInFor:!0,attrs:{editable:e.editable,parameter:t,processId:e.processId,context:e.context,parent:e.parent},on:{schemaSelected:function(s){return e.updateType(t,s)}},model:{value:e.values[t.name],callback:function(s){e.$set(e.values,t.name,s)},expression:"values[param.name]"}}),t.unspecified?s("button",{staticClass:"deleteBtn",attrs:{title:"Delete unspecified parameter",type:"button"},on:{click:function(t){return e.deleteParam(i)}}},[s("i",{staticClass:"fas fa-trash"})]):e._e()],1)})),s("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})],2)]},proxy:!0},"function"===typeof e.saveCallback?{key:"footer",fn:function(){return[s("div",{staticClass:"footer"},[s("button",{staticClass:"save",on:{click:e.save}},[e._v("Save")])])]},proxy:!0}:null],null,!0)})},a=[],r=s("025e"),n=s("2930"),o=s("8088"),l=s("3916"),c={name:"ParameterModal",components:{Modal:n["a"],Description:o["default"],ParameterDataTypes:l["default"]},data(){return{editableFields:[],values:{},schemas:{},editable:!0,selectParameter:null,saveCallback:null,processId:null,parent:null}},computed:{context(){return{values:this.values,schemas:this.schemas,parameters:this.editableFields}}},methods:{deleteParam(e){let t=this.editableFields[e].name;this.$delete(this.editableFields,e),this.$delete(this.schemas,t),this.$delete(this.values,t)},updateType(e,t){this.$set(this.schemas,e.name,t)},displayLabel(e){return"string"===typeof e.label&&e.label.length>0?e.label:r["a"].prettifyString(e.name)},save(){try{"function"===typeof this.saveCallback&&this.saveCallback(this.values),this.$refs.__modal.close()}catch(e){r["a"].exception(this,e)}},show(e,t,s,i=!0,a=null,n=null,o=null,l=null,c=null){this.editableFields=t,this.values=r["a"].deepClone(s),this.schemas={},this.editable=i,this.saveCallback=a,this.processId=o,this.selectParameter=l,this.parent=c,this.$refs.__modal.show(e,n),this.$nextTick(()=>this.setSelected())},componentforParameter(e){return e&&Array.isArray(this.$refs[e])&&this.$refs[e][0]?this.$refs[e][0]:null},setSelected(e=0){let t;this.selectParameter?t=this.componentforParameter(this.selectParameter):this.editableFields.length>0&&(t=this.componentforParameter(this.editableFields[0].name)),t&&(t.$el&&t.$el.scrollIntoView?(this.selectParameter&&t.$el.scrollIntoView(),this.setInputFocus(t.$el)):e<10&&setTimeout(()=>this.setSelected(++e),250))},setInputFocus(e,t=0){if(e.querySelector){let t=e.querySelector('input:not([type="hidden"]):not([disabled]):not([class~="multiselect__input"]), button:not([disabled]), textarea:not([disabled]), select:not([disabled]), datalist:not([disabled])');t&&t.focus()}else t<10&&setTimeout(()=>this.setInputFocus(e,++t),250)}}},u=c,h=(s("b0bb"),s("6e6b"),s("2877")),d=Object(h["a"])(u,i,a,!1,null,"c8e4c34a",null);t["default"]=d.exports},c46c:function(e,t,s){"use strict";s("c261")},c5cf:function(e,t,s){},c98e:function(e,t,s){},cbd9:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"discovery-toolbar"},[s("SearchBox",{model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),s("div",{staticClass:"search-results"},[s("Collections",{staticClass:"category",attrs:{collections:e.collections,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed},scopedSlots:e._u([{key:"summary",fn:function(t){var i=t.item;return[s("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsLoadCollection},on:{dragstart:function(t){return e.onDrag(t,"collection",i)}}},[s("div",{staticClass:"discovery-info",on:{click:function(t){return e.showCollectionInfo(i.id)}}},[s("strong",{attrs:{title:i.id}},[e._v(e._s(i.id))]),i.title?s("small",{attrs:{title:i.title}},[e._v(e._s(i.title))]):e._e()]),e.supportsLoadCollection?s("button",{staticClass:"discovery-button",attrs:{type:"button",title:"Insert"},on:{click:function(t){return e.insertCollection(i)}}},[s("i",{staticClass:"fas fa-plus"})]):e._e()])]}}])}),s("Processes",{staticClass:"category",attrs:{processes:e.processes,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed},scopedSlots:e._u([{key:"summary",fn:function(t){var i=t.item;return[s("div",{staticClass:"discovery-entity",attrs:{draggable:"true"},on:{dragstart:function(t){return e.onDrag(t,"process",i)}}},[s("div",{staticClass:"discovery-info",on:{click:function(t){return e.showProcessInfo(i)}}},[i.native?e._e():s("i",{staticClass:"custom-process fas fa-xs fa-sitemap",attrs:{title:"Custom Process"}}),s("strong",{attrs:{title:i.id}},[e._v(e._s(i.id))]),i.summary?s("small",{attrs:{title:i.summary}},[e._v(e._s(i.summary))]):e._e()]),s("button",{staticClass:"discovery-button",attrs:{type:"button",title:"Insert"},on:{click:function(t){return e.insertProcess(i)}}},[s("i",{staticClass:"fas fa-plus"})])])]}}])}),e.hasUdfRuntimes?s("UdfRuntimes",{staticClass:"category",attrs:{runtimes:e.udfRuntimes,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed},scopedSlots:e._u([{key:"summary",fn:function(t){var i=t.summary,a=t.item;return[s("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsRunUdf},on:{dragstart:function(t){return e.onDrag(t,"udf",{runtime:i.identifier,version:a.default})}}},[s("div",{staticClass:"discovery-info",on:{click:function(t){return e.showUdfInfo(i.identifier,a)}}},[s("strong",{attrs:{title:i.identifier}},[e._v(e._s(i.identifier)+" ("+e._s(a.default)+")")]),i.summary?s("small",{attrs:{title:i.summary}},[e._v(e._s(i.summary))]):e._e()]),e.supportsRunUdf?s("button",{staticClass:"discovery-button",attrs:{type:"button",title:"Insert"},on:{click:function(t){return e.insertUdf(i.identifier,a.default)}}},[s("i",{staticClass:"fas fa-plus"})]):e._e()])]}}],null,!1,1122562181)}):e._e(),s("FileFormats",{staticClass:"category",attrs:{formats:e.fileFormats,showInput:!1,heading:"Export File Formats",searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed},scopedSlots:e._u([{key:"summary",fn:function(t){var i=t.item;return[s("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsSaveResult},on:{dragstart:function(t){return e.onDrag(t,"fileformat",i)}}},[s("div",{staticClass:"discovery-info",on:{click:function(t){return e.showFileFormatInfo(i)}}},[s("strong",{attrs:{title:i.name}},[e._v(e._s(i.name))]),i.title?s("small",{attrs:{title:i.title}},[e._v(e._s(i.title))]):e._e()]),e.supportsSaveResult?s("button",{staticClass:"discovery-button",attrs:{type:"button",title:"Insert"},on:{click:function(t){return e.insertFileFormat(i)}}},[s("i",{staticClass:"fas fa-plus"})]):e._e()])]}}])})],1)],1)},a=[],r=s("3115"),n=s("025e"),o=s("69d2"),l=s("a0e2"),c=s("9b5d"),u=s("2979"),h=s("d235"),d={name:"DiscoveryToolbar",mixins:[r["a"]],components:{Collections:o["a"],FileFormats:l["a"],Processes:c["a"],SearchBox:u["default"],UdfRuntimes:h["a"]},props:{onAddProcess:{type:Function,required:!0}},data(){return{searchTerm:"",collapsed:!0}},computed:{...n["a"].mapState(["predefinedProcesses","collections","udfRuntimes"]),...n["a"].mapState("userProcesses",["userProcesses"]),...n["a"].mapGetters(["supports","collectionDefaults","fileFormats"]),...n["a"].mapGetters("userProcesses",{getProcessById:"getAllById"}),supportsLoadCollection(){return!!this.getProcessById("load_collection")},supportsRunUdf(){return!!this.getProcessById("run_udf")},supportsSaveResult(){return!!this.getProcessById("save_result")},hasUdfRuntimes(){return n["a"].size(this.udfRuntimes)},processes(){return this.predefinedProcesses.concat(this.userProcesses)}},watch:{searchTerm(e,t){!e&&t?this.collapsed=!0:e&&!t&&(this.collapsed=!1)}},methods:{onDrag(e,t,s){let i=this.getNode(t,s);e.dataTransfer.setData("application/openeo-node",JSON.stringify(i)),e.dataTransfer.setData("text/plain",JSON.stringify(i,null,2))},showCollectionInfo(e){this.supports("listCollections")&&this.emit("showCollection",e)},showProcessInfo(e){this.emit("showProcessInfo",e)},showUdfInfo(e,t){this.emit("showUdfRuntimeInfo",e,t,t.default)},showFileFormatInfo(e){this.emit("showFileFormatInfo",e.name,this.fileFormats.output[e.name],"output")},getNode(e,t){switch(e){case"collection":return{process_id:"load_collection",arguments:this.collectionDefaults(t.id)};case"process":return{process_id:t.id,arguments:{}};case"udf":return{process_id:"run_udf",arguments:t};case"fileformat":return{process_id:"save_result",arguments:{format:t.name,options:{}}}}},insertCollection(e){let t=this.getNode("collection",e);this.onAddProcess(t)},insertProcess(e){let t=this.getNode("process",e);this.onAddProcess(t)},insertUdf(e,t){let s=this.getNode("udf",{runtime:e,version:t});this.onAddProcess(s)},insertFileFormat(e){let t=this.getNode("fileformat",e);this.onAddProcess(t)}}},p=d,f=(s("7b86"),s("74bf"),s("2877")),m=Object(f["a"])(p,i,a,!1,null,"258b0e80",null);t["a"]=m.exports},ccbe:function(e,t,s){"use strict";s("4525")},ceb0:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tabs",{ref:"tabs",staticClass:"editor",attrs:{id:"customProcessContent",position:"bottom"}},[s("Tab",{attrs:{id:"visual",name:"Visual Model",icon:"fa-project-diagram",selected:!0,allowShow:e.canSwitchView},on:{show:e.showModel}},[s("VisualEditor",{ref:"graphBuilder",staticClass:"visualEditorTab",attrs:{editable:e.editable,pgParameters:e.pgParameters,value:e.modelValue,title:e.title,id:e.id+"_visual",showDiscoveryToolbar:e.showDiscoveryToolbar,defaultValue:e.defaultValue},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1),s("Tab",{attrs:{id:"source",name:"Code",icon:"fa-code",allowShow:e.canSwitchView},on:{show:e.showCode}},[s("TextEditor",{ref:"sourceEditor",staticClass:"textEditorTab",attrs:{editable:e.editable,value:e.codeValue,title:e.title,id:e.id+"_text",language:"processgraph"},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1)],1)},a=[],r=s("025e"),n=s("e7ea"),o=s("bdb2"),l=function(){var e=this,t=this,s=t.$createElement,i=t._self._c||s;return i("div",{ref:"visualEditor",staticClass:"visualEditor"},[i("div",{staticClass:"sourceHeader"},[t.title?i("h3",[t._v(t._s(t.title))]):t._e(),i("div",{staticClass:"sourceToolbar"},[t.editable?i("span",{staticClass:"sepr"},[i("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:t.confirmClear}},[i("i",{staticClass:"fas fa-file"})]),t._t("file-toolbar")],2):t._e(),t.editable?i("span",{staticClass:"sepr"},[i("button",{attrs:{type:"button",disabled:!t.canUndo,title:"Revert last change"},on:{click:function(e){return t.$refs.blocks.undo()}}},[i("i",{staticClass:"fas fa-undo-alt"})]),i("button",{attrs:{type:"button",disabled:!t.canRedo,title:"Redo last reverted change"},on:{click:function(e){return t.$refs.blocks.redo()}}},[i("i",{staticClass:"fas fa-redo-alt"})]),i("button",{attrs:{type:"button",disabled:!t.hasSelection,title:"Delete selected elements"},on:{click:function(e){return t.$refs.blocks.deleteSelected()}}},[i("i",{staticClass:"fas fa-trash"})])]):t._e(),t.editable?i("span",{staticClass:"sepr"},[i("button",{attrs:{type:"button",title:"Add Parameter"},on:{click:t.addParameter}},[i("i",{staticClass:"fas fa-parking"})]),t.supportsMath?i("button",{class:{highlightFormula:t.isMath},attrs:{type:"button",title:"Insert/Edit formula"},on:{click:t.showExpressionModal}},[i("i",{staticClass:"fas fa-square-root-alt"})]):t._e()]):t._e(),i("button",{class:{compactMode:t.compactMode},attrs:{type:"button",title:"Compact Mode"},on:{click:function(e){return t.$refs.blocks.toggleCompact()}}},[i("i",{staticClass:"fas fa-compress-arrows-alt"})]),i("button",{attrs:{type:"button",title:"Scale to perfect size"},on:{click:function(e){return t.$refs.blocks.perfectScale()}}},[i("i",{staticClass:"fas fa-arrows-alt"})]),i("FullscreenButton",{attrs:{element:function(){return e.$refs.visualEditor}},on:{changed:function(s){e.$refs.blocks.perfectScale(),t.isFullScreen=s}}}),t._t("toolbar")],2)]),i("div",{staticClass:"editorSplitter"},[(t.showDiscoveryToolbar||t.isFullScreen)&&t.editable?i("DiscoveryToolbar",{staticClass:"discoveryToolbar",attrs:{onAddProcess:t.insertProcess}}):t._e(),i("div",{staticClass:"graphBuilder",on:{drop:function(e){return t.onDrop(e)},dragover:function(e){return t.allowDrop(e)}}},[i("Blocks",{ref:"blocks",attrs:{editable:t.editable,id:t.id,processes:t.processRegistry,collections:t.collections,pgParameters:t.pgParameters,value:t.value},on:{input:t.commit,error:t.errorHandler,showProcess:function(e){return t.emit("showProcess",e)},showCollection:function(e){return t.emit("showCollection",e)},showSchema:t.showSchemaModal,editParameters:t.openParameterEditor,compactMode:function(t){return e.compactMode=t},selectionChanged:t.selectionChanged,historyChanged:t.historyChanged}})],1)],1),i("ParameterModal",{ref:"parameterModal"}),t.editable&&t.supportsMath?i("ExpressionModal",{ref:"expressionModal",on:{save:t.insertNodes}}):t._e()],1)},c=[],u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"div",staticClass:"blocks_js_editor",attrs:{id:e.id,tabindex:"0"},on:{mousemove:function(t){return e.onMouseMove(t)},mousedown:function(t){return e.onMouseDown(t)},wheel:function(t){return t.preventDefault(),e.onMouseWheel(t)},keydown:function(t){return e.onKeyDown(t)},focus:function(t){return e.highlight(!0)},blur:function(t){return e.highlight(!1)}}},[s("svg",{staticClass:"canvas",attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1"}},[e._l(e.edges,(function(t){return s("Edge",e._b({key:t.id,ref:"edges",refInFor:!0,attrs:{state:e.state,parameter1:t.parameter1,parameter2:t.parameter2},on:{position:function(e){t.position1=arguments[0],t.position2=arguments[1]}}},"Edge",t,!1))})),e.linkingLine?s("line",e._b({},"line",e.linkingLine,!1)):e._e(),e.selectRect?s("rect",e._b({},"rect",e.selectRect,!1)):e._e()],2),s("div",{staticClass:"blocks"},e._l(e.blocks,(function(t){return s("Block",{key:t.type+t.id,attrs:{id:t.id,type:t.type,value:t.value,spec:t.spec,state:e.state,selected:t.selected},on:{"update:selected":function(s){return e.$set(t,"selected",s)},input:function(t){return e.commit()},parameterRemoved:e.parameterRemoved,mounted:e.mountBlock,unmounted:e.unmountBlock,move:e.startDragBlock,moved:e.refreshEdges}})})),1)])},h=[],d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"div",class:e.containerClasses,style:e.styles,attrs:{id:"block"+this.id},on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:(t.preventDefault(),t.stopPropagation(),"button"in t&&0!==t.button?null:e.onMouseDown(t))}}},[s("div",{staticClass:"blockTitle",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:(t.preventDefault(),t.stopPropagation(),"button"in t&&0!==t.button?null:e.emitDrag(t))}}},[s("span",{staticClass:"titleText",attrs:{title:e.plainTitle}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.invalid,expression:"invalid"}],staticClass:"invalid",attrs:{title:"Process or Collection not supported!"}},[s("i",{staticClass:"fas fa-exclamation-triangle"})]),e._v(" "+e._s(e.name)+" "),e.showId?s("span",{staticClass:"blockId"},[e._v("#"+e._s(e.id))]):e._e()]),s("div",{staticClass:"blockicon",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:(t.preventDefault(),t.stopPropagation(),"button"in t&&0!==t.button?null:e.focus())}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.allowsComment&&!e.hasComment,expression:"allowsComment && !hasComment"}],staticClass:"addComment",attrs:{title:"Add comment"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addComment()}}},[s("i",{staticClass:"fas fa-comment-medical"})]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.allowsDelete,expression:"allowsDelete"}],staticClass:"delete",attrs:{title:"Remove (DEL)"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.remove()}}},[s("i",{staticClass:"fas fa-trash"})]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.allowsInfo,expression:"allowsInfo"}],staticClass:"info",attrs:{title:"Details"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.showInfo()}}},[s("i",{staticClass:"fas fa-info"})]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.allowsParameterChange,expression:"allowsParameterChange"}],staticClass:"settings",attrs:{title:"Change parameter values"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.showParameters()}}},[s("i",{staticClass:"fas fa-sliders-h"})])])]),s("div",{staticClass:"inout"},[s("div",{staticClass:"inputs"},e._l(e.parameters,(function(t,i){return s("BlockParameter",e._b({key:i,ref:"parameters",refInFor:!0,attrs:{state:e.state},on:{edgesChanged:function(s){return e.edgesChanged(t,s)}},model:{value:e.args[t.name],callback:function(s){e.$set(e.args,t.name,s)},expression:"args[param.name]"}},"BlockParameter",t,!1))})),1),s("div",{staticClass:"outputs"},[s("BlockParameter",e._b({ref:"output",attrs:{state:e.state,label:e.outputLabel}},"BlockParameter",e.output,!1))],1)]),e.hasComment?s("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:e.comment,expression:"comment",modifiers:{lazy:!0}}],ref:"commentField",staticClass:"editComment",attrs:{placeholder:"Type comment here..."},domProps:{value:e.comment},on:{blur:function(t){return e.updateComment(t)},mousedown:function(e){e.stopPropagation()},change:function(t){e.comment=t.target.value}}}):e._e()])},p=[],f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({class:e.classes},e.listeners),[e.output?e._e():s("div",e._g({ref:"circle",class:e.circleClasses},e.circleListeners)),s("span",{staticClass:"text"},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.unspecified,expression:"unspecified"}],staticClass:"unspecified",attrs:{title:"Parameter is likely unsupported!"}},[s("i",{staticClass:"fas fa-exclamation-triangle"})]),s("span",{staticClass:"label"},[e._v(e._s(e.displayLabel))]),e.displayValue.length?[e._v(": ")]:e._e(),s("span",{staticClass:"value",domProps:{innerHTML:e._s(e.displayValue)}})],2),e.output?s("div",e._g({ref:"circle",class:e.circleClasses},e.circleListeners)):e._e()])},m=[],g=s("79e5"),v=s("a76e"),b={name:"BlockParameter",props:{name:{type:String,default:"output"},description:{type:String,default:""},optional:{type:Boolean,default:!1},deprecated:{type:Boolean,default:!1},experimental:{type:Boolean,default:!1},default:{},value:{},schema:{type:[Object,Array],default:null},label:{type:String},output:{type:Boolean,default:!1},state:{type:Object,required:!0}},data(){return{edges:[]}},computed:{schemas(){return this.schema instanceof g["d"]?this.schema:new g["d"](this.schema)},hasValue(){return void 0!==this.value},listeners(){return this.allowsParameterChange?{dblclick:this.openEditorForParameter}:{}},circleListeners(){var e={};return this.state.editable&&(e.mousedown=e=>{1==e.which&&(this.state.root.link(this),e.preventDefault(),e.stopPropagation())},this.output&&(e.click=e=>{if(1==e.which){if(this.getEdgeCount()>0)return void this.state.root.$emit("error","A result node can't have outgoing edges.");this.state.root.setResultNode(this.$parent)}}),e.mouseover=()=>this.state.linkFrom&&this.state.root.link(this),e.mouseout=()=>this.state.linkTo&&this.state.root.unlink(this)),e},classes(){return[this.output?"output":"input","connector","field_"+this.name,this.hasValue||this.optional||this.output||this.getEdgeCount()>0?"hasValue":"noValue"]},unspecified(){return!this.$parent.invalid&&this.state.root.hasProcesses&&this.schemas.unspecified},circleClasses(){var e=["circle"];this.getEdgeCount()>0&&e.push("io_active");var t=this.edges;for(var s in t)t[s].selected&&e.push("io_selected");return this.state.linkFrom!=this&&this.state.linkTo!=this||e.push("io_selected"),e},displayValue(){var e=38-this.displayLabel.length,t=null;return!this.isEditable||this.state.compactMode||r["a"].isRef(this.value)||"undefined"===typeof this.value||(t=this.formatValue(this.value,e,!0)),"string"===typeof t?0===t.length&&(t="<em>Empty</em>"):t="",t},displayLabel(){return this.output&&this.state.compactMode?"":"string"===typeof this.label&&(this.label.length>0||this.output)?this.label:this.name},isDefaultValue(){return!this.hasValue||"undefined"!==typeof this.default&&this.default==this.value},isArrayType(){return"array"===this.schemas.nativeDataType()},isObjectType(){return"object"===this.schemas.nativeDataType()},isEditable(){return!this.output&&this.schemas.isEditable()},allowsParameterChange(){return!this.output&&this.state.root.supports("editParameters")&&this.schemas.isEditable()},allowsMultipleInputs(){return this.isArrayType||this.isObjectType||"any"===this.schemas.nativeDataType()}},watch:{edges(){this.updateEdgeStatus(),this.$emit("edgesChanged",this.edges,this)},value:{immediate:!0,handler(){this.updateEdgeStatus()}}},methods:{updateEdgeStatus(){if(!this.output)for(var e of this.edges)e.inactive=!this.isEdgeUsed(e)},getCirclePosition(){var e=r["a"].domBoundingBox(this.$refs.circle),t=this.state.root.getDimensions(),s=e.offsetLeft-t.offsetLeft+e.width/2,i=e.offsetTop-t.offsetTop+e.height/2;return[s,i]},openEditorForParameter(){this.allowsParameterChange&&this.$parent.showParameters(this.name)},jsonSchema(){return this.schemas.toJSON()},setValue(e){"boolean0"!=this.schemas.nativeDataType()||r["a"].isRef(e)||(e=!!e),this.$emit("input",e)},resetValue(){if("undefined"===typeof this.default){var e;if(this.schemas.nullable())e=null;else{var t=this.schemas.nativeDataType();switch(t){case"object":e={};break;case"array":e=[];break;case"string":e="";break;case"integer":case"number":e=0;break;case"boolean":e=!1;break;default:e=void 0}}this.setValue(e)}else this.setValue(this.default)},getEdgeRef(e){return this.output?this.value:e.parameter1.value},addRefToValue(e){var t=this.getEdgeRef(e);if(t)if(this.allowsMultipleInputs)if(this.isArrayType)if(r["a"].isRef(this.value))this.setValue([this.value,t]);else if(Array.isArray(this.value)&&this.value.length>0){var s=this.value;s.push(t),this.setValue(s)}else this.setValue(t);else if(this.isObjectType){var i=r["a"].size(this.value);1!==this.getEdgeCount()||this.hasValue&&i?i||this.resetValue():this.setValue(t)}else this.setValue(t);else this.setValue(t)},removeRefFromValue(e){var t=this.getEdgeRef(e);r["a"].isRefEqual(t,this.value)?this.resetValue():(this.isArrayType||this.isObjectType)&&this.setValue(this.removeRefFromValueDeep(this.value,t))},removeRefFromValueDeep(e,t){if(Array.isArray(e)){var s=e.length;while(--s>=0)null!==e[s]&&"object"===typeof e[s]&&(r["a"].isRefEqual(t,e[s])?e.splice(s,1):e[s]=this.removeRefFromValueDeep(e[s],t))}else if(r["a"].isObject(e))for(var i in e)e.hasOwnProperty(i)&&null!==e[i]&&"object"===typeof e[i]&&(r["a"].isRefEqual(t,e[i])?delete e[i]:e[s]=this.removeRefFromValueDeep(e[i],t));return e},addEdge(e){this.edges.push(e),this.isEdgeUsed(e)||this.output||this.addRefToValue(e)},eraseEdge(e){for(var t in this.edges)if(this.edges[t]==e)return this.removeRefFromValue(e),this.$delete(this.edges,t),!0;return!1},isEdgeUsed(e){var t=this.getEdgeRef(e);return!!r["a"].isRefEqual(t,this.value)||this.hasRefInValue(t,this.value)},hasRefInValue(e,t){if(!t||"object"!==typeof t)return!1;if(r["a"].isRefEqual(e,t))return!0;for(let s in t)if(this.hasRefInValue(e,t[s]))return!0;return!1},getEdgeCount(){return this.edges.length},formatProcess(e,t){if(e instanceof v["ProcessGraph"]&&1===e.getNodeCount())return this.formatValue(e.getResultNode().process_id,t);var s=Object.values(e.process_graph);return 1===s.length?this.formatValue(s[0].process_id,t):"Process"},formatValue(e,t,s=!0){if("object"===typeof e)return null===e?"n/a":Array.isArray(e)?this.formatArray(e,t,s):this.formatObject(e,t,s);if("string"===typeof e){if(e.length>t){var i=r["a"].htmlentities(e.substr(0,t));return s?i+'<span title="'+r["a"].htmlentities(e)+'">…</span>':i}return r["a"].htmlentities(e)}return"boolean"===typeof e?e?"✔️":"❌":"number"===typeof e?e.toString():r["a"].htmlentities(JSON.stringify(e))},formatArray(e,t,s=!0){let i=[];for(let a in e){let n=e[a],o=this.formatValue(n,10,s),l=r["a"].htmlentities_decode(this.formatValue(n,10,!1));if(l.length>t){if(0===i.length)return this.formatArraySimple(e,"List("+e.length+")");i.push(this.formatArraySimple(e,"…"));break}i.push(o),t-=l.length+2}return i.join(", ")},formatArraySimple(e,t,s=!0){if(s&&e.length<10){let s=e.map(e=>this.formatValue(e,25,!1)).join(", ");return'<span title="'+s+'">'+t+"</span>"}return t},formatObject(e,t,s=!0){return 0===Object.keys(e).length?"None":e instanceof v["ProcessGraph"]||r["a"].isObject(e.process_graph)?this.formatProcess(e,t):r["a"].isRef(e)?this.formatValue(r["a"].formatRef(e),t):"undefined"!==typeof e.west&&"undefined"!==typeof e.east&&"undefined"!==typeof e.south&&"undefined"!==typeof e.north?t>=12?"Bounding Box":"BBox":r["a"].detectGeoJson(e)?this.formatValue(e.type,t):s?'<span title="'+r["a"].htmlentities(JSON.stringify(e))+'">Object</span>':"Object"}}},y=b,w=(s("8862"),s("f0e8"),s("2877")),x=Object(w["a"])(y,f,m,!1,null,"5a1fed8a",null),S=x.exports,C=s("2b0e");const E=10;var _={name:"Block",components:{BlockParameter:S},props:{id:{type:String,required:!0},type:{type:String,required:!0},value:{type:Object,required:!0},selected:{type:Boolean,default:!1},spec:{type:Object,default:()=>null},state:{type:Object,required:!0}},data(){return{data:{},drag:null}},watch:{"state.compactMode"(){this.$emit("moved",this.position)},value:{immediate:!0,handler(e){this.data=C["a"].observable(e)}}},computed:{position:{set(e){e=r["a"].ensurePoint(e),this.$set(this.data,"position",e),this.$emit("moved",e)},get(){return r["a"].ensurePoint(this.data.position)}},args:{set(e){r["a"].isObject(this.data.arguments)||(this.data.arguments={});for(let t in this.data.arguments)"undefined"!==typeof e[t]||this.hasParametersDefined&&-1!==this.spec.parameters.findIndex(e=>e.name===t)||this.$emit("parameterRemoved",this,t);this.$set(this.data,"arguments",e),this.commit()},get(){return r["a"].isObject(this.data.arguments)?this.data.arguments:{}}},comment:{set(e){this.$set(this.data,"description",e),this.commit()},get(){return this.data.description}},result:{set(e){this.$set(this.data,"result",e),this.commit()},get(){return this.data.result||!1}},width(){return this.parameters.length>0?this.state.compactMode?110:220:this.state.compactMode?60:110},styles(){return{marginLeft:Math.round(this.state.center[0]+this.position[0]*this.state.scale)+"px",marginTop:Math.round(this.state.center[1]+this.position[1]*this.state.scale)+"px",fontSize:Math.round(this.state.scale*E)+"px",width:Math.round(this.state.scale*this.width)+"px"}},plainTitle(){return this.name+(this.showId?" #"+this.id:"")},name(){switch(this.type){case"process":return this.collectionId?this.collectionId:this.processId;case"parameter":return this.spec.name;default:return this.id}},outputLabel(){return this.result?"Result":"parameter"===this.type?"Process Parameter":""},containerClasses(){var e=["block"];return this.collectionId?e.push("block_collection"):"parameter"===this.type&&e.push("block_argument"),this.result&&e.push("block_result"),this.selected&&e.push("block_selected"),this.invalid&&e.push("block_invalid"),this.state.compactMode&&e.push("compact"),this.state.scale<.5?e.push("scale_xs"):this.state.scale<.7?e.push("scale_s"):this.state.scale<.9?e.push("scale_m"):this.state.scale<1.1&&e.push("scale_l"),e},invalid(){if("process"!==this.type||!this.$parent.hasProcesses)return!1;if(!this.processId)return!0;if(!this.spec)return!0;if("load_collection"===this.processId&&!r["a"].isRef(this.args.id)){for(let e of this.$parent.collections)if(this.args.id===e.id)return!1;return!0}return!1},processId(){if("process"===this.type){if(this.value.process_id)return this.value.process_id;if(r["a"].isObject(this.spec)&&this.spec.id)return this.spec.id}return null},collectionId(){return"process"!==this.type||"load_collection"!==this.processId||r["a"].isRef(this.args.id)?null:this.args.id},allowsParameterChange(){return this.$parent.supports("editParameters")&&this.parameters.filter(e=>e.isEditable()).length>0&&"parameter"!==this.type},allowsDelete(){return this.state.editable&&(!this.spec||r["a"].isObject(this.spec)&&"prop"!==this.spec.origin)},allowsInfo(){return this.collectionId?this.$parent.supports("showCollection"):"parameter"===this.type?r["a"].isObject(this.spec)&&this.$parent.supports("showSchema"):this.$parent.supports("showProcess")},allowsComment(){return this.state.editable&&"process"===this.type},hasComment(){return"string"===typeof this.comment},showId(){return"parameter"!==this.type},hasParametersDefined(){return Boolean(r["a"].isObject(this.spec)&&Array.isArray(this.spec.parameters)&&this.spec.parameters.length>0)},parameters(){let e=[],t=[];if(this.hasParametersDefined&&(t=this.spec.parameters.map(e=>new g["c"](e)),e=t.map(e=>e.name)),r["a"].size(this.args)>0)for(var s in this.args)e.includes(s)||t.push(new g["c"]({name:s,description:""}));return t},fields(){var e={};for(var t of this.parameters)e[t.name]=t;return e.output=this.output,e},output(){var e={};r["a"].isObject(this.spec)&&("parameter"===this.type?e=this.spec:r["a"].isObject(this.spec.returns)&&(e=this.spec.returns));var t={name:"output",schema:e.schema||{},description:e.description||"",optional:!0,output:!0,value:{}};return"parameter"===this.type?t.value.from_parameter=this.id:t.value.from_node=this.id,t}},mounted(){this.draggingFn=this.dragging.bind(this),document.addEventListener("mousemove",this.draggingFn),this.stopDragFn=this.stopDrag.bind(this),document.addEventListener("mouseup",this.stopDragFn),this.$emit("mounted",this)},beforeDestroy(){document.removeEventListener("mousemove",this.draggingFn),document.removeEventListener("mouseup",this.stopDragFn),this.$emit("unmounted",this)},methods:{commit(){this.$emit("input",this.data)},focus(){this.$parent.focus()},async onMouseDown(e){return this.$parent.unselectAll(e),await this.select(!this.selected,!1)},async select(e=!0,t=!0){return t&&this.$parent.unselectAll(),this.$emit("update:selected",e),this.focus(),await this.$nextTick(),e},getDimensions(){let e=r["a"].domBoundingBox(this.$refs.div);var t=this.$parent.getDimensions();return e.x=e.offsetLeft-t.offsetLeft,e.y=e.offsetTop-t.offsetTop,e},edgesChanged(e,t){e.setRefs(t.map(e=>e.parameter1.value))},showParameters(e=null){this.$parent.$emit("editParameters",this.parameters.filter(e=>e.isEditable()),this.args,this.plainTitle,this.state.editable,e,e=>this.args=e,this.processId,this.$parent)},showInfo(){this.collectionId?this.$parent.$emit("showCollection",this.collectionId):"parameter"===this.type?this.$parent.$emit("showSchema",this.name,this.spec.schema):this.$parent.$emit("showProcess",this.processId)},async addComment(){await this.select(),this.comment="",await this.$nextTick(),this.$refs.commentField.focus()},updateComment(e){"string"===typeof e.target.value&&e.target.value.length>0?this.comment=e.target.value:this.comment=null},async emitDrag(e){this.focus();let t=await this.onMouseDown(e);t&&this.$emit("move")},getDragPos(e){return[this.state.mouse[0]/this.state.scale-e[0],this.state.mouse[1]/this.state.scale-e[1]]},startDrag(){this.selected&&(this.drag={origin:this.position,mouse:this.getDragPos(this.position)})},stopDrag(){if(this.drag){var e=5/this.state.scale;(Math.abs(this.drag.origin[0]-this.position[0])>e||Math.abs(this.drag.origin[1]-this.position[1])>e)&&this.commit(),this.drag=null}},dragging(){this.drag&&(this.position=this.getDragPos(this.drag.mouse))},hasOutputEdges(){return this.$refs.output&&this.$refs.output.getEdgeCount()>0},async remove(){await this.$parent.removeBlock(this)},getBlockParameter(e){if("output"===e&&this.$refs.output)return this.$refs.output;if(Array.isArray(this.$refs.parameters)){var t=this.$refs.parameters.filter(t=>t.name===e);if(t.length>0)return t[0]}return null}}},k=_,P=(s("36a6"),Object(w["a"])(k,d,p,!1,null,"429bcd36",null)),T=P.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("g",e._l(e.lines,(function(t,i){return s("line",e._b({key:i},"line",t,!1))})),0)},M=[];class O{constructor(e,t,s,i){this.x=e,this.y=t,this.dx=s,this.dy=i}distance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}distanceP(e){var t=this.normal();t.x=e.x,t.y=e.y;var s=this.intersection(t);return[s[0],this.distance(t.alpha(s[1]),e)]}normal(){return new O(this.x,this.y,this.dy,-this.dx)}intersection(e){var t=this.dx,s=-e.dx,i=this.dy,a=-e.dy,r=e.x-this.x,n=e.y-this.y,o=t*a-s*i;if(0==o)return null;var l=(a*r-s*n)/o,c=(-i*r+t*n)/o;return[l,c]}alpha(e){var t={};return t.x=this.x+this.dx*e,t.y=this.y+this.dy*e,t}}var I={name:"Edge",props:{id:{type:Number,required:!0},parameter1:{type:Object,required:!0},parameter2:{type:Object,required:!0},selected:{type:Boolean,default:!1},inactive:{type:Boolean,default:!1},lineWidth:{type:Number,default:3},state:{type:Object,required:!0}},data(){return{position1:null,position2:null}},computed:{segment(){return new O(this.position1[0],this.position1[1],this.position2[0]-this.position1[0],this.position2[1]-this.position1[1])},scaledLineWidth(){return this.lineWidth*this.state.scale},lines(){var e=(this.position1[0]+this.position2[0])/2,t=(this.position1[1]+this.position2[1])/2,s=35*Math.PI/180,i=Math.cos(s),a=Math.sin(s),r=Math.cos(-s),n=Math.sin(-s),o=Math.sqrt(Math.pow(this.position1[0]-this.position2[0],2)+Math.pow(this.position1[1]-this.position2[1],2)),l=10*this.state.scale/(o/1.5),c=(this.position1[0]-e)*l,u=(this.position1[1]-t)*l,h=this.getLineStyle(this.scaledLineWidth,this.selected,this.inactive),d=this.getLineStyle(this.scaledLineWidth/1.5,this.selected),p=this.getLine(this.position1[0],this.position1[1],this.position2[0],this.position2[1],h);return this.inactive||o/this.state.scale<25?[p]:[p,this.getLine(e,t,e+(c*i-u*a),t+(u*i+c*a),d),this.getLine(e,t,e+(c*r-u*n),t+(u*r+c*n),d)]}},watch:{"state.center"(){this.updatePositions()},"state.scale"(){this.updatePositions()},"state.moving"(){this.updatePositions()}},created(){this.updatePositions()},methods:{updatePositions(){let e=this.parameter1.getCirclePosition(),t=this.parameter2.getCirclePosition();this.position1&&this.position2&&e[0]===this.position1[0]&&e[1]===this.position1[1]&&t[0]===this.position2[0]&&t[1]===this.position2[1]||(this.position1=e,this.position2=t,this.$emit("position",this.position1,this.position2))},getLineStyle(e,t=!1,s=!1){let i=2*this.state.scale;return{stroke:t?"rgba(0, 200, 0, 1)":"rgba(255, 200, 0, 1)","stroke-width":e,"stroke-dasharray":s?3*i+" "+2*i:"none"}},getLine(e,t,s,i,a={}){return Object.assign({x1:e,y1:t,x2:s,y2:i},a)},collide(e,t){if(!this.segment)return!1;var s=this.segment.distanceP({x:e,y:t});return s[0]>=0&&s[0]<=1&&s[1]<this.lineWidth*this.state.scale*2&&s[0]},equals(e){return this.parameter1==e.parameter1&&this.parameter2==e.parameter2||this.parameter1==e.parameter2&&this.parameter2==e.parameter1}}},F=I,j=Object(w["a"])(F,D,M,!1,null,null,null),B=j.exports,$=s("0dd6"),R=s.n($),A=s("a13e"),N=s.n(A);const L=function(e){return C["a"].observable({root:e,editable:!1,compactMode:!1,moving:null,selecting:null,center:[0,0],mouse:[0,0],scale:1.3,linkFrom:null,linkTo:null})},V=20,U=function(e,t){Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,s)=>e.id===t[s].id)||this.$emit("selectionChanged",this.selectedBlocks,this.selectedEdges)};var J={name:"Blocks",components:{Block:T,Edge:B},props:{id:{type:String,required:!0},editable:{type:Boolean,default:!1},value:{type:Object,default:()=>({})},collections:{type:Array,default:()=>[]},processes:{type:[Array,Object],default:()=>[]},pgParameters:{type:Array,default:()=>[]},historySize:{type:Number,default:30}},data(){return{isMounted:!1,newBlockOffset:0,history:[],historyPointer:null,process:this.value,blocks:[],edges:[],processGraph:null,nextBlockId:1,nextEdgeId:1,activeTransactions:0,state:L(this)}},computed:{selectRect(){return this.state.selecting?{x:Math.min(this.state.mouse[0],this.state.selecting[0]),y:Math.min(this.state.mouse[1],this.state.selecting[1]),width:Math.abs(this.state.mouse[0]-this.state.selecting[0]),height:Math.abs(this.state.mouse[1]-this.state.selecting[1]),stroke:"rgba(0,0,0,0.8)","stroke-width":1,fill:"rgba(0,0,0,0.05)"}:null},linkingLine(){if(this.state.linkFrom){var e=this.state.linkFrom.getCirclePosition();return{x1:e[0],y1:e[1],x2:this.state.mouse[0],y2:this.state.mouse[1],stroke:"rgba(0,0,0,0.4)","stroke-width":3*this.state.scale}}return null},processRegistry(){return this.processes instanceof v["ProcessRegistry"]?this.processes:new v["ProcessRegistry"](this.processes)},hasProcesses(){return this.processRegistry.count()>0},processBlocks(){return this.blocks.filter(e=>"process"===e.type)},selectedBlocks(){return this.blocks.filter(e=>e.selected)},selectedEdges(){return this.edges.filter(e=>e.selected)},selectedSideEdge(){return 1===this.selectedEdges.length&&this.selectedEdges[0].selectedParameter?this.selectedEdges[0]:null}},watch:{pgParameters(e){this.importPgParameters(e,"prop")},async value(e){this.isMounted&&(e instanceof z||(this.process=e,await this.import(e,{propagate:!1,undoOnError:!1})))},editable:{immediate:!0,handler(e){this.state.editable=e}},selectedEdges:U,selectedBlocks:U},async mounted(){this.supports("error")||this.$on("error",(e,t=null)=>console.error(e,t)),this.moveCenter(0,0,!0),this.onDocumentMouseUpFn=this.onDocumentMouseUp.bind(this),document.addEventListener("mouseup",this.onDocumentMouseUpFn),await this.importPgParameters(this.pgParameters,"prop"),await this.import(this.value,{propagate:!1,undoOnError:!1})||this.perfectScale(),U.bind(this)(),this.isMounted=!0},beforeDestroy(){document.removeEventListener("mouseup",this.onDocumentMouseUpFn)},methods:{mountBlock(e){this.setBlockElement(e,e)},unmountBlock(e){this.setBlockElement(e,null)},parameterRemoved(e,t){for(let s of this.edges)s.parameter2.$parent===e&&s.parameter2.name===t&&this.removeEdge(s)},setBlockElement(e,t){for(var s of this.blocks)if(s.id===e.id)return void(s.$el=t)},startDragBlock(){for(let e in this.blocks)this.blocks[e].$el&&this.blocks[e].$el.startDrag()},refreshEdges(){for(let e in this.$refs.edges)this.$refs.edges[e].updatePositions()},supports(e){return this.$listeners&&this.$listeners[e]},focus(){this.$refs.div.focus()},highlight(e){e?this.$refs.div.classList.add("focus"):this.$refs.div.classList.remove("focus")},link(e){this.state.linkFrom?this.state.linkTo=e:this.state.linkFrom=e},unlink(e=null){e?this.state.linkTo==e?this.state.linkTo=null:this.state.linkFrom==e&&(this.state.linkFrom=null):(this.state.linkTo=null,this.state.linkFrom=null)},multiSelect(){let e=this.selectRect;this.blocks.filter(t=>{if(Array.isArray(t.value.position)&&t.$el){let s=t.$el.getDimensions();return R()(e.x,e.y,e.width,e.height,s.x,s.y,s.width,s.height)}return!1}).map(e=>e.selected=!0),this.edges.filter(t=>Array.isArray(t.position1)&&Array.isArray(t.position2)&&N()(e.x,e.y,e.width,e.height,t.position1[0],t.position1[1],t.position2[0],t.position2[1])).map(e=>e.selected=!0)},async onDocumentMouseUp(e){if(this.selectedSideEdge&&this.selectEdge(this.selectedSideEdge,null,null,null),this.state.selecting&&(this.multiSelect(),this.state.selecting=null),this.state.moving&&(this.state.moving=null),this.state.editable&&this.state.linkFrom){if(1==e.which&&this.state.linkTo)try{await this.addEdge(this.state.linkFrom,this.state.linkTo)}catch(t){this.$emit("error",t)}this.unlink()}},onKeyDown(e){var t=document.querySelectorAll("input, textarea, button, select, datalist");for(let s of t)if(s===document.activeElement)return;this.state.editable&&46==e.keyCode&&this.deleteSelected()},onMouseWheel(e){var t=this.state.mouse[0]-this.state.center[0],s=this.state.mouse[1]-this.state.center[1],i=Math.pow(1.1,-1*Math.sign(e.deltaY));this.moveCenter(-t*(i-1),-s*(i-1)),this.state.scale*=i},onMouseMove(e){try{var t=this.getDimensions(),s=e.pageX-t.offsetLeft,i=e.pageY-t.offsetTop;if(this.state.mouse=[s,i],this.state.editable&&this.selectedSideEdge){var a=this.selectedSideEdge.selectedPosition,r=Math.sqrt(Math.pow(s-a[0],2)+Math.pow(i-a[1],2));r>10&&(this.link(this.selectedSideEdge.selectedParameter),this.removeEdge(this.selectedSideEdge),this.commit())}this.state.moving&&(this.moveCenter(s-this.state.moving[0],i-this.state.moving[1]),this.state.moving=this.state.mouse)}catch(n){console.log(n)}},onMouseDown(e){let t=null;if(1==e.which&&e.shiftKey)this.state.selecting=this.state.mouse;else if(1==e.which)for(var s in this.unselectAll(e),this.$refs.edges){var i=this.$refs.edges[s],a=i.collide(this.state.mouse[0],this.state.mouse[1]);if(0!=a){0===this.selectedEdges.length&&(a<.3?t=i.parameter2:a>.7&&(t=i.parameter1)),this.selectEdge(s,!0,e,t),e.preventDefault();break}}2!=e.which&&(1!=e.which||t||e.shiftKey)||(this.state.moving=this.state.mouse),this.focus()},getDimensions(){return r["a"].domBoundingBox(this.$refs.div)},async clear(){return await this.startTransaction(async()=>(this.edges=[],this.blocks=this.blocks.filter(e=>"parameter"===e.type&&r["a"].isObject(e.spec)&&"prop"===e.spec.origin),this.nextBlockId=1,this.nextEdgeId=1,this.process={},!0))},commit(e=null,t=!0,s=!0){this.activeTransactions>0||(!1!==t&&this.saveHistory(),!1!==s&&this.$emit("input",null===e?this.export():e))},saveHistory(){var e=this.export(!0);this.history.splice(this.historyPointer+1,this.historySize,e),this.history.length>this.historySize&&this.history.shift(),this.historyPointer=this.history.length-1,this.$emit("historyChanged",this.history,this.historyPointer)},async undo(){await this.historyStep(-1)},async redo(){await this.historyStep(1)},async historyStep(e){var t=this.historyPointer+e,s=this.history[t];s&&(this.historyPointer=t,this.import(s,{saveHistory:!1,undoOnError:!1,perfectScale:!1}),this.$emit("historyChanged",this.history,this.historyPointer))},setResultNode(e,t=!0){if(e=this.getBlockById(e.id),e&&e.value.result!==t){var s=(e,t)=>{this.$set(e.value,"result",t),this.commit()};s(e,t);var i=!1,a=!1;for(var r of this.processBlocks)if(!e||r.id!==e.id)if(a=!0,t)s(r,!1);else if(r.$el&&!r.$el.hasOutputEdges()){s(r,!0),i=!0;break}!a||t||i||this.$emit("error","No result node available, please specify one.")}},getPositionForPageXY(e,t){var s=this.getDimensions();return null!==e&&(e=(e-s.offsetLeft-this.state.center[0])/this.state.scale),null!==t&&(t=(t-s.offsetTop-this.state.center[1])/this.state.scale),[e,t]},addProcess(e,t={},s=[],i={}){return this.addBlock(Object.assign({process_id:e,arguments:t,position:s},i))},addBlock(e,t=null){var s={id:String(this.incrementId(t)),type:"process",selected:!1,value:"function"===typeof e.toJSON?e.toJSON():e};this.processRegistry&&(s.spec=this.processRegistry.get(e.process_id));var i=this.getBlockSize(s);return s.value.position=r["a"].ensurePoint(s.value.position,()=>this.getNewBlockDefaultPosition(i)),s.value.result&&this.blocks.filter(e=>!0===e.value.result).length?delete s.value.result:0===this.processBlocks.length&&(s.value.result=!0),this.blocks.push(C["a"].observable(s)),this.commit(),s},getNewBlockDefaultPosition(e){var t=this.getDimensions(),s=[(-this.state.center[0]+t.width/2)/this.state.scale-e[0]/2+this.newBlockOffset,(-this.state.center[1]+t.height/2)/this.state.scale-e[1]/2+this.newBlockOffset];return this.newBlockOffset<150&&(this.newBlockOffset+=10),s},getBlockSize(e){if(e.$el){let t=e.$el.getDimensions();return[t.width/this.state.scale,t.height/this.state.scale]}var t,s=Math.max(r["a"].isObject(e.value)?r["a"].size(e.value.arguments):0,r["a"].isObject(e.spec)?r["a"].size(e.spec.parameters):0);t=s>0?this.state.compactMode?110:220:this.state.compactMode?60:110;var i=r["a"].isObject(e.value)&&"string"===typeof e.value.description?40:0,a=V+15*s+i;return[t,a]},moveCenter(e,t,s=!1){var i=this.getDimensions();this.state.center=[(s?i.width/2:this.state.center[0])+e,(s?i.height/2:this.state.center[1])+t],this.newBlockOffset=0},unselectAll(e=null){if(!e||!e.shiftKey){for(var t in this.blocks)this.$set(this.blocks[t],"selected",!1);for(var t in this.edges)this.selectEdge(t,!1)}},selectEdge(e,t=!0,s=null,i=null){s&&this.unselectAll(s),r["a"].isObject(e)||(e=this.edges[e]),null!==t&&this.$set(e,"selected",t),this.$set(e,"selectedParameter",i),this.$set(e,"selectedPosition",i?this.state.mouse:null)},removeEdge(e){e.parameter1.eraseEdge(e),e.parameter2.eraseEdge(e),this.$delete(this.edges,this.edges.indexOf(e))},hiddenParameterRefs(e,t){if("process"!==e.type)return null;for(let s in e.value.arguments){let i=e.value.arguments[s];if(r["a"].isObject(i)&&r["a"].isObject(i.process_graph)){let e=v["Utils"].getRefs(i,!0,!0);if(e.find(e=>e.from_parameter===t))return s}}return null},async removeBlock(e){if("parameter"===e.type){let t=null,s=this.blocks.find(s=>(t=this.hiddenParameterRefs(s,e.id),null!==t));if(s)throw new Error(`Parameter is still used in '#${s.id}', parameter '${t}'. Only unused parameters can be deleted.`)}return await this.startTransaction(async()=>{var t=this.blocks.findIndex(t=>t.id==e.id);if(t<0)return!1;for(var s of this.edges.slice(0))s.parameter1.$parent.id!==e.id&&s.parameter2.$parent.id!==e.id||this.removeEdge(s);return e.value.result&&this.setResultNode(e,!1),this.$delete(this.blocks,t),!0})},getBlockById(e){var t=this.blocks.filter(t=>t.id===e);return t.length>0?t[0]:null},async deleteSelected(){return(0!==this.selectedBlocks.length||0!==this.selectedEdges.length)&&await this.startTransaction(async()=>{for(var e of this.selectedBlocks.slice(0))e.$el.allowsDelete&&this.removeBlock(e);for(var t of this.selectedEdges.slice(0))this.removeEdge(t);return!0})},async addEdgeByNames(e,t,s,i){var a=[];for(var r of[e,s]){var n=this.getBlockById(r);if(!n)throw"Can't find block: "+r;if(!n.$el)throw"Block not mounted yet: "+r;a.push(n.$el)}await this.addEdge(a[0].getBlockParameter(t),a[1].getBlockParameter(i))},async addEdge(e,t){if(!e||!t)throw"One of the parameters is invalid.";if(e!=t){if(e.$parent==t.$parent)throw"You can't link a block to itself";var s=this.nextEdgeId++,i={id:s,selected:!1,inactive:!1};if(e.output?(i.parameter1=e,i.parameter2=t):(i.parameter1=t,i.parameter2=e),!i.parameter1.output)throw"You have to link an input with an output";if(-1!==this.allSuccessors(i.parameter1).indexOf(i.parameter2.id))throw"You can not create a loop";if(!v["JsonSchemaValidator"].isSchemaCompatible(i.parameter2.schema||{},i.parameter1.schema||{},!1,!0))throw'Incoming data type is not compatible for parameter "'+i.parameter2.name+'"';if(i.parameter2.getEdgeCount()>0&&!i.parameter2.allowsMultipleInputs)throw"Parameter accepts only one input";for(var a in this.$refs.edges)if(this.$refs.edges[a].equals(i))throw"This connection exists already";return await this.startTransaction(async()=>(this.unlink(),this.edges.push(C["a"].observable(i)),i.parameter1.addEdge(i),i.parameter2.addEdge(i),this.setResultNode(i.parameter1.$parent,!1),!0))}},allSuccessors(e){var t=e.$parent,s={},i=[t];s[t.id]=!0;while(i.length>0){var a=i.pop();for(var r in a.edges)for(var n in a.edges[r]){var o=a.edges[r][n];if(o.block1==a){var l=o.block2;l.id in s||(s[l.id]=!0,i.push(l))}}}return Object.values(s)},async toggleCompact(){this.state.compactMode=!this.state.compactMode,this.$emit("compactMode",this.state.compactMode),await this.$nextTick(),this.refreshEdges()},export(e=!1){var t={};for(var s of this.processBlocks){let i=r["a"].deepClone(s.value);e||delete i.position,null===i.description&&delete i.description,!0!==i.result&&delete i.result,t[s.id]=i}return new z(Object.assign({},this.process,{process_graph:t}))},async startTransaction(e,t={},...s){let i;this.activeTransactions++;try{i=await e(s)}catch(a){if(this.$emit("error",a,"Model is invalid"),console.log(a),!1!==t.undoOnError)try{await this.undo()}catch(r){this.$emit("error",a,"Revert failed"),console.log(a)}i=!1}return this.activeTransactions--,this.commit(null,t.saveHistory,t.propagate),i},async import(e,t={}){return await this.startTransaction(async()=>(!1!==t.clear&&(await this.clear(),this.process=e instanceof v["ProcessGraph"]?e.toJSON():e),!!r["a"].isObject(e)&&(e instanceof v["ProcessGraph"]?(this.processGraph=new v["ProcessGraph"](e.toJSON(),this.processRegistry),this.processGraph.setParent(e.parentProcessId,e.parentParameterName)):this.processGraph=new v["ProcessGraph"](e,this.processRegistry),this.processGraph.allowEmpty(),this.processGraph.parse(),await this.importPgParameters(this.processGraph.getProcessParameters(),"pg",!1!==t.clear),await this.importNodes(this.processGraph.getStartNodes()),await this.importEdges(this.processGraph),!1!==t.perfectScale&&this.perfectScale(),!0)),t)},async importPgParameters(e,t,s=!0){if(!Array.isArray(e))return;s&&(this.blocks=this.blocks.filter(e=>"parameter"!==e.type||e.spec.origin!==t));let i=this.getBlockSize({}),a=[0,0];for(var r in e)a=[-i[0]-V,r*(i[1]+V)],this.addPgParameter(e[r],t,a);await this.$nextTick()},addPgParameter(e,t="user",s=null){this.blocks.findIndex(t=>"parameter"===t.type&&t.id==e.name)>=0||(e=r["a"].deepClone(e),"undefined"===typeof e.schema&&(e.schema={}),e.origin=t,this.blocks.push(C["a"].observable({id:e.name,type:"parameter",value:{from_parameter:e.name,position:r["a"].ensurePoint(s,()=>this.getNewBlockDefaultPosition(this.getBlockSize({})))},spec:e})))},getPgParameters(){return this.blocks.filter(e=>"parameter"===e.type)},async importEdges(e){var t=e.getNodes();for(var s of Object.values(t)){var i=s.getArgumentNames();for(let t in i){var a=s.getRawArgument(i[t]);switch(s.getArgumentType(i[t])){case"result":await this.addEdgeByNames(e.getNode(a.from_node).id,"output",s.id,i[t],!1);break;case"parameter":await this.addEdgeByNames(a.from_parameter,"output",s.id,i[t],!1);break;case"object":case"array":await this.importEdgeDeep(a,e,s,i,t);break}}}},async importEdgeDeep(e,t,s,i,a){for(let n in e)if(e[n]&&"object"===typeof e[n]&&"process_graph"!==n)await this.importEdgeDeep(e[n],t,s,i,a);else{if(!r["a"].isRef(e))continue;e.from_node?await this.addEdgeByNames(t.getNode(e.from_node).id,"output",s.id,i[a],!1):e.from_parameter&&await this.addEdgeByNames(e.from_parameter,"output",s.id,i[a],!1)}},async importNodes(e,t=0,s=0,i=[]){let a=0===i.length,n=[],o=0;for(let l of e){if(i.includes(l.id)||void 0!==l.getPreviousNodes().find(e=>!i.includes(e.id))){s+=V/2;continue}let e="function"===typeof l.toJSON?l.toJSON():l;e.position=r["a"].ensurePoint(e.position,()=>[t,s]);let a=this.addBlock(e,l.id);i.push(l.id);let c=this.getBlockSize(a);o=Math.max(o,e.position[0]+c[0]),s=e.position[1]+c[1]+V,n=n.concat(l.getNextNodes())}n.length&&await this.importNodes(n,o+V,0,i),a&&await this.$nextTick()},incrementId(e=null){"number"===typeof e||"string"===typeof e&&0!==e.length||(e=this.nextBlockId,this.nextBlockId++);let t=Number.parseInt(e);return Number.isNaN(t)||(this.nextBlockId=Math.max(this.nextBlockId,t+1)),e},perfectScale(){if(this.$refs.div&&0!==this.blocks.length){var e=null,t=null,s=null,i=null;for(let a in this.blocks){let n=this.blocks[a],o=this.getBlockSize(n),l=r["a"].ensurePoint(n.value.position);null==e?(e=l[0]-15,t=l[0]+o[0]+15,s=l[1]-15,i=l[1]+o[1]+15):(e=Math.min(e,l[0]-15),t=Math.max(t,l[0]+o[0]+15),s=Math.min(s,l[1]-15),i=Math.max(i,l[1]+o[1]+15))}var a=this.$refs.div.getBoundingClientRect(),n=a.width/(t-e),o=a.height/(i-s);this.state.scale=Math.min(n,o,1.5),this.state.center=[a.width/2-this.state.scale*(e+t)/2,a.height/2-this.state.scale*(s+i)/2],this.newBlockOffset=0}}}};class z{constructor(e){Object.assign(this,e)}}var X=J,Y=(s("751a"),Object(w["a"])(X,u,h,!1,null,"08c86812",null)),H=Y.exports,G=s("cbd9"),q=s("c2dc"),W=s("3115"),K=s("5472"),Z={name:"VisualEditor",mixins:[W["a"]],components:{Blocks:H,DiscoveryToolbar:G["a"],ParameterModal:q["default"],FullscreenButton:K["a"],ExpressionModal:()=>s.e("chunk-65c369a9").then(s.bind(null,"3d5e"))},props:{id:String,editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},pgParameters:{type:Array,default:()=>[]},showDiscoveryToolbar:{type:Boolean,default:!1},title:{type:String},defaultValue:{}},computed:{...r["a"].mapState(["collections"]),...r["a"].mapGetters(["processRegistry"]),...r["a"].mapGetters("userProcesses",["supportsMath","isMathProcess"])},data(){return{canUndo:!1,canRedo:!1,compactMode:!1,hasSelection:!1,isMath:!1,isFullScreen:!1}},watch:{value(e){this.isMath=this.isMathProcess(e)}},methods:{...r["a"].mapActions("userProcesses",{readUserProcess:"read"}),commit(e){"undefined"!==typeof this.defaultValue&&r["a"].isObject(e)&&0===r["a"].size(e.process_graph)&&(e=this.defaultValue),this.$emit("input",e)},errorHandler(e,t=null){r["a"].exception(this,e,t)},selectionChanged(e,t){this.hasSelection=Boolean(e.filter(e=>e.$el.allowsDelete).length||t.length)},historyChanged(e,t){this.canUndo=!!e[t-1],this.canRedo=!!e[t+1]},allowDrop(e){e.preventDefault()},onDrop(e){var t=e.dataTransfer.getData("application/openeo-node");if(t){e.preventDefault();let s=JSON.parse(t);this.insertProcess(s,e.pageX,e.pageY)}},addParameter(){var e=[{name:"name",label:"Parameter name",schema:{type:"string"},default:null}];this.emit("showDataForm","Add Parameter",e,e=>{"string"===typeof e.name&&e.name.length>0&&this.$refs.blocks.addPgParameter(e)})},showSchemaModal(e,t){this.emit("showSchema",e,t)},showExpressionModal(){this.$refs.expressionModal.show(this.value,this.$refs.blocks.getPgParameters())},openParameterEditor(e,t,s="Edit",i=!0,a=null,r=null,n=null,o=null){this.$refs.parameterModal.show(s,e,t,i,r,null,n,a,o)},confirmClear(){var e=confirm("Do you really want to clear the existing model?");e&&this.clear()},clear(){this.$refs.blocks&&this.$refs.blocks.clear(),this.commit(null)},insertProcess(e,t=null,s=null){try{var i=this.$refs.blocks.getPositionForPageXY(t,s);this.$refs.blocks.addProcess(e.process_id,e.arguments,i)}catch(a){r["a"].exception(this,a)}},async insertNodes(e,t=!1){return await this.$refs.blocks.import({process_graph:e},{clear:t})}}},Q=Z,ee=(s("4d982"),Object(w["a"])(Q,l,c,!1,null,null,null)),te=ee.exports,se=s("0f29"),ie={name:"Editor",components:{VisualEditor:te,TextEditor:se["a"],Tabs:n["default"],Tab:o["default"]},props:{id:String,editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},title:{type:String},pgParameters:{type:Array,default:()=>[]},showDiscoveryToolbar:{type:Boolean,default:!1},defaultValue:{}},watch:{value(){this.updateTab()}},data(){return{modelValue:null,codeValue:null,error:null}},mounted(){this.updateTab()},computed:{...r["a"].mapGetters("userProcesses",{getProcessById:"getAllById"})},methods:{showModel(){this.error=null,this.modelValue=this.value},showCode(){this.error=null,this.codeValue=this.value,this.$refs.sourceEditor.updateState()},updateTab(){"source"===this.$refs.tabs.getActiveTabId()?this.showCode():this.showModel()},commit(e){this.error=null,this.$emit("input",e)},onError(e){this.error=e},activeEditor(){return"source"===this.$refs.tabs.getActiveTabId()?this.$refs.sourceEditor:this.$refs.graphBuilder},async insertProcess(e){try{let t=this.getProcessById(e.process_id);null==t||t.native||await this.readUserProcess({data:t}),this.activeEditor().insertProcess(e)}catch(t){r["a"].exception(this,t)}},canSwitchView(){return!this.editable||null===this.error||(r["a"].exception(this,this.error,"Process Invalid Error"),!1)}}},ae=ie,re=(s("b16a"),Object(w["a"])(ae,i,a,!1,null,null,null));t["default"]=re.exports},da12:function(e,t,s){},dbb6:function(e,t,s){},dc31:function(e,t,s){},de39:function(e,t,s){},ded2:function(e,t,s){},e606:function(e,t,s){},ebe9:function(e,t,s){},ed22:function(e,t){
/*! http://mths.be/repeat v0.2.0 by @mathias */
String.prototype.repeat||function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,s=t(e,e,e)&&t}catch(i){}return s}(),t=function(e){if(null==this)throw TypeError();var t=String(this),s=e?Number(e):0;if(s!=s&&(s=0),s<0||s==1/0)throw RangeError();var i="";while(s)s%2==1&&(i+=t),s>1&&(t+=t),s>>=1;return i};e?e(String.prototype,"repeat",{value:t,configurable:!0,writable:!0}):String.prototype.repeat=t}()},f0e8:function(e,t,s){"use strict";s("e606")},f14d:function(e,t,s){"use strict";s("9512")},f3db:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"wrapper"}},[i("div",{attrs:{id:"ide"},on:{mouseup:function(t){return e.stopMovingSeparator(t)},mousemove:function(t){return e.moveSeparator(t)}}},[i("header",{staticClass:"navbar"},[i("div",{staticClass:"logo"},[i("img",{attrs:{src:s("cf05"),alt:"openEO"}}),i("h2",[e._v("Web Editor "),i("span",{staticClass:"version",on:{click:e.showWebEditorInfo}},[e._v(e._s(e.version))])])]),i("ul",{attrs:{id:"menu"}},[i("li",[i("div",{staticClass:"menuItem",attrs:{title:"Get server information"},on:{click:e.showServerInfo}},[i("i",{staticClass:"fas fa-info fa-fw"}),e._v(" Server")])]),i("li",[i("UserMenu")],1)])]),i("main",{staticClass:"page"},[i("div",{ref:"discovery",attrs:{id:"discovery"}},[i("DiscoveryToolbar",{staticClass:"toolbar",attrs:{onAddProcess:e.insertProcess}})],1),i("hr",{ref:"separator0",staticClass:"separator",on:{dblclick:function(t){return e.centerSeparator(t,0)},mousedown:function(t){return e.startMovingSeparator(t,0)}}}),i("div",{ref:"workspace",attrs:{id:"workspace"}},[i("Editor",{ref:"editor",staticClass:"mainEditor",attrs:{id:"main",value:e.process,title:e.contextTitle},on:{input:e.updateEditor},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[i("button",{directives:[{name:"show",rawName:"v-show",value:e.saveSupported,expression:"saveSupported"}],attrs:{type:"button",title:"Save to "+e.contextTitle},on:{click:e.saveProcess}},[i("i",{staticClass:"fas fa-save"})])]},proxy:!0}])}),e.isAuthenticated?i("UserWorkspace",{staticClass:"userContent"}):e._e()],1),i("hr",{ref:"separator1",staticClass:"separator",on:{dblclick:function(t){return e.centerSeparator(t,1)},mousedown:function(t){return e.startMovingSeparator(t,1)}}}),i("div",{ref:"viewer",attrs:{id:"viewer"}},[i("Viewer")],1)])]),i("CollectionModal",{ref:"collectionModal"}),i("ProcessModal",{ref:"processModal"}),i("ServerInfoModal",{ref:"serverInfoModal"}),i("ServiceInfoModal",{ref:"serviceModal"}),i("JobInfoModal",{ref:"jobModal"}),i("ParameterModal",{ref:"parameterModal"}),i("SchemaModal",{ref:"schemaModal"}),i("UdfRuntimeModal",{ref:"udfRuntimeModal"}),i("FileFormatModal",{ref:"fileFormatModal"}),i("JobEstimateModal",{ref:"jobEstimateModal"})],1)},a=[],r=s("9224"),n=s("3115"),o=s("025e"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"UserMenu"}},[s("div",{staticClass:"menuItem"},[e._m(0),s("div",{staticClass:"data"},[s("span",{staticClass:"name nowrap"},[s("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.userName))]),e.budget?s("span",{staticClass:"credits nowrap"},[s("i",{staticClass:"fas fa-dollar-sign fa-fw"}),e._v(" "+e._s(e.budget))]):e._e(),e.hasStorage?s("span",{staticClass:"storage nowrap"},[s("i",{staticClass:"fas fa-database fa-fw"}),e._v(" "+e._s(e.storageUsedPercent)+"% used")]):e._e()])]),s("div",{staticClass:"dropdown"},[s("div",{staticClass:"item"},[e._v(" Welcome, "+e._s(e.userName)+"! ")]),e.hasStorage?s("div",{staticClass:"item"},[s("h4",[e._v("Storage")]),s("div",{staticClass:"storagePercent"},[s("div",{staticClass:"used",style:"width: "+e.storageUsedPercent+"%"})]),s("div",{staticClass:"nowrap"},[e._v("Used "+e._s(e.formatMegabyte(e.storageUsed))+" of "+e._s(e.formatMegabyte(e.userInfo.storage.quota))+".")])]):e._e(),e._l(e.links,(function(t,i){return s("div",{key:i,staticClass:"item"},[s("a",{attrs:{href:t.href,target:"_blank",rel:t.rel}},[e._v(e._s(t.title))])])})),s("div",{staticClass:"item"},[s("button",{staticClass:"navButton",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.logout.apply(null,arguments)}}},[s("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" Logout")])])],2)])},c=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"down"},[s("i",{staticClass:"fas fa-chevron-down"})])}],u={name:"UserMenu",computed:{...o["a"].mapState(["userInfo"]),...o["a"].mapGetters(["currency"]),links(){return o["a"].friendlyLinks(this.userInfo.links)},hasStorage(){return o["a"].isObject(this.userInfo.storage)&&"number"===typeof this.userInfo.storage.quota&&"number"===typeof this.userInfo.storage.free},budget(){return o["a"].formatBudget(this.userInfo.budget,this.currency)},userName(){return"string"===typeof this.userInfo.name?this.userInfo.name:"string"===typeof this.userInfo.user_id?this.userInfo.user_id:"Guest"},storageUsed(){return this.hasStorage?this.userInfo.storage.quota-this.userInfo.storage.free:null},storageUsedPercent(){return this.hasStorage?Math.round(this.storageUsed/this.userInfo.storage.quota*100):null}},methods:{...o["a"].mapActions({logoutServer:"logout"}),...o["a"].mapMutations("editor",{resetEditor:"reset"}),async logout(){await this.logoutServer(),this.resetEditor()},formatMegabyte(e){var t=1073741824;return e>t?Math.round(e/t)+" GB":Math.round(e/1048576)+" MB"}}},h=u,d=(s("a89b"),s("2877")),p=Object(d["a"])(h,l,c,!1,null,"078435c4",null),f=p.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tabs",{ref:"tabs",attrs:{id:"userContent"}},[e.showJobs?s("Tab",{attrs:{id:"jobs",name:"Batch Jobs",icon:"fa-tasks"},on:{show:e.onShow,hide:e.onHide}},[s("JobPanel")],1):e._e(),e.showServices?s("Tab",{attrs:{id:"services",name:"Web Services",icon:"fa-cloud"},on:{show:e.onShow,hide:e.onHide}},[s("ServicePanel")],1):e._e(),e.showCustomProcesses?s("Tab",{attrs:{id:"customProcesses",name:"Custom Processes",icon:"fa-sitemap"},on:{show:e.onShow,hide:e.onHide}},[s("CustomProcessPanel")],1):e._e(),e.showFiles?s("Tab",{attrs:{id:"files",name:"Files",icon:"fa-file"},on:{show:e.onShow,hide:e.onHide}},[s("FilePanel")],1):e._e()],1)},g=[],v=s("e7ea"),b=s("bdb2"),y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"FilePanel"},on:{dragenter:function(t){return e.dropZoneInfo(!0)},dragleave:function(t){return e.dropZoneInfo(!1)},drop:function(t){return e.uploadFiles(t)},dragover:function(t){return e.allowDrop(t)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showUploadDropHint,expression:"showUploadDropHint"}],staticClass:"dropZone"},[e._v("To upload files, drop them here.")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],staticClass:"addFile"},[s("input",{ref:"uploadUserFile",staticClass:"uploadUserFile",attrs:{type:"file",name:"uploadUserFile",multiple:""},on:{change:e.uploadFiles}})]),s("div",{staticClass:"percent"},[s("div",{staticClass:"used",class:{error:e.uploadErrored},style:"width: "+this.uploadProgress+"%; opacity: "+this.uploadFadeOut})]),s("DataTable",{ref:"table",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Download"},on:{click:function(s){return e.downloadFile(t.row)}}},[s("i",{staticClass:"fas fa-download"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteFile(t.row)}}},[s("i",{staticClass:"fas fa-trash"})])]}}])})],1)},w=[],x=s("2f5c"),S=(e,t,s)=>({components:{DataTable:x["a"]},data(){return{columns:{},syncTimer:null,lastSyncTime:null}},mounted(){this.updateData()},beforeDestroy(){this.stopSyncTimer()},computed:{...o["a"].mapState(e,{data:e}),...o["a"].mapGetters(e,["supportsList","supportsCreate","supportsRead","supportsUpdate","supportsDelete"])},methods:{...o["a"].mapActions(e,["list","create","read","update","delete"]),getTable(){return this.$refs&&this.$refs.table?this.$refs.table:null},onShow(){this.updateData(),this.startSyncTimer()},onHide(){this.stopSyncTimer()},startSyncTimer(){this.supportsList&&null===this.syncTimer&&(this.syncTimer=setInterval(this.updateData,this.getSyncInterval()))},stopSyncTimer(){null!==this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)},getSyncInterval(){return 60*this.$config.dataRefreshInterval*1e3},refreshElement(e,s=null){var i=Object.assign({},e);this.read({data:e}).then(e=>{"function"===typeof s&&s(e,i)}).catch(e=>o["a"].exception(this,e,"Load "+t+" error"))},updateData(){var e=this.getTable(),i=Date.now()-this.getSyncInterval();if(e&&!(this.lastSyncTime>i))if(this.supportsList)if(this.supportsCreate){var a=this.data.length>0;a||e.setNoData("Loading "+s+"..."),this.lastSyncTime=Date.now(),this.list().then(s=>{0==s.length&&e.setNoData("Add your first "+t+" here...")}).catch(t=>{a?console.log(t):e.setNoData(t)})}else e.setNoData("Sorry, this feature is not supported by the server.");else e.setNoData("Sorry, listing stored "+s+" is not supported by the server.")}}}),C={name:"FilePanel",mixins:[S("files","file","files")],data(){return{columns:{path:{name:"Path",primaryKey:!0,sortFn:o["a"].sortByPath,sort:"asc"},size:{name:"Size",format:"FileSize",filterable:!1},modified:{name:"Last modified",format:"Timestamp"},actions:{name:"Actions",filterable:!1,sort:!1}},uploadProgress:0,uploadProgressPerFile:[],uploadErrored:!1,uploadFadeOut:1,showUploadDropHint:0}},watch:{uploadProgressPerFile:{deep:!0,handler(){this.uploadProgress=this.uploadProgressPerFile.reduce((e,t)=>e+t,0)/this.uploadProgressPerFile.length,this.uploadProgress>99.9999&&this.finishAllUploads()}}},methods:{allowDrop(e){this.supportsCreate&&(e.preventDefault(),e.stopPropagation())},dropZoneInfo(e){this.showUploadDropHint+=e?1:-1},uploadFiles(e){this.showUploadDropHint=0;var t=[];if(e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length?(t=e.dataTransfer.files,e.preventDefault(),e.stopPropagation()):e.target&&e.target.files&&e.target.files.length&&(t=e.target.files),this.supportsCreate)if(0!==t.length){this.uploadProgressPerFile=[],this.uploadProgress=0,this.uploadErrored=!1;for(let e=0;e<t.length;e++)this.uploadFile(t[e],e)}else o["a"].info(this,"Please select files to upload.");else o["a"].error(this,"Uploading files is not supported.")},uploadFile(e,t){this.uploadProgressPerFile.push(0),"string"===typeof e.name&&this.create({parameters:[e,null,e=>this.$set(this.uploadProgressPerFile,t,e)]}).then(s=>{this.$set(this.uploadProgressPerFile,t,100),o["a"].ok(this,"File upload completed.",e.name)}).catch(t=>{console.error(t),o["a"].exception(this,t,"Upload File Error: "+e.name)})},finishAllUploads(){this.$refs.uploadUserFile.value="";var e=setInterval(()=>{this.uploadFadeOut-=.05,this.uploadFadeOut<0&&(this.uploadProgress=0,this.uploadFadeOut=1,clearInterval(e))},100)},downloadFile(e){o["a"].info(this,"File requested. Please wait..."),e.downloadFile(e.path)},deleteFile(e){this.delete({data:e}).catch(t=>o["a"].exception(this,t,"Delete File Error: "+e.path))}}},E=C,_=(s("9961"),Object(d["a"])(E,y,w,!1,null,null,null)),k=_.exports,P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("DataTable",{ref:"table",staticClass:"JobPanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(s){return e.showJobInfo(t.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("estimateJob"),expression:"supports('estimateJob')"}],attrs:{title:"Estimate"},on:{click:function(s){return e.estimateJob(t.row)}}},[s("i",{staticClass:"fas fa-file-invoice-dollar"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate&&e.isJobInactive(t.row),expression:"supportsUpdate && isJobInactive(p.row)"}],attrs:{title:"Edit metadata"},on:{click:function(s){return e.editMetadata(t.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead&&e.isJobInactive(t.row),expression:"supportsRead && isJobInactive(p.row)"}],attrs:{title:"Edit process"},on:{click:function(s){return e.showInEditor(t.row)}}},[s("i",{staticClass:"fas fa-project-diagram"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteJob(t.row)}}},[s("i",{staticClass:"fas fa-trash"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("startJob")&&e.isJobInactive(t.row),expression:"supports('startJob') && isJobInactive(p.row)"}],attrs:{title:"Start processing"},on:{click:function(s){return e.queueJob(t.row)}}},[s("i",{staticClass:"fas fa-play-circle"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("stopJob")&&e.isJobActive(t.row),expression:"supports('stopJob') && isJobActive(p.row)"}],attrs:{title:"Cancel processing"},on:{click:function(s){return e.cancelJob(t.row)}}},[s("i",{staticClass:"fas fa-stop-circle"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("downloadResults")&&e.hasResults(t.row),expression:"supports('downloadResults') && hasResults(p.row)"}],attrs:{title:"Download"},on:{click:function(s){return e.downloadResults(t.row)}}},[s("i",{staticClass:"fas fa-download"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("downloadResults")&&e.hasResults(t.row),expression:"supports('downloadResults') && hasResults(p.row)"}],attrs:{title:"View results"},on:{click:function(s){return e.viewResults(t.row,!0)}}},[s("i",{staticClass:"fas fa-eye"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("debugJob"),expression:"supports('debugJob')"}],attrs:{title:"View logs"},on:{click:function(s){return e.showLogs(t.row)}}},[s("i",{staticClass:"fas fa-bug"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new job for batch processing"},on:{click:function(t){return e.createJobFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),e._v(" Create")]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("computeResult"),expression:"supports('computeResult')"}],attrs:{title:"Run process and view results synchronously"},on:{click:e.executeProcess}},[s("i",{staticClass:"fas fa-play"}),e._v(" Run now")])])],2)},T=[],D=s("2b70");const M=S("jobs","batch job","batch jobs");var O={name:"JobPanel",mixins:[M,n["a"]],data(){return{columns:{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Title",computedValue:e=>o["a"].getResourceTitle(e),edit:this.updateTitle},status:{name:"Status",stylable:!0},created:{name:"Submitted",format:"Timestamp",sort:"desc"},updated:{name:"Last update",format:"Timestamp"},actions:{name:"Actions",filterable:!1,sort:!1}},watchers:{},jobUpdater:null}},mounted(){this.listen("replaceProcess",this.replaceProcess)},computed:{...o["a"].mapGetters(["supports","supportsBilling","supportsBillingPlans"]),...o["a"].mapState("editor",["process"])},watch:{data:{handler:function(e){this.watchers={};for(let t of e)switch(t.status.toLowerCase()){case"running":case"queued":this.watchers[t.id]=t;break}},deep:!0}},methods:{...o["a"].mapActions("jobs",["queue","cancel"]),startSyncTimer(){M.methods.startSyncTimer.call(this),this.jobUpdater=setInterval(this.executeWatchers,1e4)},stopSyncTimer(){M.methods.stopSyncTimer.call(this),null!==this.jobUpdater&&clearInterval(this.jobUpdater)},showInEditor(e){this.refreshElement(e,e=>this.emit("editProcess",e))},executeProcess(){o["a"].info(this,"Data requested. Please wait..."),this.emit("viewSyncResult",this.process)},jobCreated(e){var t=[];this.supports("estimateJob")&&t.push({text:"Estimate",action:()=>this.estimateJob(e)}),this.supports("startJob")&&t.push({text:"Start processing",action:()=>this.queueJob(e)}),this.supports("deleteJob")&&t.push({text:"Delete",action:()=>this.deleteJob(e)}),o["a"].confirm(this,'Job "'+o["a"].getResourceTitle(e)+'" created!',t)},getTitleField(e=null){return{name:"title",label:"Title",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e=null){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getBillingPlanField(e){return{name:"plan",label:"Billing plan",schema:{type:"string",subtype:"billing-plan"},value:e,optional:!0}},getBudgetField(e=null){return{name:"budget",label:"Budget",schema:{type:"number",subtype:"budget"},default:null,value:e,optional:!0}},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},createJob(e,t){t=this.normalizeToDefaultData(t),this.create({parameters:[e,t.title,t.description,t.plan,t.budget]}).then(e=>this.jobCreated(e)).catch(e=>o["a"].exception(this,e,"Create Job Error: "+(t.title||"")))},createJobFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null];this.emit("showDataForm","Create new batch job",e,e=>this.createJob(this.process,e))},deleteJob(e){this.delete({data:e}).catch(t=>o["a"].exception(this,t,"Delete Job Error: "+o["a"].getResourceTitle(e)))},executeWatchers(){for(var e in this.watchers)this.refreshElement(this.watchers[e],(e,t)=>{if("finished"!==t.status&&"finished"===e.status){var s=[];this.supports("downloadResults")&&(s.push({text:"Download",action:()=>this.downloadResults(e)}),s.push({text:"View",action:()=>this.viewResults(e)})),o["a"].confirm(this,'Job "'+o["a"].getResourceTitle(e)+'" has finished!',s)}else"error"!==t.status&&"error"===e.status&&o["a"].error(this,'Job "'+o["a"].getResourceTitle(e)+'" has stopped due to an error or timeout.');t.status!==e.status&&this.emit("jobStatusUpdated",e,t)})},showJobInfo(e){this.refreshElement(e,async e=>{let t=null;if("finished"===e.status)try{t=await e.getResultsAsStac()}catch(s){o["a"].exception(this,s,"Load Results Error: "+o["a"].getResourceTitle(e))}this.emit("showJobInfo",e.getAll(),t)})},estimateJob(e){e.estimateJob().then(t=>this.emit("showJobEstimate",e.getAll(),t)).catch(t=>o["a"].exception(this,t,"Job Estimate Error: "+o["a"].getResourceTitle(e)))},showLogs(e){this.emit("viewLogs",e)},replaceProcess(e,t){e instanceof D["Job"]&&(this.isJobActive(e)?o["a"].error(this,"Can't change process while batch job is running."):this.updateJob(e,{process:t}))},editMetadata(e){this.refreshElement(e,e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null];this.emit("showDataForm","Edit batch job",t,t=>this.updateJob(e,t))})},updateTitle(e,t){this.updateJob(e,{title:t})},updateJob(e,t){this.update({data:e,parameters:this.normalizeToDefaultData(t)}).catch(t=>o["a"].exception(this,t,"Update Job Error: "+o["a"].getResourceTitle(e)))},queueJob(e){this.queue({data:e}).then(e=>o["a"].ok(this,'Job "'+o["a"].getResourceTitle(e)+'" successfully queued.')).catch(t=>o["a"].exception(this,t,"Queue Job Error: "+o["a"].getResourceTitle(e)))},cancelJob(e){this.cancel({data:e}).then(e=>o["a"].ok(this,'Job "'+o["a"].getResourceTitle(e)+'" successfully canceled.')).catch(t=>o["a"].exception(this,t,"Cancel Job Error: "+o["a"].getResourceTitle(e)))},viewResults(e){o["a"].info(this,"Data requested. Please wait..."),e.getResultsAsStac().then(t=>{0!=o["a"].size(t.assets)?this.emit("viewJobResults",t,e):o["a"].error(this,'No results available for job "'+o["a"].getResourceTitle(e)+'".')})},downloadResults(e){e.getResultsAsStac().then(t=>{0!=o["a"].size(t.assets)?this.emit("showListModal","Download results",Object.values(t.assets).map(e=>e.href),[{callback:e=>(window.open(e,"_blank"),!1)}]):o["a"].error(this,'No results available for job "'+o["a"].getResourceTitle(e)+'".')})},hasResults(e){return"string"!==typeof e.status||"finished"==e.status.toLowerCase()},isJobInactive(e){return"string"!==typeof e.status||!this.isActiveStatusCode(e.status)},isJobActive(e){return"string"!==typeof e.status||this.isActiveStatusCode(e.status)},isActiveStatusCode(e){switch(e.toLowerCase()){case"running":case"queued":return!0;default:return!1}}}},I=O,F=(s("0791"),Object(d["a"])(I,P,T,!1,null,null,null)),j=F.exports,B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("DataTable",{ref:"table",staticClass:"CustomProcessPanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(s){return e.processInfo(t.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate,expression:"supportsUpdate"}],attrs:{title:"Edit metadata"},on:{click:function(s){return e.editMetadata(t.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(s){return e.showInEditor(t.row)}}},[s("i",{staticClass:"fas fa-project-diagram"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteProcess(t.row)}}},[s("i",{staticClass:"fas fa-trash"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new custom process"},on:{click:e.addProcessFromScript}},[s("i",{staticClass:"fas fa-plus"}),e._v(" Add")])])],2)},$=[],R={name:"CustomProcessPanel",mixins:[S("userProcesses","custom process","custom processes"),n["a"]],data(){return{columns:{id:{name:"ID",primaryKey:!0,sort:"asc"},summary:{name:"Summary"},actions:{name:"Actions",filterable:!1,sort:!1}}}},computed:{...o["a"].mapState("editor",["process"])},mounted(){this.listen("replaceProcess",this.replaceProcess)},methods:{showInEditor(e){this.refreshElement(e,e=>this.emit("editProcess",e))},getIdField(e){return{name:"id",label:"Name",schema:{type:"string"},default:null,value:e}},getSummaryField(e){return{name:"summary",label:"Summary",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getCategoriesField(e){return{name:"categories",label:"Categories",schema:{type:"array",items:{type:"string"}},default:[],value:e,optional:!0}},getDeprecatedField(e=!1){return{name:"deprecated",label:"Deprecated",schema:{type:"boolean"},default:!1,value:e,optional:!0}},getExperimentalField(e=!1){return{name:"experimental",label:"Experimental",schema:{type:"boolean"},default:!1,value:e,optional:!0}},getFields(e){return[this.getIdField(e.id),this.getSummaryField(e.summary),this.getDescriptionField(e.description),this.getCategoriesField(e.categories),this.getDeprecatedField(e.deprecated),this.getExperimentalField(e.experimental)]},addProcessFromScript(){let e=this.getFields(this.process);this.emit("showDataForm","Store a new custom process",e,e=>this.addProcess(this.normalize(this.process,e)))},normalize(e,t){return Object.assign({},"function"===typeof e.toJSON?e.toJSON():e,t)},addProcess(e){this.create({parameters:[e.id,e]}).catch(t=>o["a"].exception(this,t,"Store Process Error: "+e.id))},processInfo(e){this.emit("showProcessInfo",e)},editMetadata(e){this.refreshElement(e,e=>{let t=this.getFields(e);this.emit("showDataForm","Edit metadata for a process graph",t,t=>this.updateMetadata(e,t))})},replaceProcess(e,t){e instanceof D["UserProcess"]&&this.updateMetadata(e,t)},updateMetadata(e,t){this.update({data:e,parameters:this.normalize(e,t)}).catch(t=>o["a"].exception(this,t,"Update Process Error: "+e.id))},deleteProcess(e){this.delete({data:e}).catch(t=>o["a"].exception(this,t,"Delete Process Error: "+e.id))}}},A=R,N=(s("1b7a"),Object(d["a"])(A,B,$,!1,null,null,null)),L=N.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("DataTable",{ref:"table",staticClass:"ServicePanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(s){return e.serviceInfo(t.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate,expression:"supportsUpdate"}],attrs:{title:"Edit metadata"},on:{click:function(s){return e.editMetadata(t.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(s){return e.showInEditor(t.row)}}},[s("i",{staticClass:"fas fa-project-diagram"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteService(t.row)}}},[s("i",{staticClass:"fas fa-trash"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.row.enabled&&e.isMapServiceSupported(t.row.type),expression:"p.row.enabled && isMapServiceSupported(p.row.type)"}],attrs:{title:"View on map"},on:{click:function(s){return e.viewService(t.row)}}},[s("i",{staticClass:"fas fa-map"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("debugService"),expression:"supports('debugService')"}],attrs:{title:"View logs"},on:{click:function(s){return e.showLogs(t.row)}}},[s("i",{staticClass:"fas fa-bug"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new service"},on:{click:function(t){return e.createServiceFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),e._v(" Create")])])],2)},U=[],J={name:"ServicePanel",mixins:[S("services","web service","web services"),n["a"]],data(){return{columns:{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Title",computedValue:e=>o["a"].getResourceTitle(e),edit:this.updateTitle},type:{name:"Type",format:e=>"string"===typeof e?e.toUpperCase():e},enabled:{name:"Enabled",edit:this.toggleEnabled},created:{name:"Submitted",format:"Timestamp",sort:"desc"},actions:{name:"Actions",filterable:!1,sort:!1}}}},computed:{...o["a"].mapState("editor",["process"]),...o["a"].mapState(["serviceTypes"]),...o["a"].mapGetters(["supports","supportsBilling","supportsBillingPlans"])},mounted(){this.listen("replaceProcess",this.replaceProcess)},methods:{isMapServiceSupported(e){return"string"===typeof e&&this.$config.supportedMapServices.includes(e.toLowerCase())},showInEditor(e){this.refreshElement(e,e=>this.emit("editProcess",e))},showLogs(e){this.emit("viewLogs",e)},serviceCreated(e){var t=[];this.isMapServiceSupported(e.type)&&t.push({text:"View on map",action:()=>this.viewService(e)}),this.supportsRead&&t.push({text:"Details",action:()=>this.serviceInfo(e)}),this.supportsDelete&&t.push({text:"Delete",action:()=>this.deleteService(e)}),o["a"].confirm(this,"Web Service created!",t)},getTitleField(e=null){return{name:"title",label:"Title",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e=null){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getServiceTypeField(e){return{name:"type",label:"Type",schema:{type:"string",subtype:"service-type"},value:e}},getBillingPlanField(e){return{name:"plan",label:"Billing plan",schema:{type:"string",subtype:"billing-plan"},value:e,optional:!0}},getBudgetField(e=null){return{name:"budget",label:"Budget",schema:{type:"number",subtype:"budget"},default:null,value:e,optional:!0}},getEnabledField(e=!0){return{name:"enabled",label:"Enabled",schema:{type:"boolean"},default:!0,value:e,optional:!0}},getConfigField(e){return{name:"configuration",label:"Service Configuration",schema:{type:"object",subtype:"service-config"},value:e,optional:!0}},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"!==typeof e.enabled&&"boolean"!==typeof e.enabled&&(e.enabled=!0),"undefined"===typeof e.configuration||o["a"].isObject(e.configuration)||(e.configuration={}),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},createService(e,t){t=this.normalizeToDefaultData(t),this.create({parameters:[e,t.type,t.title,t.description,t.enabled,t.configuration,t.plan,t.budget]}).then(e=>this.serviceCreated(e)).catch(e=>o["a"].exception(this,e,"Create Service Error: "+(t.title||"")))},createServiceFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.getServiceTypeField(),this.getEnabledField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null,this.getConfigField()];this.emit("showDataForm","Create new web service",e,e=>this.createService(this.process,e))},editMetadata(e){this.refreshElement(e,e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.getEnabledField(e.enabled),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null,this.getConfigField(e.configuration)];this.emit("showDataForm","Edit web service",t,t=>this.updateService(e,t))})},serviceInfo(e){this.refreshElement(e,e=>{this.emit("showServiceInfo",e.getAll())})},replaceProcess(e,t){e instanceof D["Service"]&&this.updateService(e,{process:t})},updateTitle(e,t){this.updateService(e,{title:t})},toggleEnabled(e){this.updateService(e,{enabled:!e.enabled})},updateService(e,t){this.update({data:e,parameters:this.normalizeToDefaultData(t)}).catch(t=>o["a"].exception(this,t,"Update Service Error: "+o["a"].getResourceTitle(e)))},deleteService(e){this.delete({data:e}).then(()=>this.emit("removeWebService",e.id)).catch(t=>o["a"].exception(this,t,"Delete Service Error: "+o["a"].getResourceTitle(e)))},viewService(e){o["a"].info(this,"Requesting tiles from server. Please wait..."),this.emit("viewWebService",e)}}},z=J,X=(s("916f"),Object(d["a"])(z,V,U,!1,null,null,null)),Y=X.exports,H={name:"UserWorkspace",components:{FilePanel:k,JobPanel:j,CustomProcessPanel:L,ServicePanel:Y,Tabs:v["default"],Tab:b["default"]},computed:{...o["a"].mapGetters(["supports"]),showJobs(){return this.supports("listJobs")||this.supports("createJob")},showServices(){return this.supports("listServices")||this.supports("createService")},showCustomProcesses(){return this.supports("listUserProcesses")||this.supports("setUserProcess")},showFiles(){return this.supports("listFiles")||this.supports("uploadFile")}},methods:{onShow(e){e.$children.length&&"function"===typeof e.$children[0].onShow&&e.$children[0].onShow()},onHide(e){e.$children.length&&"function"===typeof e.$children[0].onHide&&e.$children[0].onHide()}}},G=H,q=(s("b5d7"),Object(d["a"])(G,m,g,!1,null,null,null)),W=q.exports,K=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tabs",{ref:"tabs",attrs:{id:"viewerContent"},scopedSlots:e._u([{key:"default",fn:function(){return[s("Tab",{attrs:{id:"mapView",name:"Map",icon:"fa-map",selected:!0},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.tab;return[s("MapViewer",{ref:"mapViewer",attrs:{id:"mapCanvas",show:t.active,center:[50.1725,9.15],zoom:6}})]}}])})]},proxy:!0},{key:"dynamic",fn:function(e){var t=e.tab;return["fa-bug"===t.icon||"fa-bomb"===t.icon?s("LogViewer",{attrs:{data:t.data}}):"fa-image"===t.icon?s("ImageViewer",{attrs:{data:t.data}}):s("DataViewer",{attrs:{data:t.data}})]}}])})},Z=[],Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dataViewer"},[e.isError?s("div",{staticClass:"noDataMessage"},[e._v(e._s(e.content.message))]):"string"===typeof e.content?s("pre",{staticClass:"text"},[e._v(e._s(e.content))]):null!==e.content?s("ObjectTree",{staticClass:"tree",attrs:{data:e.content}}):s("div",{staticClass:"noDataMessage"},[s("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" Loading data...")])],1)},ee=[],te=s("0a37"),se={name:"DataViewer",mixins:[n["a"]],props:{data:{type:Object,required:!0}},components:{ObjectTree:te["default"]},computed:{...o["a"].mapState(["connection"]),isError(){return this.content instanceof Error}},data(){return{content:null}},watch:{data(){this.processData(this.data)}},created(){this.processData(this.data)},methods:{processData(e){if(console.log(e),"undefined"!==typeof e.blob)switch(e.type){case"application/json":o["a"].blobToText(e,e=>{var t=JSON.parse(e.target.result);this.content=t});break;case"text/plain":case"text/csv":o["a"].blobToText(e,e=>{this.content=e.target.result});break;default:OpenEO.Environment.saveToFile(e,o["a"].makeFileName("result",e.type)),this.error("Sorry, content type not supported. Trying to download the file...")}else e.url?this.connection.download(e.url,!1).then(e=>this.processData(e.data)).catch(e=>o["a"].exception(this,e,"Download File Error")):this.content=e},error(e){this.content=new Error(e)}}},ie=se,ae=(s("8f78"),Object(d["a"])(ie,Q,ee,!1,null,"6680fd10",null)),re=ae.exports,ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"imageViewer",staticClass:"imageViewer",class:{fullscreen:e.fullScreen}},[s("div",{staticClass:"toolbar"},[s("span",{staticClass:"value",attrs:{title:e.valueTitle}},[e._v(e._s(e.valueText))]),s("FullscreenButton",{staticClass:"fullscreen-button",attrs:{element:function(){return e.$refs.imageViewer}},on:{changed:e.fullscreenToggled}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.loaded,expression:"!loaded"}],staticClass:"noDataMessage"},[s("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" Loading image...")]),s("canvas",{ref:"canvas",class:{fullsize:e.fullSize},attrs:{title:e.title},on:{click:e.resize,mousemove:e.getPixelValue,mouseout:e.resetPixelValue,load:e.imageLoaded}})])},oe=[],le=s("5472"),ce={name:"ImageViewer",components:{FullscreenButton:le["a"]},props:{data:{required:!0}},data(){return{fullScreen:!1,fullSize:!1,img:null,loaded:!1,context:null,value:"-"}},mounted(){this.data.blob?this.showImageBlob(this.data.blob):this.data.url&&this.showImage(this.data.url)},computed:{title(){return this.fullScreen?"":this.fullSize?"Click to shrink (fit to screen)":"Click to enlarge (full size)"},valueTitle(){return this.fullScreen||this.fullSize?"":"Show in full size to get precise values"},valueText(){return this.fullScreen||this.fullSize?"Pixel Value: "+this.value:"Estimated Pixel Value: "+this.value}},methods:{showImage(e){this.loaded=!1,this.img=new Image,this.img.crossOrigin="Anonymous",this.img.onload=this.imageLoaded.bind(this),this.img.src=e},showImageBlob(e){this.showImage(URL.createObjectURL(e))},imageLoaded(){this.loaded=!0,this.$refs.canvas.width=this.img.naturalWidth,this.$refs.canvas.height=this.img.naturalHeight,this.context=this.$refs.canvas.getContext("2d"),this.context.drawImage(this.img,0,0)},fullscreenToggled(e){this.fullScreen=e},resize(){this.fullScreen||(this.fullSize=!this.fullSize)},resetPixelValue(){this.value="-"},getPixelValue(e){try{let t=o["a"].domBoundingBox(this.$refs.canvas),s=this.img.naturalWidth/t.width,i=this.img.naturalHeight/t.height,a=e.offsetX*s,r=e.offsetY*i,[n,l,c,u]=this.context.getImageData(Math.ceil(a),Math.ceil(r),1,1).data;this.value=0===u?"no data":n==l&&l===c?255===u?n:`${n}, Alpha: ${u}`:`Red: ${n}, Green: ${l}, Blue: ${c}, Alpha: ${u}`}catch(t){this.value="n/a",console.log(t)}}}},ue=ce,he=(s("f14d"),Object(d["a"])(ue,ne,oe,!1,null,"df41effa",null)),de=he.exports,pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Logs",{staticClass:"log-viewer",attrs:{logs:e.logs}})},fe=[],me=s("b60c"),ge={name:"LogViewer",mixins:[n["a"]],components:{Logs:me["a"]},props:{data:{type:[Object,Array],required:!0}},data(){return{logs:null,syncTimer:null}},computed:{...o["a"].mapState(["connection"]),isJob(){return o["a"].isObject(this.data)&&"function"===typeof this.data.debugJob},isService(){return o["a"].isObject(this.data)&&"function"===typeof this.data.debugService},logIterator(){return this.isJob?this.data.debugJob():this.isService?this.data.debugService():null}},created(){this.isJob&&this.listen("jobStatusUpdated",this.onJobStatusUpdated)},beforeDestroy(){this.onHide()},methods:{onShow(){this.loadNext(),this.isJob?this.onJobStatusUpdated(this.data):this.isService&&this.startWatcher()},onHide(){this.stopWatcher()},onJobStatusUpdated(e){if(e===this.data&&"string"===typeof this.data.status)switch(this.data.status.toLowerCase()){case"running":case"queued":this.startWatcher();break;default:this.stopWatcher()}},startWatcher(){null===this.syncTimer&&(this.syncTimer=setInterval(this.loadNext.bind(this),1e4))},stopWatcher(){null!==this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)},async loadNext(){if(this.logIterator){let e=await this.logIterator.nextLogs();Array.isArray(this.logs)||(this.logs=[]);for(let t of e)this.logs.push(t)}else Array.isArray(this.data)&&!this.logs&&(this.logs=this.data)}}},ve=ge,be=(s("c46c"),Object(d["a"])(ve,pe,fe,!1,null,null,null)),ye=be.exports,we=s("a5c1"),xe=s("b40f"),Se=s.n(xe),Ce={name:"Viewer",mixins:[n["a"]],components:{Tab:b["default"],Tabs:v["default"],DataViewer:re,ImageViewer:de,LogViewer:ye,MapViewer:we["a"]},mounted(){this.listen("viewBlob",this.showViewer),this.listen("viewLink",this.showViewer),this.listen("viewSyncResult",this.showSyncResults),this.listen("viewJobResults",this.showJobResults),this.listen("viewWebService",this.showWebService),this.listen("viewLogs",this.showLogs),this.listen("removeWebService",this.removeWebService)},data(){return{tabCounter:{}}},computed:{...o["a"].mapState(["connection"])},methods:{showWebService(e){this.showMapViewer(),this.$refs.mapViewer.showWebService(e)},removeWebService(e){this.$refs.mapViewer.removeLayerFromMap(e)},showMapViewer(){this.$refs.tabs.selectTab("mapView")},showSyncResults(e){this.connection.computeResult(e).then(e=>{Array.isArray(e.logs)&&e.logs.length>0&&this.showLogs(e.logs),this.showViewer(e.data)}).catch(e=>{let t="Processing Error";"string"===typeof e.message&&e.message.length>this.$config.snotifyDefaults.bodyMaxLength?(this.showLogs([{id:e.id||"unknown",code:e.code||void 0,level:"error",message:e.message,links:e.links||[]}]),o["a"].error(this,"Synchronous processing failed. Please see the logs for details.",t)):o["a"].exception(this,e,t)})},showJobResults(e,t){for(var s in e.assets){var i=e.assets[s];this.showViewer(i,this.makeTitle(s,t.id,!0))}},showLogs(e,t="Logs",s="fa-bug"){let i=Array.isArray(e)?t:o["a"].getResourceTitle(e,!0);this.$refs.tabs.addTab(i,s,e,null,!0,!0,e=>this.onShow(e),e=>this.onHide(e))},onShow(e){e.$children.length&&"function"===typeof e.$children[0].onShow&&e.$children[0].onShow()},onHide(e){e.$children.length&&"function"===typeof e.$children[0].onHide&&e.$children[0].onHide()},uniqueTitle(e){return this.tabCounter[e]?(this.tabCounter[e]++,e+" ("+this.tabCounter[e]+")"):(this.tabCounter[e]=1,e)},makeTitle(e,t,s=!1){return e?s?this.uniqueTitle(e):e:this.uniqueTitle(t)},async showViewer(e,t=null){var s={};o["a"].isObject(e)&&"string"===typeof e.href&&"string"===typeof e.type?(s.type=e.type,s.url=e.href):e instanceof Blob?(s.type=e.type,s.blob=e):o["a"].error(this,"Sorry, invalid data received."),"string"===typeof s.type&&-1!==s.type.indexOf("/")&&-1===s.type.indexOf("*")||o["a"].error(this,"Sorry, can't detect content type.");try{let e=Se.a.parse(s.type);s.type=e.type,s.parameters=e.parameters}catch(i){}switch(s.type){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":this.$refs.tabs.addTab(this.makeTitle(t,"Image"),"fa-image",s,null,!0,!0);break;case"application/json":case"text/plain":case"text/csv":this.$refs.tabs.addTab(this.makeTitle(t,"Data"),"fa-database",s,null,!0,!0);break;case"image/tiff":if(s.url&&"geotiff"===s.parameters.application){this.showMapViewer(),this.$refs.mapViewer.updateGeoTiffLayer(s.url,this.makeTitle(t,"GeoTiff"));break}default:if(s.blob instanceof Blob){D["OpenEO"].Environment.saveToFile(s.blob,o["a"].makeFileName("result",s.type));break}if(s.url)try{let e=await this.connection._get(s.url,"","blob"),t=o["a"].getFileNameFromURL(s.url);if(e.data instanceof Blob){D["OpenEO"].Environment.saveToFile(e.data,o["a"].makeFileName(t,s.type));break}}catch(i){console.error(i)}o["a"].error(this,"Sorry, content type not supported by the viewer and can't be downloaded.")}}}},Ee=Ce,_e=(s("15dd"),Object(d["a"])(Ee,K,Z,!1,null,null,null)),ke=_e.exports,Pe=s("ceb0"),Te=s("cbd9"),De=s("79e5"),Me={name:"IDE",mixins:[n["a"]],components:{DiscoveryToolbar:Te["a"],Editor:Pe["default"],Viewer:ke,UserMenu:f,UserWorkspace:W,CollectionModal:()=>s.e("chunk-6edaaddb").then(s.bind(null,"8295")),ProcessModal:()=>s.e("chunk-7878eb47").then(s.bind(null,"732b")),ServerInfoModal:()=>s.e("chunk-582c7420").then(s.bind(null,"2406")),JobInfoModal:()=>s.e("chunk-56e22092").then(s.bind(null,"fd61")),JobEstimateModal:()=>s.e("chunk-58bb75ac").then(s.bind(null,"0639")),ServiceInfoModal:()=>s.e("chunk-4bf4bf0b").then(s.bind(null,"0af1")),ParameterModal:()=>Promise.resolve().then(s.bind(null,"c2dc")),SchemaModal:()=>s.e("chunk-0f35fb0a").then(s.bind(null,"ea2d")),FileFormatModal:()=>s.e("chunk-397960de").then(s.bind(null,"3642")),UdfRuntimeModal:()=>s.e("chunk-6ccc47a8").then(s.bind(null,"8a57"))},data(){return{moving:!1,movingOffset:0,separators:[{left:"discovery",right:"workspace",anchor:"left",width:"20%"},{left:"workspace",right:"viewer",anchor:"right",width:"30%"}],version:r.version,resizeListener:null,userInfoUpdater:null}},computed:{...o["a"].mapState(["connection"]),...o["a"].mapState("editor",["context","process"]),...o["a"].mapGetters(["title","isAuthenticated","apiVersion"]),...o["a"].mapGetters("jobs",{supportsJobUpdate:"supportsUpdate"}),...o["a"].mapGetters("services",{supportsServiceUpdate:"supportsUpdate"}),...o["a"].mapGetters("userProcesses",{getProcessById:"getAllById",supportsUserProcessUpdate:"supportsUpdate"}),contextTitle(){return null!==this.context?o["a"].getResourceTitle(this.context,!0):""},saveSupported(){return null!==this.context&&(this.context instanceof D["Job"]&&this.supportsJobUpdate||this.context instanceof D["Service"]&&this.supportsServiceUpdate||this.context instanceof D["UserProcess"]&&this.supportsUserProcessUpdate)}},async created(){try{await this.loadInitialProcess()}catch(e){o["a"].exception(this,e,"Loading process failed")}},mounted(){this.listen("showCollection",this.showCollectionInfo),this.listen("showProcess",this.showProcessInfoById),this.listen("showJobInfo",this.showJobInfo),this.listen("showJobEstimate",this.showJobEstimate),this.listen("showProcessInfo",this.showProcessInfo),this.listen("showServiceInfo",this.showServiceInfo),this.listen("showUdfRuntimeInfo",this.showUdfRuntimeInfo),this.listen("showFileFormatInfo",this.showFileFormatInfo),this.listen("showSchema",this.showSchemaInfo),this.listen("showDataForm",this.showDataForm),this.listen("editProcess",this.editProcess),this.resizeListener=e=>this.emit("windowResized",e),window.addEventListener("resize",this.resizeListener),this.isAuthenticated&&(this.userInfoUpdater=setInterval(this.describeAccount,60*this.$config.dataRefreshInterval*1e3)),this.emit("title",this.title)},beforeDestroy(){null!==this.resizeListener&&window.removeEventListener("resize",this.resizeListener),null!==this.userInfoUpdater&&clearInterval(this.userInfoUpdater)},methods:{...o["a"].mapActions(["describeAccount","describeCollection"]),...o["a"].mapActions("userProcesses",{readUserProcess:"read"}),...o["a"].mapActions("editor",["loadInitialProcess"]),...o["a"].mapMutations("editor",["setContext","setProcess"]),saveProcess(){this.emit("replaceProcess",this.context,this.process)},updateEditor(e){this.setProcess(e),null===e&&this.setContext(null)},editProcess(e){this.setContext(e)},insertProcess(e){this.$refs.editor.insertProcess(e)},startMovingSeparator(e,t){this.moving=!1,1===e.which&&(this.moving=t)},stopMovingSeparator(e){this.moving=!1},moveSeparator(e){if(!1!==this.moving&&this.separators[this.moving]&&0!==e.movementX){var t,s=this.separators[this.moving],i=this.$refs[s[s.anchor]];t="right"===s.anchor?Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)-e.x:e.x,i.style.width=t+"px",this.emit("windowResized",e),e.preventDefault(),e.stopPropagation()}},centerSeparator(e,t){this.moving=!1;var s=this.separators[t];if(s){var i=this.$refs[s[s.anchor]];i.getBoundingClientRect().width<220?i.style.width=s.width:i.style.width=0,this.emit("windowResized",e)}},showCollectionInfo(e){this.describeCollection(e).then(e=>this.$refs.collectionModal.show(e)).catch(t=>o["a"].error(this,"Sorry, can't load collection details for "+e+"."))},showProcessInfoById(e){this._showProcessInfo(this.getProcessById(e))},showProcessInfo(e){this._showProcessInfo(e)},showUdfRuntimeInfo(e,t,s=null){this.$refs.udfRuntimeModal.show(e,t,s)},showFileFormatInfo(e,t,s){this.$refs.fileFormatModal.show(e,t,s)},showSchemaInfo(e,t,s=null){null===s&&(s="This is a parameter for a user-defined process.\nIt is a value made available by the parent entity (usually another process or a secondary web service) that is executing this processes for further use.\nThe value will comply to the following data type(s):"),this.$refs.schemaModal.show(e,t,s)},_showProcessInfo(e){e.native?this._showProcessInfoModal(e):this.readUserProcess({data:e}).then(e=>this._showProcessInfoModal(e.toJSON())).catch(t=>o["a"].exception(this,t,"Load Process Error: "+e.id))},_showProcessInfoModal(e){this.$refs.processModal.show(e)},showServiceInfo(e){this.$refs.serviceModal.show(e)},showJobInfo(e,t=null){this.$refs.jobModal.show(e,t)},showJobEstimate(e,t){this.$refs.jobEstimateModal.show(e,t)},showServerInfo(){this.$refs.serverInfoModal.show()},showWebEditorInfo(){this.emit("showWebEditorInfo")},showDataForm(e,t,s=null,i=null){var a="function"===typeof s,r={},n=[];for(let o of t)null!==o&&(n.push(new De["c"](o)),r[o.name]=o.value);this.$refs.parameterModal.show(e,n,r,a,s,i)}}},Oe=Me,Ie=(s("352f"),Object(d["a"])(Oe,i,a,!1,null,null,null));t["default"]=Ie.exports},f778:function(e,t,s){}}]);
//# sourceMappingURL=chunk-378f8114.8371b53c.js.map